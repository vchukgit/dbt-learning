2021-01-28 22:49:03.933272 (MainThread): Running with dbt=0.18.1
2021-01-28 22:49:03.997662 (MainThread): Loading KWallet
2021-01-28 22:49:03.998172 (MainThread): Loading SecretService
2021-01-28 22:49:03.998528 (MainThread): Loading Windows
2021-01-28 22:49:03.998996 (MainThread): Loading chainer
2021-01-28 22:49:03.999237 (MainThread): Loading macOS
2021-01-28 22:49:04.253212 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-28 22:49:04.254527 (MainThread): Tracking: tracking
2021-01-28 22:49:04.254752 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4461f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e632cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e632970>]}
2021-01-28 22:49:04.277372 (MainThread): Partial parsing not enabled
2021-01-28 22:49:04.278938 (MainThread): Parsing macros/catalog.sql
2021-01-28 22:49:04.281563 (MainThread): Parsing macros/adapters.sql
2021-01-28 22:49:04.310843 (MainThread): Parsing macros/materializations/merge.sql
2021-01-28 22:49:04.312969 (MainThread): Parsing macros/materializations/view.sql
2021-01-28 22:49:04.314580 (MainThread): Parsing macros/materializations/table.sql
2021-01-28 22:49:04.318638 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-28 22:49:04.330368 (MainThread): Parsing macros/core.sql
2021-01-28 22:49:04.334643 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-28 22:49:04.343721 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-28 22:49:04.345582 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-28 22:49:04.362433 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-28 22:49:04.391775 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 22:49:04.412196 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-28 22:49:04.414236 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 22:49:04.420345 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-28 22:49:04.433715 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 22:49:04.440546 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 22:49:04.446963 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-28 22:49:04.451920 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-28 22:49:04.453084 (MainThread): Parsing macros/etc/query.sql
2021-01-28 22:49:04.454673 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-28 22:49:04.457031 (MainThread): Parsing macros/etc/datetime.sql
2021-01-28 22:49:04.465949 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-28 22:49:04.468083 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-28 22:49:04.469901 (MainThread): Parsing macros/adapters/common.sql
2021-01-28 22:49:04.510213 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-28 22:49:04.512255 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-28 22:49:04.515457 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-28 22:49:04.518243 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-28 22:49:04.526006 (MainThread): Partial parsing not enabled
2021-01-28 22:49:04.562494 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-28 22:49:04.583546 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-28 22:49:04.784823 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-28 22:49:04.785474 (MainThread): 
2021-01-28 22:49:04.785703 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 22:49:04.787827 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_protiviti_db".
2021-01-28 22:49:04.799453 (ThreadPoolExecutor-0_0): Using snowflake connection "list_protiviti_db".
2021-01-28 22:49:04.799535 (ThreadPoolExecutor-0_0): On list_protiviti_db: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_protiviti_db"} */

    show terse schemas in database protiviti_db
    limit 10000
2021-01-28 22:49:04.799606 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-28 22:49:05.951210 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 7 in 1.15 seconds
2021-01-28 22:49:05.953913 (ThreadPoolExecutor-0_0): On list_protiviti_db: Close
2021-01-28 22:49:06.168481 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_protiviti_db_public".
2021-01-28 22:49:06.175335 (ThreadPoolExecutor-1_0): Using snowflake connection "list_protiviti_db_public".
2021-01-28 22:49:06.175432 (ThreadPoolExecutor-1_0): On list_protiviti_db_public: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_protiviti_db_public"} */

    show terse objects in protiviti_db.public
2021-01-28 22:49:06.175517 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-28 22:49:07.024261 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.85 seconds
2021-01-28 22:49:07.033617 (ThreadPoolExecutor-1_0): On list_protiviti_db_public: Close
2021-01-28 22:49:07.217454 (MainThread): Using snowflake connection "master".
2021-01-28 22:49:07.217642 (MainThread): On master: BEGIN
2021-01-28 22:49:07.217775 (MainThread): Opening a new connection, currently in state init
2021-01-28 22:49:08.175146 (MainThread): SQL status: SUCCESS 1 in 0.96 seconds
2021-01-28 22:49:08.175419 (MainThread): On master: COMMIT
2021-01-28 22:49:08.175672 (MainThread): Using snowflake connection "master".
2021-01-28 22:49:08.175819 (MainThread): On master: COMMIT
2021-01-28 22:49:08.663444 (MainThread): SQL status: SUCCESS 1 in 0.49 seconds
2021-01-28 22:49:08.663718 (MainThread): On master: Close
2021-01-28 22:49:08.890291 (MainThread): 16:49:08 | Concurrency: 1 threads (target='dev')
2021-01-28 22:49:08.890525 (MainThread): 16:49:08 | 
2021-01-28 22:49:08.896232 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-28 22:49:08.897803 (Thread-1): 16:49:08 | 1 of 2 START table model public.my_first_dbt_model................... [RUN]
2021-01-28 22:49:08.898200 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-28 22:49:08.898368 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-28 22:49:08.918490 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-28 22:49:08.919011 (Thread-1): finished collecting timing info
2021-01-28 22:49:08.984802 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-28 22:49:08.986219 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-28 22:49:08.986334 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-01-28 22:49:08.986440 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:49:09.580619 (Thread-1): SQL status: SUCCESS 1 in 0.59 seconds
2021-01-28 22:49:09.580875 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-28 22:49:09.581029 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table protiviti_db.public.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-01-28 22:49:10.936032 (Thread-1): SQL status: SUCCESS 1 in 1.35 seconds
2021-01-28 22:49:10.937718 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-28 22:49:10.937962 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-28 22:49:10.938080 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-28 22:49:11.126255 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-28 22:49:11.141131 (Thread-1): finished collecting timing info
2021-01-28 22:49:11.141367 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-01-28 22:49:11.319390 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b806ad7-c5c4-4d8e-ae24-41bc91565793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5c1a60>]}
2021-01-28 22:49:11.320936 (Thread-1): 16:49:11 | 1 of 2 OK created table model public.my_first_dbt_model.............. [SUCCESS 1 in 2.42s]
2021-01-28 22:49:11.321120 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-28 22:49:11.321688 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-28 22:49:11.322871 (Thread-1): 16:49:11 | 2 of 2 START view model public.my_second_dbt_model................... [RUN]
2021-01-28 22:49:11.323171 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-28 22:49:11.323293 (Thread-1): Compiling model.jrtests_learn_dbt.my_second_dbt_model
2021-01-28 22:49:11.331950 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-28 22:49:11.332313 (Thread-1): finished collecting timing info
2021-01-28 22:49:11.351448 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-28 22:49:11.352101 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-28 22:49:11.352187 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: BEGIN
2021-01-28 22:49:11.352268 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:49:11.964768 (Thread-1): SQL status: SUCCESS 1 in 0.61 seconds
2021-01-28 22:49:11.965018 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-28 22:49:11.965161 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_second_dbt_model"} */

  create or replace  view protiviti_db.public.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from protiviti_db.public.my_first_dbt_model
where id = 1
  );
2021-01-28 22:49:12.555867 (Thread-1): SQL status: SUCCESS 1 in 0.59 seconds
2021-01-28 22:49:12.557442 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-28 22:49:12.557710 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-28 22:49:12.557829 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-28 22:49:12.659730 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2021-01-28 22:49:12.664492 (Thread-1): finished collecting timing info
2021-01-28 22:49:12.664813 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: Close
2021-01-28 22:49:12.842220 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b806ad7-c5c4-4d8e-ae24-41bc91565793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5707f0>]}
2021-01-28 22:49:12.843794 (Thread-1): 16:49:12 | 2 of 2 OK created view model public.my_second_dbt_model.............. [SUCCESS 1 in 1.52s]
2021-01-28 22:49:12.843990 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-28 22:49:12.845267 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 22:49:12.845477 (MainThread): Using snowflake connection "master".
2021-01-28 22:49:12.845578 (MainThread): On master: BEGIN
2021-01-28 22:49:12.845699 (MainThread): Opening a new connection, currently in state closed
2021-01-28 22:49:13.484640 (MainThread): SQL status: SUCCESS 1 in 0.64 seconds
2021-01-28 22:49:13.484906 (MainThread): On master: COMMIT
2021-01-28 22:49:13.485149 (MainThread): Using snowflake connection "master".
2021-01-28 22:49:13.485292 (MainThread): On master: COMMIT
2021-01-28 22:49:13.988565 (MainThread): SQL status: SUCCESS 1 in 0.50 seconds
2021-01-28 22:49:13.988836 (MainThread): On master: Close
2021-01-28 22:49:14.211334 (MainThread): 16:49:14 | 
2021-01-28 22:49:14.211561 (MainThread): 16:49:14 | Finished running 1 table model, 1 view model in 9.43s.
2021-01-28 22:49:14.211710 (MainThread): Connection 'master' was properly closed.
2021-01-28 22:49:14.211815 (MainThread): Connection 'model.jrtests_learn_dbt.my_second_dbt_model' was properly closed.
2021-01-28 22:49:14.219531 (MainThread): 
2021-01-28 22:49:14.219654 (MainThread): Completed successfully
2021-01-28 22:49:14.219759 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-01-28 22:49:14.219910 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2daf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2da970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2daf10>]}
2021-01-28 22:49:14.220082 (MainThread): Flushing usage events
2021-01-28 23:02:40.816835 (MainThread): Running with dbt=0.18.1
2021-01-28 23:02:40.876216 (MainThread): Loading KWallet
2021-01-28 23:02:40.876762 (MainThread): Loading SecretService
2021-01-28 23:02:40.877132 (MainThread): Loading Windows
2021-01-28 23:02:40.877618 (MainThread): Loading chainer
2021-01-28 23:02:40.877871 (MainThread): Loading macOS
2021-01-28 23:02:41.121674 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-28 23:02:41.122559 (MainThread): Tracking: tracking
2021-01-28 23:02:41.122786 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a2c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c19be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c19880>]}
2021-01-28 23:02:41.142448 (MainThread): Partial parsing not enabled
2021-01-28 23:02:41.143335 (MainThread): Parsing macros/catalog.sql
2021-01-28 23:02:41.145404 (MainThread): Parsing macros/adapters.sql
2021-01-28 23:02:41.171715 (MainThread): Parsing macros/materializations/merge.sql
2021-01-28 23:02:41.173542 (MainThread): Parsing macros/materializations/view.sql
2021-01-28 23:02:41.174892 (MainThread): Parsing macros/materializations/table.sql
2021-01-28 23:02:41.178508 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-28 23:02:41.188379 (MainThread): Parsing macros/core.sql
2021-01-28 23:02:41.191756 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-28 23:02:41.199861 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-28 23:02:41.201633 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-28 23:02:41.216755 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-28 23:02:41.245071 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 23:02:41.264254 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-28 23:02:41.265976 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 23:02:41.271572 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-28 23:02:41.284636 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 23:02:41.290770 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 23:02:41.296427 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-28 23:02:41.300948 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-28 23:02:41.301797 (MainThread): Parsing macros/etc/query.sql
2021-01-28 23:02:41.302803 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-28 23:02:41.304259 (MainThread): Parsing macros/etc/datetime.sql
2021-01-28 23:02:41.312276 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-28 23:02:41.314030 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-28 23:02:41.315528 (MainThread): Parsing macros/adapters/common.sql
2021-01-28 23:02:41.355144 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-28 23:02:41.357199 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-28 23:02:41.358588 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-28 23:02:41.360195 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-28 23:02:41.367171 (MainThread): Partial parsing not enabled
2021-01-28 23:02:41.402190 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-28 23:02:41.422370 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-28 23:02:41.614917 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-28 23:02:41.615561 (MainThread): 
2021-01-28 23:02:41.615784 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 23:02:41.617903 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-28 23:02:41.629359 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-28 23:02:41.629438 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-28 23:02:41.629509 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-28 23:02:42.521334 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.89 seconds
2021-01-28 23:02:42.525385 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-28 23:02:42.698711 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt".
2021-01-28 23:02:42.699057 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt".
2021-01-28 23:02:42.699263 (ThreadPoolExecutor-0_0): Creating schema "analytics.dbt"
2021-01-28 23:02:42.705480 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt".
2021-01-28 23:02:42.705588 (ThreadPoolExecutor-0_0): On create_analytics_dbt: BEGIN
2021-01-28 23:02:42.705686 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-01-28 23:02:43.543669 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.84 seconds
2021-01-28 23:02:43.543911 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt".
2021-01-28 23:02:43.544057 (ThreadPoolExecutor-0_0): On create_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "create_analytics_dbt"} */
create schema if not exists analytics.dbt
2021-01-28 23:02:44.181370 (ThreadPoolExecutor-0_0): Snowflake query id: 0199ebc6-0b3d-5c85-0000-b6cd00257dce
2021-01-28 23:02:44.181579 (ThreadPoolExecutor-0_0): Snowflake error: 003041 (42710): SQL compilation error:
Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
2021-01-28 23:02:44.181789 (ThreadPoolExecutor-0_0): Error running SQL: macro create_schema
2021-01-28 23:02:44.181920 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-01-28 23:02:44.182067 (ThreadPoolExecutor-0_0): On create_analytics_dbt: ROLLBACK
2021-01-28 23:02:44.409573 (ThreadPoolExecutor-0_0): On create_analytics_dbt: Close
2021-01-28 23:02:44.579244 (MainThread): Connection 'master' was properly closed.
2021-01-28 23:02:44.579425 (MainThread): Connection 'create_analytics_dbt' was properly closed.
2021-01-28 23:02:44.579628 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10489b250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e2280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10494bd90>]}
2021-01-28 23:02:44.579869 (MainThread): Flushing usage events
2021-01-28 23:02:44.844326 (MainThread): Encountered an error:
2021-01-28 23:02:44.844515 (MainThread): Database Error
  003041 (42710): SQL compilation error:
  Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
2021-01-28 23:02:44.857286 (MainThread): Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003041 (42710): SQL compilation error:
Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 419, in run
    result = self.execute_with_hooks(selected_uids)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 379, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/run.py", line 394, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 523, in create_schemas
    create_future.result()
  File "/usr/local/Cellar/python@3.8/3.8.6/Frameworks/Python.framework/Versions/3.8/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/usr/local/Cellar/python@3.8/3.8.6/Frameworks/Python.framework/Versions/3.8/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/usr/local/Cellar/python@3.8/3.8.6/Frameworks/Python.framework/Versions/3.8/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 485, in create_schema
    adapter.create_schema(relation)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/impl.py", line 182, in create_schema
    self.execute_macro(CREATE_SCHEMA_MACRO_NAME, kwargs=kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 984, in execute_macro
    result = macro_function(**kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 19, in macro
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 28, in macro
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/local/Cellar/python@3.8/3.8.6/Frameworks/Python.framework/Versions/3.8/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  003041 (42710): SQL compilation error:
  Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.

2021-01-28 23:09:25.320543 (MainThread): Running with dbt=0.18.1
2021-01-28 23:09:25.434448 (MainThread): Loading KWallet
2021-01-28 23:09:25.435301 (MainThread): Loading SecretService
2021-01-28 23:09:25.436469 (MainThread): Loading Windows
2021-01-28 23:09:25.437838 (MainThread): Loading chainer
2021-01-28 23:09:25.438413 (MainThread): Loading macOS
2021-01-28 23:09:25.863029 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-28 23:09:25.864492 (MainThread): Tracking: tracking
2021-01-28 23:09:25.864743 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ce2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ecec70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ece910>]}
2021-01-28 23:09:25.884440 (MainThread): Partial parsing not enabled
2021-01-28 23:09:25.885465 (MainThread): Parsing macros/catalog.sql
2021-01-28 23:09:25.887664 (MainThread): Parsing macros/adapters.sql
2021-01-28 23:09:25.916622 (MainThread): Parsing macros/materializations/merge.sql
2021-01-28 23:09:25.918669 (MainThread): Parsing macros/materializations/view.sql
2021-01-28 23:09:25.920231 (MainThread): Parsing macros/materializations/table.sql
2021-01-28 23:09:25.925011 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-28 23:09:25.937061 (MainThread): Parsing macros/core.sql
2021-01-28 23:09:25.941341 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-28 23:09:25.950860 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-28 23:09:25.952934 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-28 23:09:25.969572 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-28 23:09:25.997273 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 23:09:26.018207 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-28 23:09:26.020733 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 23:09:26.027425 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-28 23:09:26.041245 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 23:09:26.048097 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 23:09:26.054073 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-28 23:09:26.058971 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-28 23:09:26.060029 (MainThread): Parsing macros/etc/query.sql
2021-01-28 23:09:26.061543 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-28 23:09:26.063824 (MainThread): Parsing macros/etc/datetime.sql
2021-01-28 23:09:26.072415 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-28 23:09:26.074883 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-28 23:09:26.076733 (MainThread): Parsing macros/adapters/common.sql
2021-01-28 23:09:26.117292 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-28 23:09:26.119387 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-28 23:09:26.121137 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-28 23:09:26.122933 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-28 23:09:26.130298 (MainThread): Partial parsing not enabled
2021-01-28 23:09:26.165901 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-28 23:09:26.186568 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-28 23:09:26.384387 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-28 23:09:26.385118 (MainThread): 
2021-01-28 23:09:26.385345 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 23:09:26.387471 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-28 23:09:26.401717 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-28 23:09:26.401850 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-28 23:09:26.401948 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-28 23:09:27.430477 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.03 seconds
2021-01-28 23:09:27.435332 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-28 23:09:27.682072 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-28 23:09:27.689479 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-28 23:09:27.689579 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-28 23:09:27.689663 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-28 23:09:28.396496 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.71 seconds
2021-01-28 23:09:28.397141 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-28 23:09:28.600338 (MainThread): Using snowflake connection "master".
2021-01-28 23:09:28.600517 (MainThread): On master: BEGIN
2021-01-28 23:09:28.600642 (MainThread): Opening a new connection, currently in state init
2021-01-28 23:09:29.195560 (MainThread): SQL status: SUCCESS 1 in 0.59 seconds
2021-01-28 23:09:29.195821 (MainThread): On master: COMMIT
2021-01-28 23:09:29.196094 (MainThread): Using snowflake connection "master".
2021-01-28 23:09:29.196237 (MainThread): On master: COMMIT
2021-01-28 23:09:29.437706 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-28 23:09:29.437972 (MainThread): On master: Close
2021-01-28 23:09:29.659085 (MainThread): 17:09:29 | Concurrency: 1 threads (target='dev')
2021-01-28 23:09:29.659307 (MainThread): 17:09:29 | 
2021-01-28 23:09:29.662302 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-28 23:09:29.663851 (Thread-1): 17:09:29 | 1 of 2 START table model dbt.my_first_dbt_model...................... [RUN]
2021-01-28 23:09:29.664242 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-28 23:09:29.664399 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-28 23:09:29.683785 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-28 23:09:29.684140 (Thread-1): finished collecting timing info
2021-01-28 23:09:29.749070 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-28 23:09:29.750065 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-28 23:09:29.750158 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-01-28 23:09:29.750244 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 23:09:30.336555 (Thread-1): SQL status: SUCCESS 1 in 0.59 seconds
2021-01-28 23:09:30.336800 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-28 23:09:30.336944 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-01-28 23:09:30.498892 (Thread-1): Snowflake query id: 0199ebcd-0bca-f283-0000-b6cd0025ad12
2021-01-28 23:09:30.499106 (Thread-1): Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'DBT'
2021-01-28 23:09:30.499332 (Thread-1): finished collecting timing info
2021-01-28 23:09:30.499774 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: ROLLBACK
2021-01-28 23:09:30.776688 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-01-28 23:09:30.998278 (Thread-1): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'DBT'
  compiled SQL at target/run/jrtests_learn_dbt/models/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'DBT'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/local/Cellar/python@3.8/3.8.6/Frameworks/Python.framework/Versions/3.8/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'DBT'
  compiled SQL at target/run/jrtests_learn_dbt/models/example/my_first_dbt_model.sql
2021-01-28 23:09:31.013284 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '787a8171-811b-464b-9e0c-52f7e2284dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115099790>]}
2021-01-28 23:09:31.014923 (Thread-1): 17:09:31 | 1 of 2 ERROR creating table model dbt.my_first_dbt_model............. [ERROR in 1.35s]
2021-01-28 23:09:31.015113 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-28 23:09:31.015767 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-28 23:09:31.015922 (Thread-1): 17:09:31 | 2 of 2 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-01-28 23:09:31.016135 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-28 23:09:31.017042 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 23:09:31.017245 (MainThread): Using snowflake connection "master".
2021-01-28 23:09:31.017338 (MainThread): On master: BEGIN
2021-01-28 23:09:31.017430 (MainThread): Opening a new connection, currently in state closed
2021-01-28 23:09:31.925128 (MainThread): SQL status: SUCCESS 1 in 0.91 seconds
2021-01-28 23:09:31.925429 (MainThread): On master: COMMIT
2021-01-28 23:09:31.925675 (MainThread): Using snowflake connection "master".
2021-01-28 23:09:31.925834 (MainThread): On master: COMMIT
2021-01-28 23:09:32.557061 (MainThread): SQL status: SUCCESS 1 in 0.63 seconds
2021-01-28 23:09:32.557282 (MainThread): On master: Close
2021-01-28 23:09:32.711248 (MainThread): 17:09:32 | 
2021-01-28 23:09:32.711475 (MainThread): 17:09:32 | Finished running 1 table model, 1 view model in 6.33s.
2021-01-28 23:09:32.711630 (MainThread): Connection 'master' was properly closed.
2021-01-28 23:09:32.711743 (MainThread): Connection 'model.jrtests_learn_dbt.my_first_dbt_model' was properly closed.
2021-01-28 23:09:32.719035 (MainThread): 
2021-01-28 23:09:32.719170 (MainThread): Completed with 1 error and 0 warnings:
2021-01-28 23:09:32.719287 (MainThread): 
2021-01-28 23:09:32.719401 (MainThread): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-28 23:09:32.719503 (MainThread):   003001 (42501): SQL access control error:
2021-01-28 23:09:32.719596 (MainThread):   Insufficient privileges to operate on schema 'DBT'
2021-01-28 23:09:32.719688 (MainThread):   compiled SQL at target/run/jrtests_learn_dbt/models/example/my_first_dbt_model.sql
2021-01-28 23:09:32.719786 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
2021-01-28 23:09:32.719947 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b65ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11508c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11508c280>]}
2021-01-28 23:09:32.720132 (MainThread): Flushing usage events
2021-01-28 23:12:35.074751 (MainThread): Running with dbt=0.18.1
2021-01-28 23:12:35.135142 (MainThread): Loading KWallet
2021-01-28 23:12:35.135606 (MainThread): Loading SecretService
2021-01-28 23:12:35.135979 (MainThread): Loading Windows
2021-01-28 23:12:35.136474 (MainThread): Loading chainer
2021-01-28 23:12:35.136725 (MainThread): Loading macOS
2021-01-28 23:12:35.383190 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-28 23:12:35.384183 (MainThread): Tracking: tracking
2021-01-28 23:12:35.384435 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113024400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113210cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113210970>]}
2021-01-28 23:12:35.404964 (MainThread): Partial parsing not enabled
2021-01-28 23:12:35.405841 (MainThread): Parsing macros/catalog.sql
2021-01-28 23:12:35.407896 (MainThread): Parsing macros/adapters.sql
2021-01-28 23:12:35.434726 (MainThread): Parsing macros/materializations/merge.sql
2021-01-28 23:12:35.436570 (MainThread): Parsing macros/materializations/view.sql
2021-01-28 23:12:35.437968 (MainThread): Parsing macros/materializations/table.sql
2021-01-28 23:12:35.441623 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-28 23:12:35.451949 (MainThread): Parsing macros/core.sql
2021-01-28 23:12:35.455312 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-28 23:12:35.463402 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-28 23:12:35.465021 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-28 23:12:35.480488 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-28 23:12:35.509051 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 23:12:35.528526 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-28 23:12:35.530262 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 23:12:35.535977 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-28 23:12:35.549083 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 23:12:35.555386 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 23:12:35.561147 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-28 23:12:35.565762 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-28 23:12:35.566641 (MainThread): Parsing macros/etc/query.sql
2021-01-28 23:12:35.567629 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-28 23:12:35.569150 (MainThread): Parsing macros/etc/datetime.sql
2021-01-28 23:12:35.577356 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-28 23:12:35.579258 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-28 23:12:35.580826 (MainThread): Parsing macros/adapters/common.sql
2021-01-28 23:12:35.620656 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-28 23:12:35.622404 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-28 23:12:35.623812 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-28 23:12:35.625387 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-28 23:12:35.632515 (MainThread): Partial parsing not enabled
2021-01-28 23:12:35.667251 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-28 23:12:35.687762 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-28 23:12:35.881791 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-28 23:12:35.882446 (MainThread): 
2021-01-28 23:12:35.882692 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 23:12:35.884925 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-28 23:12:35.896962 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-28 23:12:35.897039 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-28 23:12:35.897111 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-28 23:12:36.824025 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 0.93 seconds
2021-01-28 23:12:36.828712 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-28 23:12:36.996625 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt".
2021-01-28 23:12:36.996976 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt".
2021-01-28 23:12:36.997213 (ThreadPoolExecutor-0_0): Creating schema "analytics.dbt"
2021-01-28 23:12:37.003584 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt".
2021-01-28 23:12:37.003699 (ThreadPoolExecutor-0_0): On create_analytics_dbt: BEGIN
2021-01-28 23:12:37.003800 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-01-28 23:12:37.868027 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.86 seconds
2021-01-28 23:12:37.868275 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt".
2021-01-28 23:12:37.868423 (ThreadPoolExecutor-0_0): On create_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "create_analytics_dbt"} */
create schema if not exists analytics.dbt
2021-01-28 23:12:38.311497 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.44 seconds
2021-01-28 23:12:38.313245 (ThreadPoolExecutor-0_0): On create_analytics_dbt: COMMIT
2021-01-28 23:12:38.313461 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt".
2021-01-28 23:12:38.313582 (ThreadPoolExecutor-0_0): On create_analytics_dbt: COMMIT
2021-01-28 23:12:38.422027 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-28 23:12:38.422309 (ThreadPoolExecutor-0_0): On create_analytics_dbt: Close
2021-01-28 23:12:38.662979 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-28 23:12:38.669864 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-28 23:12:38.669961 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-28 23:12:38.670048 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-28 23:12:39.483610 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.81 seconds
2021-01-28 23:12:39.484283 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-28 23:12:39.644419 (MainThread): Using snowflake connection "master".
2021-01-28 23:12:39.644604 (MainThread): On master: BEGIN
2021-01-28 23:12:39.644733 (MainThread): Opening a new connection, currently in state init
2021-01-28 23:12:40.264444 (MainThread): SQL status: SUCCESS 1 in 0.62 seconds
2021-01-28 23:12:40.264715 (MainThread): On master: COMMIT
2021-01-28 23:12:40.264956 (MainThread): Using snowflake connection "master".
2021-01-28 23:12:40.265101 (MainThread): On master: COMMIT
2021-01-28 23:12:40.536898 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-28 23:12:40.537176 (MainThread): On master: Close
2021-01-28 23:12:40.761688 (MainThread): 17:12:40 | Concurrency: 1 threads (target='dev')
2021-01-28 23:12:40.761923 (MainThread): 17:12:40 | 
2021-01-28 23:12:40.764815 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-28 23:12:40.766393 (Thread-1): 17:12:40 | 1 of 2 START table model dbt.my_first_dbt_model...................... [RUN]
2021-01-28 23:12:40.766751 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-28 23:12:40.766888 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-28 23:12:40.785751 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-28 23:12:40.786096 (Thread-1): finished collecting timing info
2021-01-28 23:12:40.853228 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-28 23:12:40.854337 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-28 23:12:40.854436 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-01-28 23:12:40.854527 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 23:12:41.741919 (Thread-1): SQL status: SUCCESS 1 in 0.89 seconds
2021-01-28 23:12:41.742175 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-28 23:12:41.742319 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-01-28 23:12:43.022807 (Thread-1): SQL status: SUCCESS 1 in 1.28 seconds
2021-01-28 23:12:43.024393 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-28 23:12:43.024661 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-28 23:12:43.024801 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-28 23:12:43.150616 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-01-28 23:12:43.165416 (Thread-1): finished collecting timing info
2021-01-28 23:12:43.165652 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-01-28 23:12:43.364140 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c371af61-8f86-466d-ac51-f3c3d4219ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ea08e0>]}
2021-01-28 23:12:43.365816 (Thread-1): 17:12:43 | 1 of 2 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 2.60s]
2021-01-28 23:12:43.366005 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-28 23:12:43.366680 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-28 23:12:43.367923 (Thread-1): 17:12:43 | 2 of 2 START view model dbt.my_second_dbt_model...................... [RUN]
2021-01-28 23:12:43.368234 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-28 23:12:43.368374 (Thread-1): Compiling model.jrtests_learn_dbt.my_second_dbt_model
2021-01-28 23:12:43.377567 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-28 23:12:43.377954 (Thread-1): finished collecting timing info
2021-01-28 23:12:43.398005 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-28 23:12:43.398685 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-28 23:12:43.398777 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: BEGIN
2021-01-28 23:12:43.398865 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 23:12:44.040730 (Thread-1): SQL status: SUCCESS 1 in 0.64 seconds
2021-01-28 23:12:44.040984 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-28 23:12:44.041132 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_second_dbt_model"} */

  create or replace  view analytics.dbt.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
  );
2021-01-28 23:12:44.523258 (Thread-1): SQL status: SUCCESS 1 in 0.48 seconds
2021-01-28 23:12:44.524852 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-28 23:12:44.525129 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-28 23:12:44.525245 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-28 23:12:44.645248 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-28 23:12:44.649841 (Thread-1): finished collecting timing info
2021-01-28 23:12:44.650105 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: Close
2021-01-28 23:12:44.879423 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c371af61-8f86-466d-ac51-f3c3d4219ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f949d0>]}
2021-01-28 23:12:44.880722 (Thread-1): 17:12:44 | 2 of 2 OK created view model dbt.my_second_dbt_model................. [SUCCESS 1 in 1.51s]
2021-01-28 23:12:44.880867 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-28 23:12:44.881833 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 23:12:44.882042 (MainThread): Using snowflake connection "master".
2021-01-28 23:12:44.882142 (MainThread): On master: BEGIN
2021-01-28 23:12:44.882237 (MainThread): Opening a new connection, currently in state closed
2021-01-28 23:12:45.509953 (MainThread): SQL status: SUCCESS 1 in 0.63 seconds
2021-01-28 23:12:45.510202 (MainThread): On master: COMMIT
2021-01-28 23:12:45.510445 (MainThread): Using snowflake connection "master".
2021-01-28 23:12:45.510588 (MainThread): On master: COMMIT
2021-01-28 23:12:45.790739 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-28 23:12:45.791007 (MainThread): On master: Close
2021-01-28 23:12:46.011543 (MainThread): 17:12:46 | 
2021-01-28 23:12:46.011761 (MainThread): 17:12:46 | Finished running 1 table model, 1 view model in 10.13s.
2021-01-28 23:12:46.011909 (MainThread): Connection 'master' was properly closed.
2021-01-28 23:12:46.012014 (MainThread): Connection 'model.jrtests_learn_dbt.my_second_dbt_model' was properly closed.
2021-01-28 23:12:46.019958 (MainThread): 
2021-01-28 23:12:46.020100 (MainThread): Completed successfully
2021-01-28 23:12:46.020224 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-01-28 23:12:46.020394 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1162a9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d36b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d36df0>]}
2021-01-28 23:12:46.020586 (MainThread): Flushing usage events
2021-01-29 03:17:25.825383 (MainThread): Running with dbt=0.18.1
2021-01-29 03:17:25.947090 (MainThread): Loading KWallet
2021-01-29 03:17:25.948229 (MainThread): Loading SecretService
2021-01-29 03:17:25.949254 (MainThread): Loading Windows
2021-01-29 03:17:25.950544 (MainThread): Loading chainer
2021-01-29 03:17:25.951154 (MainThread): Loading macOS
2021-01-29 03:17:26.407450 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 03:17:26.408930 (MainThread): Tracking: tracking
2021-01-29 03:17:26.409399 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d99d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db89c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db89910>]}
2021-01-29 03:17:26.430194 (MainThread): Partial parsing not enabled
2021-01-29 03:17:26.431603 (MainThread): Parsing macros/catalog.sql
2021-01-29 03:17:26.433841 (MainThread): Parsing macros/adapters.sql
2021-01-29 03:17:26.461639 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 03:17:26.463757 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 03:17:26.465337 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 03:17:26.469329 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 03:17:26.480858 (MainThread): Parsing macros/core.sql
2021-01-29 03:17:26.484665 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 03:17:26.493460 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 03:17:26.495417 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 03:17:26.512090 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 03:17:26.540075 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 03:17:26.559907 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 03:17:26.561820 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 03:17:26.567858 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 03:17:26.581039 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 03:17:26.587661 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 03:17:26.594165 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 03:17:26.599021 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 03:17:26.600099 (MainThread): Parsing macros/etc/query.sql
2021-01-29 03:17:26.601401 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 03:17:26.603513 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 03:17:26.612337 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 03:17:26.614364 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 03:17:26.616231 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 03:17:26.664146 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 03:17:26.666544 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 03:17:26.668529 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 03:17:26.670777 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 03:17:26.679646 (MainThread): Partial parsing not enabled
2021-01-29 03:17:26.719562 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:17:26.742890 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:17:26.755013 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6e6e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e842bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e842dc0>]}
2021-01-29 03:17:26.755172 (MainThread): Flushing usage events
2021-01-29 03:17:27.162588 (MainThread): Connection 'model.jrtests_learn_dbt.my_second_dbt_model' was properly closed.
2021-01-29 03:17:27.162831 (MainThread): Encountered an error:
2021-01-29 03:17:27.163020 (MainThread): Compilation Error
  Error reading jrtests_learn_dbt: example/schema.yml - Runtime Error
    Syntax error near line 21
    ------------------------------
    18 |             tests:
    19 |                 - unique
    20 |                 - not_null
    21 |     -name: snowflake_customer_purchases
    22 |      description: "the total purchases for each customer in the snowflake sample data"
    23 |      columns:
    24 |        - name: c_custkey
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 4, column 5:
            - name: my_first_dbt_model
            ^
    expected <block end>, but found '?'
      in "<unicode string>", line 21, column 5:
            -name: snowflake_customer_purchases
            ^
2021-01-29 03:17:27.171395 (MainThread): Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 62, in load_yaml_text
    return safe_load(contents)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 57, in safe_load
    return yaml.load(contents, Loader=YamlLoader)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 36, in get_single_node
    document = self.compose_document()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 55, in compose_document
    node = self.compose_node(None, None)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 84, in compose_node
    node = self.compose_mapping_node(anchor)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 133, in compose_mapping_node
    item_value = self.compose_node(node, item_key)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 82, in compose_node
    node = self.compose_sequence_node(anchor)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 110, in compose_sequence_node
    while not self.check_event(SequenceEndEvent):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/parser.py", line 98, in check_event
    self.current_event = self.state()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/parser.py", line 392, in parse_block_sequence_entry
    raise ParserError("while parsing a block collection", self.marks[-1],
yaml.parser.ParserError: while parsing a block collection
  in "<unicode string>", line 4, column 5:
        - name: my_first_dbt_model
        ^
expected <block end>, but found '?'
  in "<unicode string>", line 21, column 5:
        -name: snowflake_customer_purchases
        ^

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/schemas.py", line 231, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 69, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 21
  ------------------------------
  18 |             tests:
  19 |                 - unique
  20 |                 - not_null
  21 |     -name: snowflake_customer_purchases
  22 |      description: "the total purchases for each customer in the snowflake sample data"
  23 |      columns:
  24 |        - name: c_custkey
  
  Raw Error:
  ------------------------------
  while parsing a block collection
    in "<unicode string>", line 4, column 5:
          - name: my_first_dbt_model
          ^
  expected <block end>, but found '?'
    in "<unicode string>", line 21, column 5:
          -name: snowflake_customer_purchases
          ^

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 399, in run
    self._runtime_initialize()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 748, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 349, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 204, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 177, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 133, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/schemas.py", line 530, in parse_file
    dct = self._yaml_from_file(block.file)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/schemas.py", line 234, in _yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading jrtests_learn_dbt: example/schema.yml - Runtime Error
    Syntax error near line 21
    ------------------------------
    18 |             tests:
    19 |                 - unique
    20 |                 - not_null
    21 |     -name: snowflake_customer_purchases
    22 |      description: "the total purchases for each customer in the snowflake sample data"
    23 |      columns:
    24 |        - name: c_custkey
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 4, column 5:
            - name: my_first_dbt_model
            ^
    expected <block end>, but found '?'
      in "<unicode string>", line 21, column 5:
            -name: snowflake_customer_purchases
            ^

2021-01-29 03:18:39.533401 (MainThread): Running with dbt=0.18.1
2021-01-29 03:18:39.593562 (MainThread): Loading KWallet
2021-01-29 03:18:39.594152 (MainThread): Loading SecretService
2021-01-29 03:18:39.594699 (MainThread): Loading Windows
2021-01-29 03:18:39.595206 (MainThread): Loading chainer
2021-01-29 03:18:39.595482 (MainThread): Loading macOS
2021-01-29 03:18:39.842838 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 03:18:39.843782 (MainThread): Tracking: tracking
2021-01-29 03:18:39.844072 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fb6370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111a3c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111a38e0>]}
2021-01-29 03:18:39.864040 (MainThread): Partial parsing not enabled
2021-01-29 03:18:39.864903 (MainThread): Parsing macros/catalog.sql
2021-01-29 03:18:39.867015 (MainThread): Parsing macros/adapters.sql
2021-01-29 03:18:39.893569 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 03:18:39.895405 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 03:18:39.897578 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 03:18:39.903218 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 03:18:39.914077 (MainThread): Parsing macros/core.sql
2021-01-29 03:18:39.917878 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 03:18:39.926095 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 03:18:39.927695 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 03:18:39.943437 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 03:18:39.971598 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 03:18:39.991422 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 03:18:39.993221 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 03:18:39.999106 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 03:18:40.012303 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 03:18:40.018766 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 03:18:40.024771 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 03:18:40.029480 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 03:18:40.030376 (MainThread): Parsing macros/etc/query.sql
2021-01-29 03:18:40.031370 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 03:18:40.032920 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 03:18:40.041427 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 03:18:40.043284 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 03:18:40.044880 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 03:18:40.085142 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 03:18:40.086793 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 03:18:40.088133 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 03:18:40.089633 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 03:18:40.096456 (MainThread): Partial parsing not enabled
2021-01-29 03:18:40.130778 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:18:40.150163 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:18:40.301163 (MainThread): WARNING: Found documentation for resource "snowflake_customer_purchases" which was not found or is disabled
2021-01-29 03:18:40.301352 (MainThread): [WARNING]: Test 'test.jrtests_learn_dbt.unique_snowflake_customer_purchases_c_custkey' (models/example/schema.yml) depends on a node named 'snowflake_customer_purchases' which was not found
2021-01-29 03:18:40.301459 (MainThread): [WARNING]: Test 'test.jrtests_learn_dbt.not_null_snowflake_customer_purchases_c_custkey' (models/example/schema.yml) depends on a node named 'snowflake_customer_purchases' which was not found
2021-01-29 03:18:40.372540 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-29 03:18:40.373251 (MainThread): 
2021-01-29 03:18:40.373491 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 03:18:40.375710 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-29 03:18:40.387382 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-29 03:18:40.387463 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-29 03:18:40.387537 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-29 03:18:41.369843 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.98 seconds
2021-01-29 03:18:41.375265 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-29 03:18:41.566543 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-29 03:18:41.573113 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-29 03:18:41.573210 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-29 03:18:41.573297 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-29 03:18:42.462756 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 0.89 seconds
2021-01-29 03:18:42.466258 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-29 03:18:42.636963 (MainThread): Using snowflake connection "master".
2021-01-29 03:18:42.637155 (MainThread): On master: BEGIN
2021-01-29 03:18:42.637287 (MainThread): Opening a new connection, currently in state init
2021-01-29 03:18:43.658959 (MainThread): SQL status: SUCCESS 1 in 1.02 seconds
2021-01-29 03:18:43.659234 (MainThread): On master: COMMIT
2021-01-29 03:18:43.659492 (MainThread): Using snowflake connection "master".
2021-01-29 03:18:43.659640 (MainThread): On master: COMMIT
2021-01-29 03:18:43.873571 (MainThread): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-29 03:18:43.873851 (MainThread): On master: Close
2021-01-29 03:18:44.034113 (MainThread): 21:18:44 | Concurrency: 1 threads (target='dev')
2021-01-29 03:18:44.034350 (MainThread): 21:18:44 | 
2021-01-29 03:18:44.037482 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-29 03:18:44.039017 (Thread-1): 21:18:44 | 1 of 2 START table model dbt.my_first_dbt_model...................... [RUN]
2021-01-29 03:18:44.039405 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:18:44.039566 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-29 03:18:44.097995 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-29 03:18:44.098482 (Thread-1): finished collecting timing info
2021-01-29 03:18:44.130426 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-29 03:18:44.131891 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:18:44.131992 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-01-29 03:18:44.132083 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 03:18:45.055792 (Thread-1): SQL status: SUCCESS 1 in 0.92 seconds
2021-01-29 03:18:45.055959 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:18:45.056042 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-01-29 03:18:46.341754 (Thread-1): SQL status: SUCCESS 1 in 1.29 seconds
2021-01-29 03:18:46.343476 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-29 03:18:46.343716 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:18:46.343838 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-29 03:18:46.446961 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2021-01-29 03:18:46.460692 (Thread-1): finished collecting timing info
2021-01-29 03:18:46.460927 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-01-29 03:18:46.624861 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '508d3230-421a-42e2-b4bf-b63ec7eec12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112000d30>]}
2021-01-29 03:18:46.626424 (Thread-1): 21:18:46 | 1 of 2 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 2.59s]
2021-01-29 03:18:46.626616 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-29 03:18:46.627194 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-29 03:18:46.628341 (Thread-1): 21:18:46 | 2 of 2 START view model dbt.my_second_dbt_model...................... [RUN]
2021-01-29 03:18:46.628639 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:18:46.628769 (Thread-1): Compiling model.jrtests_learn_dbt.my_second_dbt_model
2021-01-29 03:18:46.637675 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-29 03:18:46.638049 (Thread-1): finished collecting timing info
2021-01-29 03:18:46.657433 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-29 03:18:46.658090 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:18:46.658182 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: BEGIN
2021-01-29 03:18:46.658269 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 03:18:47.571493 (Thread-1): SQL status: SUCCESS 1 in 0.91 seconds
2021-01-29 03:18:47.571746 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:18:47.571897 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_second_dbt_model"} */

  create or replace  view analytics.dbt.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
  );
2021-01-29 03:18:48.182177 (Thread-1): SQL status: SUCCESS 1 in 0.61 seconds
2021-01-29 03:18:48.183718 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-29 03:18:48.183997 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:18:48.184117 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-29 03:18:48.321484 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-01-29 03:18:48.326286 (Thread-1): finished collecting timing info
2021-01-29 03:18:48.326616 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: Close
2021-01-29 03:18:48.517261 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '508d3230-421a-42e2-b4bf-b63ec7eec12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f8f190>]}
2021-01-29 03:18:48.518775 (Thread-1): 21:18:48 | 2 of 2 OK created view model dbt.my_second_dbt_model................. [SUCCESS 1 in 1.89s]
2021-01-29 03:18:48.518964 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-29 03:18:48.520178 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 03:18:48.520439 (MainThread): Using snowflake connection "master".
2021-01-29 03:18:48.520566 (MainThread): On master: BEGIN
2021-01-29 03:18:48.520690 (MainThread): Opening a new connection, currently in state closed
2021-01-29 03:18:49.822615 (MainThread): SQL status: SUCCESS 1 in 1.30 seconds
2021-01-29 03:18:49.822887 (MainThread): On master: COMMIT
2021-01-29 03:18:49.823134 (MainThread): Using snowflake connection "master".
2021-01-29 03:18:49.823280 (MainThread): On master: COMMIT
2021-01-29 03:18:50.232174 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-01-29 03:18:50.232450 (MainThread): On master: Close
2021-01-29 03:18:50.436884 (MainThread): 21:18:50 | 
2021-01-29 03:18:50.437118 (MainThread): 21:18:50 | Finished running 1 table model, 1 view model in 10.06s.
2021-01-29 03:18:50.437276 (MainThread): Connection 'master' was properly closed.
2021-01-29 03:18:50.437390 (MainThread): Connection 'model.jrtests_learn_dbt.my_second_dbt_model' was properly closed.
2021-01-29 03:18:50.445529 (MainThread): 
2021-01-29 03:18:50.445652 (MainThread): Completed successfully
2021-01-29 03:18:50.445767 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-01-29 03:18:50.445922 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e9f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e9fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111faa130>]}
2021-01-29 03:18:50.446098 (MainThread): Flushing usage events
2021-01-29 03:20:16.308427 (MainThread): Running with dbt=0.18.1
2021-01-29 03:20:16.371253 (MainThread): Loading KWallet
2021-01-29 03:20:16.371712 (MainThread): Loading SecretService
2021-01-29 03:20:16.372080 (MainThread): Loading Windows
2021-01-29 03:20:16.372662 (MainThread): Loading chainer
2021-01-29 03:20:16.372906 (MainThread): Loading macOS
2021-01-29 03:20:16.620013 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 03:20:16.621024 (MainThread): Tracking: tracking
2021-01-29 03:20:16.621355 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039b6370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ba2c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ba2910>]}
2021-01-29 03:20:16.640678 (MainThread): Partial parsing not enabled
2021-01-29 03:20:16.641553 (MainThread): Parsing macros/catalog.sql
2021-01-29 03:20:16.643718 (MainThread): Parsing macros/adapters.sql
2021-01-29 03:20:16.670758 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 03:20:16.673045 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 03:20:16.674665 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 03:20:16.679021 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 03:20:16.690754 (MainThread): Parsing macros/core.sql
2021-01-29 03:20:16.694542 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 03:20:16.703385 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 03:20:16.705184 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 03:20:16.720886 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 03:20:16.748197 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 03:20:16.767465 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 03:20:16.769203 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 03:20:16.775005 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 03:20:16.788260 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 03:20:16.794825 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 03:20:16.800758 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 03:20:16.805424 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 03:20:16.806305 (MainThread): Parsing macros/etc/query.sql
2021-01-29 03:20:16.807282 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 03:20:16.808810 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 03:20:16.817087 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 03:20:16.818925 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 03:20:16.820498 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 03:20:16.860169 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 03:20:16.862112 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 03:20:16.863534 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 03:20:16.865123 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 03:20:16.871989 (MainThread): Partial parsing not enabled
2021-01-29 03:20:16.905878 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:20:16.925414 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:20:16.935671 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 03:20:17.162713 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-29 03:20:17.163436 (MainThread): 
2021-01-29 03:20:17.163668 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 03:20:17.166720 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-29 03:20:17.178420 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-29 03:20:17.178505 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-29 03:20:17.178581 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-29 03:20:18.435865 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.26 seconds
2021-01-29 03:20:18.440682 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-29 03:20:18.780415 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-29 03:20:18.787096 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-29 03:20:18.787198 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-29 03:20:18.787289 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-29 03:20:19.877750 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.09 seconds
2021-01-29 03:20:19.881286 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-29 03:20:20.077477 (MainThread): Using snowflake connection "master".
2021-01-29 03:20:20.077666 (MainThread): On master: BEGIN
2021-01-29 03:20:20.077797 (MainThread): Opening a new connection, currently in state init
2021-01-29 03:20:21.138030 (MainThread): SQL status: SUCCESS 1 in 1.06 seconds
2021-01-29 03:20:21.138303 (MainThread): On master: COMMIT
2021-01-29 03:20:21.138556 (MainThread): Using snowflake connection "master".
2021-01-29 03:20:21.138706 (MainThread): On master: COMMIT
2021-01-29 03:20:21.372550 (MainThread): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-29 03:20:21.372833 (MainThread): On master: Close
2021-01-29 03:20:21.557861 (MainThread): 21:20:21 | Concurrency: 1 threads (target='dev')
2021-01-29 03:20:21.558095 (MainThread): 21:20:21 | 
2021-01-29 03:20:21.559768 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-29 03:20:21.561199 (Thread-1): 21:20:21 | 1 of 3 START table model dbt.my_first_dbt_model...................... [RUN]
2021-01-29 03:20:21.561505 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:20:21.561856 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-29 03:20:21.580767 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-29 03:20:21.581114 (Thread-1): finished collecting timing info
2021-01-29 03:20:21.612159 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-29 03:20:21.613145 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:20:21.613249 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-01-29 03:20:21.613338 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 03:20:22.261768 (Thread-1): SQL status: SUCCESS 1 in 0.65 seconds
2021-01-29 03:20:22.262021 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:20:22.262172 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-01-29 03:20:23.415803 (Thread-1): SQL status: SUCCESS 1 in 1.15 seconds
2021-01-29 03:20:23.417499 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-29 03:20:23.417755 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:20:23.417875 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-29 03:20:23.528439 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-29 03:20:23.543396 (Thread-1): finished collecting timing info
2021-01-29 03:20:23.543629 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-01-29 03:20:23.732603 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ba27a8b-fd62-48c0-ab46-113d0aa0abe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049501c0>]}
2021-01-29 03:20:23.734199 (Thread-1): 21:20:23 | 1 of 3 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 2.17s]
2021-01-29 03:20:23.734397 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-29 03:20:23.734581 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-29 03:20:23.735798 (Thread-1): 21:20:23 | 2 of 3 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-29 03:20:23.736229 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 03:20:23.736367 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-29 03:20:23.744287 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-29 03:20:23.745178 (Thread-1): finished collecting timing info
2021-01-29 03:20:23.749318 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-29 03:20:23.750261 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 03:20:23.750352 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-29 03:20:23.750438 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 03:20:24.582813 (Thread-1): SQL status: SUCCESS 1 in 0.83 seconds
2021-01-29 03:20:24.583071 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 03:20:24.583224 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-29 03:20:26.897057 (Thread-1): SQL status: SUCCESS 1 in 2.31 seconds
2021-01-29 03:20:26.898661 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-29 03:20:26.898939 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 03:20:26.899060 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-29 03:20:27.037577 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-01-29 03:20:27.040700 (Thread-1): finished collecting timing info
2021-01-29 03:20:27.041030 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-29 03:20:27.205029 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ba27a8b-fd62-48c0-ab46-113d0aa0abe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104875610>]}
2021-01-29 03:20:27.206579 (Thread-1): 21:20:27 | 2 of 3 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.47s]
2021-01-29 03:20:27.206766 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-29 03:20:27.206949 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-29 03:20:27.208153 (Thread-1): 21:20:27 | 3 of 3 START view model dbt.my_second_dbt_model...................... [RUN]
2021-01-29 03:20:27.208534 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:20:27.208663 (Thread-1): Compiling model.jrtests_learn_dbt.my_second_dbt_model
2021-01-29 03:20:27.217420 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-29 03:20:27.217786 (Thread-1): finished collecting timing info
2021-01-29 03:20:27.236634 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-29 03:20:27.237258 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:20:27.237348 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: BEGIN
2021-01-29 03:20:27.237430 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 03:20:28.123758 (Thread-1): SQL status: SUCCESS 1 in 0.89 seconds
2021-01-29 03:20:28.124008 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:20:28.124155 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_second_dbt_model"} */

  create or replace  view analytics.dbt.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
  );
2021-01-29 03:20:28.681712 (Thread-1): SQL status: SUCCESS 1 in 0.56 seconds
2021-01-29 03:20:28.682737 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-29 03:20:28.682908 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:20:28.683004 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-29 03:20:28.853765 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-29 03:20:28.858571 (Thread-1): finished collecting timing info
2021-01-29 03:20:28.858903 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: Close
2021-01-29 03:20:29.050003 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ba27a8b-fd62-48c0-ab46-113d0aa0abe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104816c10>]}
2021-01-29 03:20:29.051604 (Thread-1): 21:20:29 | 3 of 3 OK created view model dbt.my_second_dbt_model................. [SUCCESS 1 in 1.84s]
2021-01-29 03:20:29.051791 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-29 03:20:29.053008 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 03:20:29.053211 (MainThread): Using snowflake connection "master".
2021-01-29 03:20:29.053307 (MainThread): On master: BEGIN
2021-01-29 03:20:29.053403 (MainThread): Opening a new connection, currently in state closed
2021-01-29 03:20:29.970125 (MainThread): SQL status: SUCCESS 1 in 0.92 seconds
2021-01-29 03:20:29.970398 (MainThread): On master: COMMIT
2021-01-29 03:20:29.970644 (MainThread): Using snowflake connection "master".
2021-01-29 03:20:29.970789 (MainThread): On master: COMMIT
2021-01-29 03:20:30.378812 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-01-29 03:20:30.379089 (MainThread): On master: Close
2021-01-29 03:20:30.570734 (MainThread): 21:20:30 | 
2021-01-29 03:20:30.570962 (MainThread): 21:20:30 | Finished running 2 table models, 1 view model in 13.41s.
2021-01-29 03:20:30.571120 (MainThread): Connection 'master' was properly closed.
2021-01-29 03:20:30.571228 (MainThread): Connection 'model.jrtests_learn_dbt.my_second_dbt_model' was properly closed.
2021-01-29 03:20:30.581618 (MainThread): 
2021-01-29 03:20:30.581736 (MainThread): Completed successfully
2021-01-29 03:20:30.581842 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-01-29 03:20:30.581994 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104993040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10467f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10467f580>]}
2021-01-29 03:20:30.582165 (MainThread): Flushing usage events
2021-01-29 03:48:23.306870 (MainThread): Running with dbt=0.18.1
2021-01-29 03:48:23.417159 (MainThread): Loading KWallet
2021-01-29 03:48:23.418011 (MainThread): Loading SecretService
2021-01-29 03:48:23.419187 (MainThread): Loading Windows
2021-01-29 03:48:23.420516 (MainThread): Loading chainer
2021-01-29 03:48:23.421106 (MainThread): Loading macOS
2021-01-29 03:48:23.828476 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 03:48:23.829804 (MainThread): Tracking: tracking
2021-01-29 03:48:23.830050 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122f23a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124dec70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124de910>]}
2021-01-29 03:48:23.850113 (MainThread): Partial parsing not enabled
2021-01-29 03:48:23.851132 (MainThread): Parsing macros/catalog.sql
2021-01-29 03:48:23.853334 (MainThread): Parsing macros/adapters.sql
2021-01-29 03:48:23.881001 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 03:48:23.883048 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 03:48:23.884684 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 03:48:23.888651 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 03:48:23.899291 (MainThread): Parsing macros/core.sql
2021-01-29 03:48:23.903470 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 03:48:23.912194 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 03:48:23.914128 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 03:48:23.930286 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 03:48:23.957914 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 03:48:23.977917 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 03:48:23.980025 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 03:48:23.986301 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 03:48:23.999770 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 03:48:24.006330 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 03:48:24.012551 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 03:48:24.017428 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 03:48:24.018480 (MainThread): Parsing macros/etc/query.sql
2021-01-29 03:48:24.019805 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 03:48:24.021934 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 03:48:24.030582 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 03:48:24.032586 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 03:48:24.034366 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 03:48:24.074566 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 03:48:24.076455 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 03:48:24.078089 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 03:48:24.079865 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 03:48:24.087319 (MainThread): Partial parsing not enabled
2021-01-29 03:48:24.122692 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:48:24.143322 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 03:48:24.154183 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:48:24.164707 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 03:48:24.175952 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11303be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131b90d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131b9f40>]}
2021-01-29 03:48:24.176112 (MainThread): Flushing usage events
2021-01-29 03:48:24.583997 (MainThread): Connection 'model.jrtests_learn_dbt.snowflake_customer_purchases' was properly closed.
2021-01-29 03:48:24.584241 (MainThread): Encountered an error:
2021-01-29 03:48:24.584429 (MainThread): Compilation Error
  Error reading jrtests_learn_dbt: example/schema.yml - Runtime Error
    Syntax error near line 29
    ------------------------------
    26 |               - unique
    27 |               - not_null
    28 | 
    29 |      - name: cumulative_orders_by_date
    30 |        description: "the total purchases for each customer in the snowflake sample data"
    31 |        columns:
    32 |           - name: c_custkey
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 4, column 5:
            - name: my_first_dbt_model
            ^
    expected <block end>, but found '<block sequence start>'
      in "<unicode string>", line 29, column 6:
             - name: cumulative_orders_by_date
             ^
2021-01-29 03:48:24.594535 (MainThread): Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 62, in load_yaml_text
    return safe_load(contents)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 57, in safe_load
    return yaml.load(contents, Loader=YamlLoader)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 36, in get_single_node
    document = self.compose_document()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 55, in compose_document
    node = self.compose_node(None, None)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 84, in compose_node
    node = self.compose_mapping_node(anchor)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 133, in compose_mapping_node
    item_value = self.compose_node(node, item_key)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 82, in compose_node
    node = self.compose_sequence_node(anchor)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 110, in compose_sequence_node
    while not self.check_event(SequenceEndEvent):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/parser.py", line 98, in check_event
    self.current_event = self.state()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/parser.py", line 392, in parse_block_sequence_entry
    raise ParserError("while parsing a block collection", self.marks[-1],
yaml.parser.ParserError: while parsing a block collection
  in "<unicode string>", line 4, column 5:
        - name: my_first_dbt_model
        ^
expected <block end>, but found '<block sequence start>'
  in "<unicode string>", line 29, column 6:
         - name: cumulative_orders_by_date
         ^

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/schemas.py", line 231, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 69, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 29
  ------------------------------
  26 |               - unique
  27 |               - not_null
  28 | 
  29 |      - name: cumulative_orders_by_date
  30 |        description: "the total purchases for each customer in the snowflake sample data"
  31 |        columns:
  32 |           - name: c_custkey
  
  Raw Error:
  ------------------------------
  while parsing a block collection
    in "<unicode string>", line 4, column 5:
          - name: my_first_dbt_model
          ^
  expected <block end>, but found '<block sequence start>'
    in "<unicode string>", line 29, column 6:
           - name: cumulative_orders_by_date
           ^

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 399, in run
    self._runtime_initialize()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 748, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 349, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 204, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 177, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 133, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/schemas.py", line 530, in parse_file
    dct = self._yaml_from_file(block.file)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/schemas.py", line 234, in _yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading jrtests_learn_dbt: example/schema.yml - Runtime Error
    Syntax error near line 29
    ------------------------------
    26 |               - unique
    27 |               - not_null
    28 | 
    29 |      - name: cumulative_orders_by_date
    30 |        description: "the total purchases for each customer in the snowflake sample data"
    31 |        columns:
    32 |           - name: c_custkey
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 4, column 5:
            - name: my_first_dbt_model
            ^
    expected <block end>, but found '<block sequence start>'
      in "<unicode string>", line 29, column 6:
             - name: cumulative_orders_by_date
             ^

2021-01-29 03:49:49.232695 (MainThread): Running with dbt=0.18.1
2021-01-29 03:49:49.335530 (MainThread): Loading KWallet
2021-01-29 03:49:49.336542 (MainThread): Loading SecretService
2021-01-29 03:49:49.337425 (MainThread): Loading Windows
2021-01-29 03:49:49.338372 (MainThread): Loading chainer
2021-01-29 03:49:49.339078 (MainThread): Loading macOS
2021-01-29 03:49:49.740210 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 03:49:49.741897 (MainThread): Tracking: tracking
2021-01-29 03:49:49.742208 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f0b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f8c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f88e0>]}
2021-01-29 03:49:49.761859 (MainThread): Partial parsing not enabled
2021-01-29 03:49:49.762880 (MainThread): Parsing macros/catalog.sql
2021-01-29 03:49:49.765113 (MainThread): Parsing macros/adapters.sql
2021-01-29 03:49:49.792388 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 03:49:49.794413 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 03:49:49.795966 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 03:49:49.799887 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 03:49:49.810622 (MainThread): Parsing macros/core.sql
2021-01-29 03:49:49.814794 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 03:49:49.823561 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 03:49:49.825594 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 03:49:49.841652 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 03:49:49.870316 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 03:49:49.894455 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 03:49:49.896503 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 03:49:49.902820 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 03:49:49.921807 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 03:49:49.928937 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 03:49:49.935108 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 03:49:49.940003 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 03:49:49.941110 (MainThread): Parsing macros/etc/query.sql
2021-01-29 03:49:49.942715 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 03:49:49.945098 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 03:49:49.954521 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 03:49:49.956569 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 03:49:49.958324 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 03:49:49.998817 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 03:49:50.000780 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 03:49:50.002454 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 03:49:50.004255 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 03:49:50.011501 (MainThread): Partial parsing not enabled
2021-01-29 03:49:50.046833 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:49:50.067118 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 03:49:50.078005 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:49:50.088417 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 03:49:50.099819 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c317f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd2040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd2f10>]}
2021-01-29 03:49:50.099982 (MainThread): Flushing usage events
2021-01-29 03:49:51.534836 (MainThread): Connection 'model.jrtests_learn_dbt.snowflake_customer_purchases' was properly closed.
2021-01-29 03:49:51.535082 (MainThread): Encountered an error:
2021-01-29 03:49:51.535273 (MainThread): Compilation Error
  Error reading jrtests_learn_dbt: example/schema.yml - Runtime Error
    Syntax error near line 30
    ------------------------------
    27 |               - not_null
    28 | 
    29 | 
    30 |      - name: cumulative_orders_by_date
    31 |        description: "the total purchases for each customer in the snowflake sample data"
    32 |        columns:
    33 |           - name: o_orderdate
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 4, column 5:
            - name: my_first_dbt_model
            ^
    expected <block end>, but found '<block sequence start>'
      in "<unicode string>", line 30, column 6:
             - name: cumulative_orders_by_date
             ^
2021-01-29 03:49:51.547814 (MainThread): Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 62, in load_yaml_text
    return safe_load(contents)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 57, in safe_load
    return yaml.load(contents, Loader=YamlLoader)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 36, in get_single_node
    document = self.compose_document()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 55, in compose_document
    node = self.compose_node(None, None)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 84, in compose_node
    node = self.compose_mapping_node(anchor)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 133, in compose_mapping_node
    item_value = self.compose_node(node, item_key)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 82, in compose_node
    node = self.compose_sequence_node(anchor)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 110, in compose_sequence_node
    while not self.check_event(SequenceEndEvent):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/parser.py", line 98, in check_event
    self.current_event = self.state()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/parser.py", line 392, in parse_block_sequence_entry
    raise ParserError("while parsing a block collection", self.marks[-1],
yaml.parser.ParserError: while parsing a block collection
  in "<unicode string>", line 4, column 5:
        - name: my_first_dbt_model
        ^
expected <block end>, but found '<block sequence start>'
  in "<unicode string>", line 30, column 6:
         - name: cumulative_orders_by_date
         ^

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/schemas.py", line 231, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 69, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 30
  ------------------------------
  27 |               - not_null
  28 | 
  29 | 
  30 |      - name: cumulative_orders_by_date
  31 |        description: "the total purchases for each customer in the snowflake sample data"
  32 |        columns:
  33 |           - name: o_orderdate
  
  Raw Error:
  ------------------------------
  while parsing a block collection
    in "<unicode string>", line 4, column 5:
          - name: my_first_dbt_model
          ^
  expected <block end>, but found '<block sequence start>'
    in "<unicode string>", line 30, column 6:
           - name: cumulative_orders_by_date
           ^

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 399, in run
    self._runtime_initialize()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 748, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 349, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 204, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 177, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 133, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/schemas.py", line 530, in parse_file
    dct = self._yaml_from_file(block.file)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/schemas.py", line 234, in _yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading jrtests_learn_dbt: example/schema.yml - Runtime Error
    Syntax error near line 30
    ------------------------------
    27 |               - not_null
    28 | 
    29 | 
    30 |      - name: cumulative_orders_by_date
    31 |        description: "the total purchases for each customer in the snowflake sample data"
    32 |        columns:
    33 |           - name: o_orderdate
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 4, column 5:
            - name: my_first_dbt_model
            ^
    expected <block end>, but found '<block sequence start>'
      in "<unicode string>", line 30, column 6:
             - name: cumulative_orders_by_date
             ^

2021-01-29 03:51:14.193346 (MainThread): Running with dbt=0.18.1
2021-01-29 03:51:14.253479 (MainThread): Loading KWallet
2021-01-29 03:51:14.253932 (MainThread): Loading SecretService
2021-01-29 03:51:14.254297 (MainThread): Loading Windows
2021-01-29 03:51:14.254776 (MainThread): Loading chainer
2021-01-29 03:51:14.255026 (MainThread): Loading macOS
2021-01-29 03:51:14.505793 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 03:51:14.506819 (MainThread): Tracking: tracking
2021-01-29 03:51:14.507082 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a866370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa52c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa528b0>]}
2021-01-29 03:51:14.526601 (MainThread): Partial parsing not enabled
2021-01-29 03:51:14.527478 (MainThread): Parsing macros/catalog.sql
2021-01-29 03:51:14.529570 (MainThread): Parsing macros/adapters.sql
2021-01-29 03:51:14.556777 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 03:51:14.558661 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 03:51:14.560049 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 03:51:14.563760 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 03:51:14.573962 (MainThread): Parsing macros/core.sql
2021-01-29 03:51:14.577233 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 03:51:14.585114 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 03:51:14.586679 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 03:51:14.601794 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 03:51:14.630299 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 03:51:14.649587 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 03:51:14.651293 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 03:51:14.657051 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 03:51:14.670158 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 03:51:14.676403 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 03:51:14.682630 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 03:51:14.687858 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 03:51:14.688746 (MainThread): Parsing macros/etc/query.sql
2021-01-29 03:51:14.689693 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 03:51:14.691167 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 03:51:14.699251 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 03:51:14.701084 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 03:51:14.702612 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 03:51:14.741590 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 03:51:14.743395 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 03:51:14.744769 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 03:51:14.746307 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 03:51:14.753197 (MainThread): Partial parsing not enabled
2021-01-29 03:51:14.787917 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:51:14.807331 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 03:51:14.817280 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:51:14.827471 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 03:51:14.839334 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5b2640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b72c0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b72cee0>]}
2021-01-29 03:51:14.839487 (MainThread): Flushing usage events
2021-01-29 03:51:15.227195 (MainThread): Connection 'model.jrtests_learn_dbt.snowflake_customer_purchases' was properly closed.
2021-01-29 03:51:15.227439 (MainThread): Encountered an error:
2021-01-29 03:51:15.227627 (MainThread): Compilation Error
  Error reading jrtests_learn_dbt: example/schema.yml - Runtime Error
    Syntax error near line 30
    ------------------------------
    27 |               - not_null
    28 | 
    29 | 
    30 |      - name: cumulative_orders_by_date
    31 |        description: "the total purchases for each customer in the snowflake sample data"
    32 |        columns:
    33 |           - name: o_orderdate
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 4, column 5:
            - name: my_first_dbt_model
            ^
    expected <block end>, but found '<block sequence start>'
      in "<unicode string>", line 30, column 6:
             - name: cumulative_orders_by_date
             ^
2021-01-29 03:51:15.230376 (MainThread): Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 62, in load_yaml_text
    return safe_load(contents)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 57, in safe_load
    return yaml.load(contents, Loader=YamlLoader)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 36, in get_single_node
    document = self.compose_document()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 55, in compose_document
    node = self.compose_node(None, None)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 84, in compose_node
    node = self.compose_mapping_node(anchor)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 133, in compose_mapping_node
    item_value = self.compose_node(node, item_key)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 82, in compose_node
    node = self.compose_sequence_node(anchor)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 110, in compose_sequence_node
    while not self.check_event(SequenceEndEvent):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/parser.py", line 98, in check_event
    self.current_event = self.state()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/parser.py", line 392, in parse_block_sequence_entry
    raise ParserError("while parsing a block collection", self.marks[-1],
yaml.parser.ParserError: while parsing a block collection
  in "<unicode string>", line 4, column 5:
        - name: my_first_dbt_model
        ^
expected <block end>, but found '<block sequence start>'
  in "<unicode string>", line 30, column 6:
         - name: cumulative_orders_by_date
         ^

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/schemas.py", line 231, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 69, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 30
  ------------------------------
  27 |               - not_null
  28 | 
  29 | 
  30 |      - name: cumulative_orders_by_date
  31 |        description: "the total purchases for each customer in the snowflake sample data"
  32 |        columns:
  33 |           - name: o_orderdate
  
  Raw Error:
  ------------------------------
  while parsing a block collection
    in "<unicode string>", line 4, column 5:
          - name: my_first_dbt_model
          ^
  expected <block end>, but found '<block sequence start>'
    in "<unicode string>", line 30, column 6:
           - name: cumulative_orders_by_date
           ^

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 399, in run
    self._runtime_initialize()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 748, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 349, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 204, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 177, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 133, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/schemas.py", line 530, in parse_file
    dct = self._yaml_from_file(block.file)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/schemas.py", line 234, in _yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading jrtests_learn_dbt: example/schema.yml - Runtime Error
    Syntax error near line 30
    ------------------------------
    27 |               - not_null
    28 | 
    29 | 
    30 |      - name: cumulative_orders_by_date
    31 |        description: "the total purchases for each customer in the snowflake sample data"
    32 |        columns:
    33 |           - name: o_orderdate
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 4, column 5:
            - name: my_first_dbt_model
            ^
    expected <block end>, but found '<block sequence start>'
      in "<unicode string>", line 30, column 6:
             - name: cumulative_orders_by_date
             ^

2021-01-29 03:51:57.559705 (MainThread): Running with dbt=0.18.1
2021-01-29 03:51:57.620309 (MainThread): Loading KWallet
2021-01-29 03:51:57.620773 (MainThread): Loading SecretService
2021-01-29 03:51:57.621140 (MainThread): Loading Windows
2021-01-29 03:51:57.621621 (MainThread): Loading chainer
2021-01-29 03:51:57.621864 (MainThread): Loading macOS
2021-01-29 03:51:57.862752 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 03:51:57.863627 (MainThread): Tracking: tracking
2021-01-29 03:51:57.864139 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10317a100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103367c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033678e0>]}
2021-01-29 03:51:57.884149 (MainThread): Partial parsing not enabled
2021-01-29 03:51:57.885026 (MainThread): Parsing macros/catalog.sql
2021-01-29 03:51:57.887104 (MainThread): Parsing macros/adapters.sql
2021-01-29 03:51:57.913666 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 03:51:57.915519 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 03:51:57.916882 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 03:51:57.920545 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 03:51:57.930648 (MainThread): Parsing macros/core.sql
2021-01-29 03:51:57.934022 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 03:51:57.942321 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 03:51:57.943934 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 03:51:57.959337 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 03:51:57.986898 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 03:51:58.006258 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 03:51:58.007961 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 03:51:58.013758 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 03:51:58.027219 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 03:51:58.033820 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 03:51:58.039594 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 03:51:58.044027 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 03:51:58.044867 (MainThread): Parsing macros/etc/query.sql
2021-01-29 03:51:58.045811 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 03:51:58.047265 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 03:51:58.055325 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 03:51:58.057144 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 03:51:58.058710 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 03:51:58.098444 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 03:51:58.100124 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 03:51:58.101490 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 03:51:58.103014 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 03:51:58.109835 (MainThread): Partial parsing not enabled
2021-01-29 03:51:58.143926 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:51:58.163626 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 03:51:58.173433 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:51:58.183281 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 03:51:58.194216 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eb27f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040410d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104041f10>]}
2021-01-29 03:51:58.194379 (MainThread): Flushing usage events
2021-01-29 03:51:58.535216 (MainThread): Connection 'model.jrtests_learn_dbt.snowflake_customer_purchases' was properly closed.
2021-01-29 03:51:58.535464 (MainThread): Encountered an error:
2021-01-29 03:51:58.535648 (MainThread): Compilation Error
  Error reading jrtests_learn_dbt: example/schema.yml - Runtime Error
    Syntax error near line 30
    ------------------------------
    27 |               - not_null
    28 | 
    29 | 
    30 |      - name: cumulative_orders_by_date
    31 |        description: "the total purchases for each customer in the snowflake sample data"
    32 |        columns:
    33 |           - name: o_orderdate
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 4, column 5:
            - name: my_first_dbt_model
            ^
    expected <block end>, but found '<block sequence start>'
      in "<unicode string>", line 30, column 6:
             - name: cumulative_orders_by_date
             ^
2021-01-29 03:51:58.538533 (MainThread): Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 62, in load_yaml_text
    return safe_load(contents)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 57, in safe_load
    return yaml.load(contents, Loader=YamlLoader)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 36, in get_single_node
    document = self.compose_document()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 55, in compose_document
    node = self.compose_node(None, None)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 84, in compose_node
    node = self.compose_mapping_node(anchor)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 133, in compose_mapping_node
    item_value = self.compose_node(node, item_key)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 82, in compose_node
    node = self.compose_sequence_node(anchor)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 110, in compose_sequence_node
    while not self.check_event(SequenceEndEvent):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/parser.py", line 98, in check_event
    self.current_event = self.state()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/parser.py", line 392, in parse_block_sequence_entry
    raise ParserError("while parsing a block collection", self.marks[-1],
yaml.parser.ParserError: while parsing a block collection
  in "<unicode string>", line 4, column 5:
        - name: my_first_dbt_model
        ^
expected <block end>, but found '<block sequence start>'
  in "<unicode string>", line 30, column 6:
         - name: cumulative_orders_by_date
         ^

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/schemas.py", line 231, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 69, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 30
  ------------------------------
  27 |               - not_null
  28 | 
  29 | 
  30 |      - name: cumulative_orders_by_date
  31 |        description: "the total purchases for each customer in the snowflake sample data"
  32 |        columns:
  33 |           - name: o_orderdate
  
  Raw Error:
  ------------------------------
  while parsing a block collection
    in "<unicode string>", line 4, column 5:
          - name: my_first_dbt_model
          ^
  expected <block end>, but found '<block sequence start>'
    in "<unicode string>", line 30, column 6:
           - name: cumulative_orders_by_date
           ^

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 399, in run
    self._runtime_initialize()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 748, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 349, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 204, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 177, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 133, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/schemas.py", line 530, in parse_file
    dct = self._yaml_from_file(block.file)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/schemas.py", line 234, in _yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading jrtests_learn_dbt: example/schema.yml - Runtime Error
    Syntax error near line 30
    ------------------------------
    27 |               - not_null
    28 | 
    29 | 
    30 |      - name: cumulative_orders_by_date
    31 |        description: "the total purchases for each customer in the snowflake sample data"
    32 |        columns:
    33 |           - name: o_orderdate
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 4, column 5:
            - name: my_first_dbt_model
            ^
    expected <block end>, but found '<block sequence start>'
      in "<unicode string>", line 30, column 6:
             - name: cumulative_orders_by_date
             ^

2021-01-29 03:52:24.878305 (MainThread): Running with dbt=0.18.1
2021-01-29 03:52:24.986720 (MainThread): Loading KWallet
2021-01-29 03:52:24.987649 (MainThread): Loading SecretService
2021-01-29 03:52:24.988827 (MainThread): Loading Windows
2021-01-29 03:52:24.990117 (MainThread): Loading chainer
2021-01-29 03:52:24.990701 (MainThread): Loading macOS
2021-01-29 03:52:25.386513 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 03:52:25.387894 (MainThread): Tracking: tracking
2021-01-29 03:52:25.388200 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c9a490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e86c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e86910>]}
2021-01-29 03:52:25.408607 (MainThread): Partial parsing not enabled
2021-01-29 03:52:25.409674 (MainThread): Parsing macros/catalog.sql
2021-01-29 03:52:25.411929 (MainThread): Parsing macros/adapters.sql
2021-01-29 03:52:25.439060 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 03:52:25.442557 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 03:52:25.444634 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 03:52:25.449705 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 03:52:25.463228 (MainThread): Parsing macros/core.sql
2021-01-29 03:52:25.469566 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 03:52:25.481566 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 03:52:25.483874 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 03:52:25.503425 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 03:52:25.531390 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 03:52:25.550784 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 03:52:25.552680 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 03:52:25.558629 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 03:52:25.571746 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 03:52:25.578435 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 03:52:25.584584 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 03:52:25.590332 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 03:52:25.591413 (MainThread): Parsing macros/etc/query.sql
2021-01-29 03:52:25.592939 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 03:52:25.595301 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 03:52:25.604418 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 03:52:25.606462 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 03:52:25.608242 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 03:52:25.647968 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 03:52:25.649906 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 03:52:25.651575 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 03:52:25.653482 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 03:52:25.660880 (MainThread): Partial parsing not enabled
2021-01-29 03:52:25.695597 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:52:25.716294 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 03:52:25.728170 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:52:25.740200 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 03:52:25.974788 (MainThread): Found 4 models, 6 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-29 03:52:25.975626 (MainThread): 
2021-01-29 03:52:25.975920 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 03:52:25.980354 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-29 03:52:25.992409 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-29 03:52:25.992492 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-29 03:52:25.992568 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-29 03:52:27.113254 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.12 seconds
2021-01-29 03:52:27.118796 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-29 03:52:27.302243 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-29 03:52:27.343299 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-29 03:52:27.343461 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-29 03:52:27.343570 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-29 03:52:28.328085 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 0.98 seconds
2021-01-29 03:52:28.332634 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-29 03:52:28.528841 (MainThread): Using snowflake connection "master".
2021-01-29 03:52:28.528996 (MainThread): On master: BEGIN
2021-01-29 03:52:28.529087 (MainThread): Opening a new connection, currently in state init
2021-01-29 03:52:29.375562 (MainThread): SQL status: SUCCESS 1 in 0.85 seconds
2021-01-29 03:52:29.375837 (MainThread): On master: COMMIT
2021-01-29 03:52:29.376088 (MainThread): Using snowflake connection "master".
2021-01-29 03:52:29.376235 (MainThread): On master: COMMIT
2021-01-29 03:52:29.784910 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-01-29 03:52:29.785178 (MainThread): On master: Close
2021-01-29 03:52:29.989518 (MainThread): 21:52:29 | Concurrency: 1 threads (target='dev')
2021-01-29 03:52:29.989760 (MainThread): 21:52:29 | 
2021-01-29 03:52:29.992155 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-29 03:52:29.993751 (Thread-1): 21:52:29 | 1 of 4 START table model dbt.my_first_dbt_model...................... [RUN]
2021-01-29 03:52:29.994144 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:52:29.994272 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-29 03:52:30.013940 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-29 03:52:30.014291 (Thread-1): finished collecting timing info
2021-01-29 03:52:30.045298 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-29 03:52:30.046268 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:52:30.046364 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-01-29 03:52:30.046451 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 03:52:30.963662 (Thread-1): SQL status: SUCCESS 1 in 0.92 seconds
2021-01-29 03:52:30.963918 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:52:30.964075 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-01-29 03:52:32.242733 (Thread-1): SQL status: SUCCESS 1 in 1.28 seconds
2021-01-29 03:52:32.244447 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-29 03:52:32.244693 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:52:32.244812 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-29 03:52:32.364384 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-29 03:52:32.378886 (Thread-1): finished collecting timing info
2021-01-29 03:52:32.379122 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-01-29 03:52:32.551998 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c31309a-bcf0-4f9c-b5f2-d81ab531d463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac6af10>]}
2021-01-29 03:52:32.553220 (Thread-1): 21:52:32 | 1 of 4 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 2.56s]
2021-01-29 03:52:32.553351 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-29 03:52:32.553478 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-29 03:52:32.554480 (Thread-1): 21:52:32 | 2 of 4 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-29 03:52:32.554840 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 03:52:32.554955 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-29 03:52:32.561146 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-29 03:52:32.561491 (Thread-1): finished collecting timing info
2021-01-29 03:52:32.565847 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-29 03:52:32.566726 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 03:52:32.566817 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-29 03:52:32.566905 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 03:52:33.171140 (Thread-1): SQL status: SUCCESS 1 in 0.60 seconds
2021-01-29 03:52:33.171390 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 03:52:33.171545 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate;
2021-01-29 03:52:33.471026 (Thread-1): Snowflake query id: 0199ece8-0b08-d11d-0000-b6cd0025c22e
2021-01-29 03:52:33.471251 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 24 unexpected ';'.
2021-01-29 03:52:33.471486 (Thread-1): finished collecting timing info
2021-01-29 03:52:33.471940 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: ROLLBACK
2021-01-29 03:52:33.881102 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-29 03:52:34.109635 (Thread-1): Database Error in model cumulative_orders_by_date (models/example/cumulative_orders_by_date.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 24 unexpected ';'.
  compiled SQL at target/run/jrtests_learn_dbt/models/example/cumulative_orders_by_date.sql
Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 11 at position 24 unexpected ';'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/local/Cellar/python@3.8/3.8.6/Frameworks/Python.framework/Versions/3.8/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model cumulative_orders_by_date (models/example/cumulative_orders_by_date.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 24 unexpected ';'.
  compiled SQL at target/run/jrtests_learn_dbt/models/example/cumulative_orders_by_date.sql
2021-01-29 03:52:34.123743 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c31309a-bcf0-4f9c-b5f2-d81ab531d463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acb7d60>]}
2021-01-29 03:52:34.125353 (Thread-1): 21:52:34 | 2 of 4 ERROR creating table model dbt.cumulative_orders_by_date...... [ERROR in 1.57s]
2021-01-29 03:52:34.125544 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-29 03:52:34.125730 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-29 03:52:34.127025 (Thread-1): 21:52:34 | 3 of 4 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-29 03:52:34.127332 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 03:52:34.127451 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-29 03:52:34.134928 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-29 03:52:34.135243 (Thread-1): finished collecting timing info
2021-01-29 03:52:34.139267 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-29 03:52:34.140184 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 03:52:34.140274 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-29 03:52:34.140358 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 03:52:35.092795 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2021-01-29 03:52:35.093049 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 03:52:35.093198 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-29 03:52:37.362497 (Thread-1): SQL status: SUCCESS 1 in 2.27 seconds
2021-01-29 03:52:37.364058 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-29 03:52:37.364324 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 03:52:37.364443 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-29 03:52:37.772330 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-01-29 03:52:37.775487 (Thread-1): finished collecting timing info
2021-01-29 03:52:37.775823 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-29 03:52:37.953751 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c31309a-bcf0-4f9c-b5f2-d81ab531d463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acb7a30>]}
2021-01-29 03:52:37.955327 (Thread-1): 21:52:37 | 3 of 4 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.83s]
2021-01-29 03:52:37.955517 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-29 03:52:37.955702 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-29 03:52:37.956949 (Thread-1): 21:52:37 | 4 of 4 START view model dbt.my_second_dbt_model...................... [RUN]
2021-01-29 03:52:37.957338 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:52:37.957472 (Thread-1): Compiling model.jrtests_learn_dbt.my_second_dbt_model
2021-01-29 03:52:37.966161 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-29 03:52:37.966506 (Thread-1): finished collecting timing info
2021-01-29 03:52:37.985685 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-29 03:52:37.986371 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:52:37.986464 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: BEGIN
2021-01-29 03:52:37.986550 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 03:52:38.989168 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-01-29 03:52:38.989423 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:52:38.989580 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_second_dbt_model"} */

  create or replace  view analytics.dbt.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
  );
2021-01-29 03:52:39.615435 (Thread-1): SQL status: SUCCESS 1 in 0.63 seconds
2021-01-29 03:52:39.617015 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-29 03:52:39.617289 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:52:39.617412 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-29 03:52:39.740765 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-29 03:52:39.745567 (Thread-1): finished collecting timing info
2021-01-29 03:52:39.745902 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: Close
2021-01-29 03:52:39.922332 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c31309a-bcf0-4f9c-b5f2-d81ab531d463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acb71f0>]}
2021-01-29 03:52:39.923880 (Thread-1): 21:52:39 | 4 of 4 OK created view model dbt.my_second_dbt_model................. [SUCCESS 1 in 1.96s]
2021-01-29 03:52:39.924070 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-29 03:52:39.925333 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 03:52:39.925537 (MainThread): Using snowflake connection "master".
2021-01-29 03:52:39.925636 (MainThread): On master: BEGIN
2021-01-29 03:52:39.925734 (MainThread): Opening a new connection, currently in state closed
2021-01-29 03:52:40.788583 (MainThread): SQL status: SUCCESS 1 in 0.86 seconds
2021-01-29 03:52:40.788856 (MainThread): On master: COMMIT
2021-01-29 03:52:40.789103 (MainThread): Using snowflake connection "master".
2021-01-29 03:52:40.789250 (MainThread): On master: COMMIT
2021-01-29 03:52:41.255754 (MainThread): SQL status: SUCCESS 1 in 0.47 seconds
2021-01-29 03:52:41.256033 (MainThread): On master: Close
2021-01-29 03:52:41.428985 (MainThread): 21:52:41 | 
2021-01-29 03:52:41.429206 (MainThread): 21:52:41 | Finished running 3 table models, 1 view model in 15.45s.
2021-01-29 03:52:41.429357 (MainThread): Connection 'master' was properly closed.
2021-01-29 03:52:41.429468 (MainThread): Connection 'model.jrtests_learn_dbt.my_second_dbt_model' was properly closed.
2021-01-29 03:52:41.442234 (MainThread): 
2021-01-29 03:52:41.442353 (MainThread): Completed with 1 error and 0 warnings:
2021-01-29 03:52:41.442455 (MainThread): 
2021-01-29 03:52:41.442561 (MainThread): Database Error in model cumulative_orders_by_date (models/example/cumulative_orders_by_date.sql)
2021-01-29 03:52:41.442652 (MainThread):   001003 (42000): SQL compilation error:
2021-01-29 03:52:41.442733 (MainThread):   syntax error line 11 at position 24 unexpected ';'.
2021-01-29 03:52:41.442812 (MainThread):   compiled SQL at target/run/jrtests_learn_dbt/models/example/cumulative_orders_by_date.sql
2021-01-29 03:52:41.442899 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2021-01-29 03:52:41.443045 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa2d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad21670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aac0dc0>]}
2021-01-29 03:52:41.443211 (MainThread): Flushing usage events
2021-01-29 03:54:25.704748 (MainThread): Running with dbt=0.18.1
2021-01-29 03:54:25.765188 (MainThread): Loading KWallet
2021-01-29 03:54:25.765640 (MainThread): Loading SecretService
2021-01-29 03:54:25.766012 (MainThread): Loading Windows
2021-01-29 03:54:25.766597 (MainThread): Loading chainer
2021-01-29 03:54:25.766977 (MainThread): Loading macOS
2021-01-29 03:54:26.014972 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 03:54:26.015994 (MainThread): Tracking: tracking
2021-01-29 03:54:26.016206 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf4f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d13bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d13b910>]}
2021-01-29 03:54:26.035905 (MainThread): Partial parsing not enabled
2021-01-29 03:54:26.036789 (MainThread): Parsing macros/catalog.sql
2021-01-29 03:54:26.038952 (MainThread): Parsing macros/adapters.sql
2021-01-29 03:54:26.066302 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 03:54:26.068160 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 03:54:26.069537 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 03:54:26.073211 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 03:54:26.083293 (MainThread): Parsing macros/core.sql
2021-01-29 03:54:26.086672 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 03:54:26.094831 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 03:54:26.096445 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 03:54:26.111853 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 03:54:26.139418 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 03:54:26.158753 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 03:54:26.160456 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 03:54:26.167567 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 03:54:26.180559 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 03:54:26.187188 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 03:54:26.193230 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 03:54:26.197878 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 03:54:26.198775 (MainThread): Parsing macros/etc/query.sql
2021-01-29 03:54:26.199759 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 03:54:26.201296 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 03:54:26.209531 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 03:54:26.211349 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 03:54:26.212929 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 03:54:26.252374 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 03:54:26.254134 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 03:54:26.255559 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 03:54:26.257148 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 03:54:26.264228 (MainThread): Partial parsing not enabled
2021-01-29 03:54:26.298740 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:54:26.318751 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 03:54:26.331375 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:54:26.342679 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 03:54:26.354130 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc87e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de145e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de14e50>]}
2021-01-29 03:54:26.354286 (MainThread): Flushing usage events
2021-01-29 03:54:26.821061 (MainThread): Connection 'model.jrtests_learn_dbt.snowflake_customer_purchases' was properly closed.
2021-01-29 03:54:26.821320 (MainThread): Encountered an error:
2021-01-29 03:54:26.821510 (MainThread): Compilation Error
  Error reading jrtests_learn_dbt: example/schema.yml - Runtime Error
    Syntax error near line 30
    ------------------------------
    27 |               - not_null
    28 | 
    29 | 
    30 |    - name: cumulative_orders_by_date
    31 |      description: "the total purchases for each customer in the snowflake sample data"
    32 |      columns:
    33 |         - name: o_orderdate
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1:
        version: 2
        ^
    expected <block end>, but found '<block sequence start>'
      in "<unicode string>", line 30, column 4:
           - name: cumulative_orders_by_date
           ^
2021-01-29 03:54:26.832289 (MainThread): Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 62, in load_yaml_text
    return safe_load(contents)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 57, in safe_load
    return yaml.load(contents, Loader=YamlLoader)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 36, in get_single_node
    document = self.compose_document()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 55, in compose_document
    node = self.compose_node(None, None)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 84, in compose_node
    node = self.compose_mapping_node(anchor)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 127, in compose_mapping_node
    while not self.check_event(MappingEndEvent):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/parser.py", line 98, in check_event
    self.current_event = self.state()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/parser.py", line 438, in parse_block_mapping_key
    raise ParserError("while parsing a block mapping", self.marks[-1],
yaml.parser.ParserError: while parsing a block mapping
  in "<unicode string>", line 1, column 1:
    version: 2
    ^
expected <block end>, but found '<block sequence start>'
  in "<unicode string>", line 30, column 4:
       - name: cumulative_orders_by_date
       ^

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/schemas.py", line 231, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 69, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 30
  ------------------------------
  27 |               - not_null
  28 | 
  29 | 
  30 |    - name: cumulative_orders_by_date
  31 |      description: "the total purchases for each customer in the snowflake sample data"
  32 |      columns:
  33 |         - name: o_orderdate
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 1, column 1:
      version: 2
      ^
  expected <block end>, but found '<block sequence start>'
    in "<unicode string>", line 30, column 4:
         - name: cumulative_orders_by_date
         ^

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 399, in run
    self._runtime_initialize()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 748, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 349, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 204, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 177, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 133, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/schemas.py", line 530, in parse_file
    dct = self._yaml_from_file(block.file)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/schemas.py", line 234, in _yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading jrtests_learn_dbt: example/schema.yml - Runtime Error
    Syntax error near line 30
    ------------------------------
    27 |               - not_null
    28 | 
    29 | 
    30 |    - name: cumulative_orders_by_date
    31 |      description: "the total purchases for each customer in the snowflake sample data"
    32 |      columns:
    33 |         - name: o_orderdate
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1:
        version: 2
        ^
    expected <block end>, but found '<block sequence start>'
      in "<unicode string>", line 30, column 4:
           - name: cumulative_orders_by_date
           ^

2021-01-29 03:56:28.139815 (MainThread): Running with dbt=0.18.1
2021-01-29 03:56:28.204792 (MainThread): Loading KWallet
2021-01-29 03:56:28.205284 (MainThread): Loading SecretService
2021-01-29 03:56:28.205679 (MainThread): Loading Windows
2021-01-29 03:56:28.206186 (MainThread): Loading chainer
2021-01-29 03:56:28.206440 (MainThread): Loading macOS
2021-01-29 03:56:28.454609 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 03:56:28.455893 (MainThread): Tracking: tracking
2021-01-29 03:56:28.456419 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a0160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b8cc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b8c910>]}
2021-01-29 03:56:28.475847 (MainThread): Partial parsing not enabled
2021-01-29 03:56:28.476728 (MainThread): Parsing macros/catalog.sql
2021-01-29 03:56:28.478800 (MainThread): Parsing macros/adapters.sql
2021-01-29 03:56:28.505806 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 03:56:28.507666 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 03:56:28.509034 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 03:56:28.512690 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 03:56:28.522814 (MainThread): Parsing macros/core.sql
2021-01-29 03:56:28.526226 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 03:56:28.534630 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 03:56:28.536256 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 03:56:28.551944 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 03:56:28.580609 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 03:56:28.599869 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 03:56:28.601866 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 03:56:28.607673 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 03:56:28.620702 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 03:56:28.626888 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 03:56:28.632577 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 03:56:28.637067 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 03:56:28.637918 (MainThread): Parsing macros/etc/query.sql
2021-01-29 03:56:28.638943 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 03:56:28.640458 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 03:56:28.649306 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 03:56:28.651120 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 03:56:28.653720 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 03:56:28.696094 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 03:56:28.697881 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 03:56:28.699340 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 03:56:28.700978 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 03:56:28.708211 (MainThread): Partial parsing not enabled
2021-01-29 03:56:28.743486 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:56:28.763917 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 03:56:28.774556 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:56:28.784986 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 03:56:28.795857 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086dae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088655e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108865e20>]}
2021-01-29 03:56:28.796013 (MainThread): Flushing usage events
2021-01-29 03:56:29.158105 (MainThread): Connection 'model.jrtests_learn_dbt.snowflake_customer_purchases' was properly closed.
2021-01-29 03:56:29.158343 (MainThread): Encountered an error:
2021-01-29 03:56:29.158535 (MainThread): Compilation Error
  Error reading jrtests_learn_dbt: example/schema.yml - Runtime Error
    Syntax error near line 29
    ------------------------------
    26 |               - unique
    27 |               - not_null
    28 | 
    29 |    - name: cumulative_orders_by_date
    30 |      description: "the total purchases for each customer in the snowflake sample data"
    31 |      columns:
    32 |         - name: o_orderdate
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1:
        version: 2
        ^
    expected <block end>, but found '<block sequence start>'
      in "<unicode string>", line 29, column 4:
           - name: cumulative_orders_by_date
           ^
2021-01-29 03:56:29.161430 (MainThread): Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 62, in load_yaml_text
    return safe_load(contents)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 57, in safe_load
    return yaml.load(contents, Loader=YamlLoader)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 36, in get_single_node
    document = self.compose_document()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 55, in compose_document
    node = self.compose_node(None, None)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 84, in compose_node
    node = self.compose_mapping_node(anchor)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 127, in compose_mapping_node
    while not self.check_event(MappingEndEvent):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/parser.py", line 98, in check_event
    self.current_event = self.state()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/parser.py", line 438, in parse_block_mapping_key
    raise ParserError("while parsing a block mapping", self.marks[-1],
yaml.parser.ParserError: while parsing a block mapping
  in "<unicode string>", line 1, column 1:
    version: 2
    ^
expected <block end>, but found '<block sequence start>'
  in "<unicode string>", line 29, column 4:
       - name: cumulative_orders_by_date
       ^

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/schemas.py", line 231, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 69, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 29
  ------------------------------
  26 |               - unique
  27 |               - not_null
  28 | 
  29 |    - name: cumulative_orders_by_date
  30 |      description: "the total purchases for each customer in the snowflake sample data"
  31 |      columns:
  32 |         - name: o_orderdate
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 1, column 1:
      version: 2
      ^
  expected <block end>, but found '<block sequence start>'
    in "<unicode string>", line 29, column 4:
         - name: cumulative_orders_by_date
         ^

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 399, in run
    self._runtime_initialize()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 748, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 349, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 204, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 177, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 133, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/schemas.py", line 530, in parse_file
    dct = self._yaml_from_file(block.file)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/schemas.py", line 234, in _yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading jrtests_learn_dbt: example/schema.yml - Runtime Error
    Syntax error near line 29
    ------------------------------
    26 |               - unique
    27 |               - not_null
    28 | 
    29 |    - name: cumulative_orders_by_date
    30 |      description: "the total purchases for each customer in the snowflake sample data"
    31 |      columns:
    32 |         - name: o_orderdate
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1:
        version: 2
        ^
    expected <block end>, but found '<block sequence start>'
      in "<unicode string>", line 29, column 4:
           - name: cumulative_orders_by_date
           ^

2021-01-29 03:57:31.056866 (MainThread): Running with dbt=0.18.1
2021-01-29 03:57:31.120912 (MainThread): Loading KWallet
2021-01-29 03:57:31.121415 (MainThread): Loading SecretService
2021-01-29 03:57:31.121809 (MainThread): Loading Windows
2021-01-29 03:57:31.122328 (MainThread): Loading chainer
2021-01-29 03:57:31.122594 (MainThread): Loading macOS
2021-01-29 03:57:31.372336 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 03:57:31.373255 (MainThread): Tracking: tracking
2021-01-29 03:57:31.373542 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126d3340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128c0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128c0880>]}
2021-01-29 03:57:31.394081 (MainThread): Partial parsing not enabled
2021-01-29 03:57:31.394963 (MainThread): Parsing macros/catalog.sql
2021-01-29 03:57:31.397109 (MainThread): Parsing macros/adapters.sql
2021-01-29 03:57:31.424988 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 03:57:31.426839 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 03:57:31.428213 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 03:57:31.431938 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 03:57:31.442208 (MainThread): Parsing macros/core.sql
2021-01-29 03:57:31.445667 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 03:57:31.453789 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 03:57:31.455412 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 03:57:31.470963 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 03:57:31.499023 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 03:57:31.519280 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 03:57:31.521007 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 03:57:31.526850 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 03:57:31.539929 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 03:57:31.546370 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 03:57:31.552130 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 03:57:31.556753 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 03:57:31.557640 (MainThread): Parsing macros/etc/query.sql
2021-01-29 03:57:31.558625 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 03:57:31.560151 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 03:57:31.568500 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 03:57:31.570335 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 03:57:31.571865 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 03:57:31.614899 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 03:57:31.616622 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 03:57:31.618028 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 03:57:31.619585 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 03:57:31.626527 (MainThread): Partial parsing not enabled
2021-01-29 03:57:31.661347 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:57:31.681084 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 03:57:31.691159 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:57:31.701279 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 03:57:31.712557 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133d4970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11359f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11359f2b0>]}
2021-01-29 03:57:31.712720 (MainThread): Flushing usage events
2021-01-29 03:57:32.048542 (MainThread): Connection 'model.jrtests_learn_dbt.snowflake_customer_purchases' was properly closed.
2021-01-29 03:57:32.048787 (MainThread): Encountered an error:
2021-01-29 03:57:32.048975 (MainThread): Compilation Error
  Error reading jrtests_learn_dbt: example/schema.yml - Runtime Error
    Syntax error near line 28
    ------------------------------
    25 |               - unique
    26 |               - not_null
    27 |     - name: cumulative_orders_by_date
    28 |      description: "the total purchases for each customer in the snowflake sample data"
    29 |      columns:
    30 |         - name: o_orderdate
    31 |           tests:
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 4, column 5:
            - name: my_first_dbt_model
            ^
    expected <block end>, but found '<block mapping start>'
      in "<unicode string>", line 28, column 6:
             description: "the total purchase ... 
             ^
2021-01-29 03:57:32.051893 (MainThread): Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 62, in load_yaml_text
    return safe_load(contents)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 57, in safe_load
    return yaml.load(contents, Loader=YamlLoader)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 36, in get_single_node
    document = self.compose_document()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 55, in compose_document
    node = self.compose_node(None, None)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 84, in compose_node
    node = self.compose_mapping_node(anchor)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 133, in compose_mapping_node
    item_value = self.compose_node(node, item_key)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 82, in compose_node
    node = self.compose_sequence_node(anchor)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/composer.py", line 110, in compose_sequence_node
    while not self.check_event(SequenceEndEvent):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/parser.py", line 98, in check_event
    self.current_event = self.state()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/yaml/parser.py", line 392, in parse_block_sequence_entry
    raise ParserError("while parsing a block collection", self.marks[-1],
yaml.parser.ParserError: while parsing a block collection
  in "<unicode string>", line 4, column 5:
        - name: my_first_dbt_model
        ^
expected <block end>, but found '<block mapping start>'
  in "<unicode string>", line 28, column 6:
         description: "the total purchase ... 
         ^

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/schemas.py", line 231, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/yaml_helper.py", line 69, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 28
  ------------------------------
  25 |               - unique
  26 |               - not_null
  27 |     - name: cumulative_orders_by_date
  28 |      description: "the total purchases for each customer in the snowflake sample data"
  29 |      columns:
  30 |         - name: o_orderdate
  31 |           tests:
  
  Raw Error:
  ------------------------------
  while parsing a block collection
    in "<unicode string>", line 4, column 5:
          - name: my_first_dbt_model
          ^
  expected <block end>, but found '<block mapping start>'
    in "<unicode string>", line 28, column 6:
           description: "the total purchase ... 
           ^

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 399, in run
    self._runtime_initialize()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 748, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 349, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 204, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 177, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 133, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/schemas.py", line 530, in parse_file
    dct = self._yaml_from_file(block.file)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/schemas.py", line 234, in _yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading jrtests_learn_dbt: example/schema.yml - Runtime Error
    Syntax error near line 28
    ------------------------------
    25 |               - unique
    26 |               - not_null
    27 |     - name: cumulative_orders_by_date
    28 |      description: "the total purchases for each customer in the snowflake sample data"
    29 |      columns:
    30 |         - name: o_orderdate
    31 |           tests:
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 4, column 5:
            - name: my_first_dbt_model
            ^
    expected <block end>, but found '<block mapping start>'
      in "<unicode string>", line 28, column 6:
             description: "the total purchase ... 
             ^

2021-01-29 03:58:19.661398 (MainThread): Running with dbt=0.18.1
2021-01-29 03:58:19.721545 (MainThread): Loading KWallet
2021-01-29 03:58:19.722045 (MainThread): Loading SecretService
2021-01-29 03:58:19.722422 (MainThread): Loading Windows
2021-01-29 03:58:19.722915 (MainThread): Loading chainer
2021-01-29 03:58:19.723171 (MainThread): Loading macOS
2021-01-29 03:58:19.969387 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 03:58:19.970485 (MainThread): Tracking: tracking
2021-01-29 03:58:19.970710 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7ac310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a998bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a998850>]}
2021-01-29 03:58:19.990018 (MainThread): Partial parsing not enabled
2021-01-29 03:58:19.990934 (MainThread): Parsing macros/catalog.sql
2021-01-29 03:58:19.993044 (MainThread): Parsing macros/adapters.sql
2021-01-29 03:58:20.020124 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 03:58:20.021965 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 03:58:20.023498 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 03:58:20.027150 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 03:58:20.037158 (MainThread): Parsing macros/core.sql
2021-01-29 03:58:20.040760 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 03:58:20.049029 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 03:58:20.050632 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 03:58:20.067259 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 03:58:20.095126 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 03:58:20.114592 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 03:58:20.116296 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 03:58:20.122074 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 03:58:20.135029 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 03:58:20.141524 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 03:58:20.147329 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 03:58:20.151915 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 03:58:20.152790 (MainThread): Parsing macros/etc/query.sql
2021-01-29 03:58:20.153763 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 03:58:20.155271 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 03:58:20.163562 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 03:58:20.165373 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 03:58:20.166912 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 03:58:20.205471 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 03:58:20.207218 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 03:58:20.208695 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 03:58:20.210872 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 03:58:20.217782 (MainThread): Partial parsing not enabled
2021-01-29 03:58:20.252417 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:58:20.271900 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 03:58:20.282293 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:58:20.293172 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 03:58:20.557896 (MainThread): Found 4 models, 8 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-29 03:58:20.558919 (MainThread): 
2021-01-29 03:58:20.559221 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 03:58:20.565403 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-29 03:58:20.579254 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-29 03:58:20.579345 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-29 03:58:20.579428 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-29 03:58:21.505115 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.93 seconds
2021-01-29 03:58:21.509980 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-29 03:58:21.731304 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-29 03:58:21.739139 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-29 03:58:21.739258 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-29 03:58:21.739358 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-29 03:58:22.664458 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 0.93 seconds
2021-01-29 03:58:22.669091 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-29 03:58:22.853032 (MainThread): Using snowflake connection "master".
2021-01-29 03:58:22.853224 (MainThread): On master: BEGIN
2021-01-29 03:58:22.853357 (MainThread): Opening a new connection, currently in state init
2021-01-29 03:58:23.430631 (MainThread): SQL status: SUCCESS 1 in 0.58 seconds
2021-01-29 03:58:23.430912 (MainThread): On master: COMMIT
2021-01-29 03:58:23.431176 (MainThread): Using snowflake connection "master".
2021-01-29 03:58:23.431326 (MainThread): On master: COMMIT
2021-01-29 03:58:23.883176 (MainThread): SQL status: SUCCESS 1 in 0.45 seconds
2021-01-29 03:58:23.883457 (MainThread): On master: Close
2021-01-29 03:58:24.050308 (MainThread): 21:58:24 | Concurrency: 1 threads (target='dev')
2021-01-29 03:58:24.050547 (MainThread): 21:58:24 | 
2021-01-29 03:58:24.052245 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-29 03:58:24.053694 (Thread-1): 21:58:24 | 1 of 4 START table model dbt.my_first_dbt_model...................... [RUN]
2021-01-29 03:58:24.053986 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:58:24.054113 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-29 03:58:24.072972 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-29 03:58:24.073319 (Thread-1): finished collecting timing info
2021-01-29 03:58:24.103900 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-29 03:58:24.104856 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:58:24.104949 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-01-29 03:58:24.105035 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 03:58:24.644436 (Thread-1): SQL status: SUCCESS 1 in 0.54 seconds
2021-01-29 03:58:24.644692 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:58:24.644845 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-01-29 03:58:25.790002 (Thread-1): SQL status: SUCCESS 1 in 1.14 seconds
2021-01-29 03:58:25.791691 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-29 03:58:25.791951 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:58:25.792072 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-29 03:58:25.919562 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-01-29 03:58:25.934166 (Thread-1): finished collecting timing info
2021-01-29 03:58:25.934401 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-01-29 03:58:26.078644 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7a45bbf-bbf9-4d4a-90fb-208df36c8171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b51aca0>]}
2021-01-29 03:58:26.080183 (Thread-1): 21:58:26 | 1 of 4 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 2.02s]
2021-01-29 03:58:26.080372 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-29 03:58:26.080560 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-29 03:58:26.081770 (Thread-1): 21:58:26 | 2 of 4 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-29 03:58:26.082188 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 03:58:26.082328 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-29 03:58:26.090129 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-29 03:58:26.090490 (Thread-1): finished collecting timing info
2021-01-29 03:58:26.094528 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-29 03:58:26.095445 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 03:58:26.095538 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-29 03:58:26.095627 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 03:58:26.885834 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-01-29 03:58:26.886111 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 03:58:26.886265 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate;
2021-01-29 03:58:27.003874 (Thread-1): Snowflake query id: 0199ecee-0bd0-2b5a-0000-b6cd0025c252
2021-01-29 03:58:27.004106 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 24 unexpected ';'.
2021-01-29 03:58:27.004345 (Thread-1): finished collecting timing info
2021-01-29 03:58:27.004799 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: ROLLBACK
2021-01-29 03:58:27.253881 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-29 03:58:27.413003 (Thread-1): Database Error in model cumulative_orders_by_date (models/example/cumulative_orders_by_date.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 24 unexpected ';'.
  compiled SQL at target/run/jrtests_learn_dbt/models/example/cumulative_orders_by_date.sql
Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 11 at position 24 unexpected ';'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/local/Cellar/python@3.8/3.8.6/Frameworks/Python.framework/Versions/3.8/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model cumulative_orders_by_date (models/example/cumulative_orders_by_date.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 24 unexpected ';'.
  compiled SQL at target/run/jrtests_learn_dbt/models/example/cumulative_orders_by_date.sql
2021-01-29 03:58:27.416129 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7a45bbf-bbf9-4d4a-90fb-208df36c8171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4b7b50>]}
2021-01-29 03:58:27.417424 (Thread-1): 21:58:27 | 2 of 4 ERROR creating table model dbt.cumulative_orders_by_date...... [ERROR in 1.33s]
2021-01-29 03:58:27.417579 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-29 03:58:27.417731 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-29 03:58:27.418768 (Thread-1): 21:58:27 | 3 of 4 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-29 03:58:27.419060 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 03:58:27.419186 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-29 03:58:27.426891 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-29 03:58:27.427357 (Thread-1): finished collecting timing info
2021-01-29 03:58:27.431348 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-29 03:58:27.432279 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 03:58:27.432370 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-29 03:58:27.432456 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 03:58:28.074964 (Thread-1): SQL status: SUCCESS 1 in 0.64 seconds
2021-01-29 03:58:28.075225 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 03:58:28.075377 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-29 03:58:30.644608 (Thread-1): SQL status: SUCCESS 1 in 2.57 seconds
2021-01-29 03:58:30.646191 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-29 03:58:30.646467 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 03:58:30.646589 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-29 03:58:30.760720 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-29 03:58:30.763852 (Thread-1): finished collecting timing info
2021-01-29 03:58:30.764182 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-29 03:58:30.959292 (Thread-1): unclosed <socket.socket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.24', 62683), raddr=('52.184.166.117', 443)>
2021-01-29 03:58:30.962535 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7a45bbf-bbf9-4d4a-90fb-208df36c8171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b609040>]}
2021-01-29 03:58:30.964064 (Thread-1): 21:58:30 | 3 of 4 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.54s]
2021-01-29 03:58:30.964253 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-29 03:58:30.964438 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-29 03:58:30.965585 (Thread-1): 21:58:30 | 4 of 4 START view model dbt.my_second_dbt_model...................... [RUN]
2021-01-29 03:58:30.965973 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:58:30.966108 (Thread-1): Compiling model.jrtests_learn_dbt.my_second_dbt_model
2021-01-29 03:58:30.974462 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-29 03:58:30.974802 (Thread-1): finished collecting timing info
2021-01-29 03:58:30.993791 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-29 03:58:30.994432 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:58:30.994521 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: BEGIN
2021-01-29 03:58:30.994607 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 03:58:31.833019 (Thread-1): SQL status: SUCCESS 1 in 0.84 seconds
2021-01-29 03:58:31.833280 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:58:31.833431 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_second_dbt_model"} */

  create or replace  view analytics.dbt.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
  );
2021-01-29 03:58:32.488315 (Thread-1): SQL status: SUCCESS 1 in 0.65 seconds
2021-01-29 03:58:32.489855 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-29 03:58:32.490131 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:58:32.490254 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-29 03:58:32.610920 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-29 03:58:32.615700 (Thread-1): finished collecting timing info
2021-01-29 03:58:32.616030 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: Close
2021-01-29 03:58:32.805707 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7a45bbf-bbf9-4d4a-90fb-208df36c8171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b77af70>]}
2021-01-29 03:58:32.807230 (Thread-1): 21:58:32 | 4 of 4 OK created view model dbt.my_second_dbt_model................. [SUCCESS 1 in 1.84s]
2021-01-29 03:58:32.807424 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-29 03:58:32.808597 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 03:58:32.808858 (MainThread): Using snowflake connection "master".
2021-01-29 03:58:32.808966 (MainThread): On master: BEGIN
2021-01-29 03:58:32.809073 (MainThread): Opening a new connection, currently in state closed
2021-01-29 03:58:33.695613 (MainThread): SQL status: SUCCESS 1 in 0.89 seconds
2021-01-29 03:58:33.695887 (MainThread): On master: COMMIT
2021-01-29 03:58:33.696135 (MainThread): Using snowflake connection "master".
2021-01-29 03:58:33.696284 (MainThread): On master: COMMIT
2021-01-29 03:58:34.123670 (MainThread): SQL status: SUCCESS 1 in 0.43 seconds
2021-01-29 03:58:34.123957 (MainThread): On master: Close
2021-01-29 03:58:34.303627 (MainThread): 21:58:34 | 
2021-01-29 03:58:34.303860 (MainThread): 21:58:34 | Finished running 3 table models, 1 view model in 13.74s.
2021-01-29 03:58:34.304018 (MainThread): Connection 'master' was properly closed.
2021-01-29 03:58:34.304130 (MainThread): Connection 'model.jrtests_learn_dbt.my_second_dbt_model' was properly closed.
2021-01-29 03:58:34.318357 (MainThread): 
2021-01-29 03:58:34.318482 (MainThread): Completed with 1 error and 0 warnings:
2021-01-29 03:58:34.318595 (MainThread): 
2021-01-29 03:58:34.318699 (MainThread): Database Error in model cumulative_orders_by_date (models/example/cumulative_orders_by_date.sql)
2021-01-29 03:58:34.318795 (MainThread):   001003 (42000): SQL compilation error:
2021-01-29 03:58:34.318883 (MainThread):   syntax error line 11 at position 24 unexpected ';'.
2021-01-29 03:58:34.318969 (MainThread):   compiled SQL at target/run/jrtests_learn_dbt/models/example/cumulative_orders_by_date.sql
2021-01-29 03:58:34.319062 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2021-01-29 03:58:34.319211 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6e5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6f79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6f7340>]}
2021-01-29 03:58:34.319383 (MainThread): Flushing usage events
2021-01-29 03:59:20.104629 (MainThread): Running with dbt=0.18.1
2021-01-29 03:59:20.164915 (MainThread): Loading KWallet
2021-01-29 03:59:20.165378 (MainThread): Loading SecretService
2021-01-29 03:59:20.165746 (MainThread): Loading Windows
2021-01-29 03:59:20.166228 (MainThread): Loading chainer
2021-01-29 03:59:20.166476 (MainThread): Loading macOS
2021-01-29 03:59:20.414745 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 03:59:20.415752 (MainThread): Tracking: tracking
2021-01-29 03:59:20.415969 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10668a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106876ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106876940>]}
2021-01-29 03:59:20.435908 (MainThread): Partial parsing not enabled
2021-01-29 03:59:20.437045 (MainThread): Parsing macros/catalog.sql
2021-01-29 03:59:20.439101 (MainThread): Parsing macros/adapters.sql
2021-01-29 03:59:20.465471 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 03:59:20.467307 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 03:59:20.468655 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 03:59:20.472287 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 03:59:20.482256 (MainThread): Parsing macros/core.sql
2021-01-29 03:59:20.485595 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 03:59:20.493671 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 03:59:20.495273 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 03:59:20.511131 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 03:59:20.540320 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 03:59:20.559599 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 03:59:20.561310 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 03:59:20.567101 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 03:59:20.579973 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 03:59:20.586627 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 03:59:20.592476 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 03:59:20.597073 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 03:59:20.597946 (MainThread): Parsing macros/etc/query.sql
2021-01-29 03:59:20.598917 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 03:59:20.600684 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 03:59:20.608995 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 03:59:20.610763 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 03:59:20.612271 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 03:59:20.650909 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 03:59:20.652730 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 03:59:20.654113 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 03:59:20.656019 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 03:59:20.662901 (MainThread): Partial parsing not enabled
2021-01-29 03:59:20.697402 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:59:20.716938 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 03:59:20.727387 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:59:20.739624 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 03:59:21.002543 (MainThread): Found 4 models, 8 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-29 03:59:21.003329 (MainThread): 
2021-01-29 03:59:21.003572 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 03:59:21.007696 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-29 03:59:21.019367 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-29 03:59:21.019449 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-29 03:59:21.019525 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-29 03:59:21.958450 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.94 seconds
2021-01-29 03:59:21.963345 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-29 03:59:22.208434 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-29 03:59:22.216442 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-29 03:59:22.216561 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-29 03:59:22.216664 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-29 03:59:22.757151 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 0.54 seconds
2021-01-29 03:59:22.761695 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-29 03:59:22.937564 (MainThread): Using snowflake connection "master".
2021-01-29 03:59:22.937753 (MainThread): On master: BEGIN
2021-01-29 03:59:22.937884 (MainThread): Opening a new connection, currently in state init
2021-01-29 03:59:23.813891 (MainThread): SQL status: SUCCESS 1 in 0.88 seconds
2021-01-29 03:59:23.814166 (MainThread): On master: COMMIT
2021-01-29 03:59:23.814417 (MainThread): Using snowflake connection "master".
2021-01-29 03:59:23.814562 (MainThread): On master: COMMIT
2021-01-29 03:59:24.302429 (MainThread): SQL status: SUCCESS 1 in 0.49 seconds
2021-01-29 03:59:24.302707 (MainThread): On master: Close
2021-01-29 03:59:24.489489 (MainThread): 21:59:24 | Concurrency: 1 threads (target='dev')
2021-01-29 03:59:24.489728 (MainThread): 21:59:24 | 
2021-01-29 03:59:24.491462 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-29 03:59:24.492904 (Thread-1): 21:59:24 | 1 of 4 START table model dbt.my_first_dbt_model...................... [RUN]
2021-01-29 03:59:24.493206 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:59:24.493337 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-29 03:59:24.512918 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-29 03:59:24.513252 (Thread-1): finished collecting timing info
2021-01-29 03:59:24.544055 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-29 03:59:24.544997 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:59:24.545091 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-01-29 03:59:24.545180 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 03:59:25.165924 (Thread-1): SQL status: SUCCESS 1 in 0.62 seconds
2021-01-29 03:59:25.166178 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:59:25.166330 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-01-29 03:59:26.350224 (Thread-1): SQL status: SUCCESS 1 in 1.18 seconds
2021-01-29 03:59:26.351913 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-29 03:59:26.352144 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 03:59:26.352264 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-29 03:59:26.465874 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-29 03:59:26.480192 (Thread-1): finished collecting timing info
2021-01-29 03:59:26.480426 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-01-29 03:59:26.628107 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05514bd0-4be6-492a-8f19-70e0162c43b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107543e20>]}
2021-01-29 03:59:26.629700 (Thread-1): 21:59:26 | 1 of 4 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 2.13s]
2021-01-29 03:59:26.629898 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-29 03:59:26.630090 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-29 03:59:26.631401 (Thread-1): 21:59:26 | 2 of 4 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-29 03:59:26.631724 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 03:59:26.631864 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-29 03:59:26.640902 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-29 03:59:26.641375 (Thread-1): finished collecting timing info
2021-01-29 03:59:26.646445 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-29 03:59:26.647567 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 03:59:26.647683 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-29 03:59:26.647794 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 03:59:27.243493 (Thread-1): SQL status: SUCCESS 1 in 0.60 seconds
2021-01-29 03:59:27.243755 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 03:59:27.243908 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate
      );
2021-01-29 03:59:30.651328 (Thread-1): SQL status: SUCCESS 1 in 3.41 seconds
2021-01-29 03:59:30.652941 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-29 03:59:30.653210 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 03:59:30.653332 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-29 03:59:30.759782 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-29 03:59:30.762954 (Thread-1): finished collecting timing info
2021-01-29 03:59:30.763288 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-29 03:59:30.962830 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05514bd0-4be6-492a-8f19-70e0162c43b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107608c40>]}
2021-01-29 03:59:30.964116 (Thread-1): 21:59:30 | 2 of 4 OK created table model dbt.cumulative_orders_by_date.......... [SUCCESS 1 in 4.33s]
2021-01-29 03:59:30.964270 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-29 03:59:30.964422 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-29 03:59:30.965474 (Thread-1): 21:59:30 | 3 of 4 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-29 03:59:30.965762 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 03:59:30.965886 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-29 03:59:30.973206 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-29 03:59:30.973597 (Thread-1): finished collecting timing info
2021-01-29 03:59:30.977564 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-29 03:59:30.978485 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 03:59:30.978591 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-29 03:59:30.978675 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 03:59:31.833671 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-01-29 03:59:31.833932 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 03:59:31.834079 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-29 03:59:33.723234 (Thread-1): SQL status: SUCCESS 1 in 1.89 seconds
2021-01-29 03:59:33.724818 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-29 03:59:33.725057 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 03:59:33.725175 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-29 03:59:33.879725 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-01-29 03:59:33.882854 (Thread-1): finished collecting timing info
2021-01-29 03:59:33.883179 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-29 03:59:34.067661 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05514bd0-4be6-492a-8f19-70e0162c43b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10750c310>]}
2021-01-29 03:59:34.069257 (Thread-1): 21:59:34 | 3 of 4 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.10s]
2021-01-29 03:59:34.069441 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-29 03:59:34.069619 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-29 03:59:34.070798 (Thread-1): 21:59:34 | 4 of 4 START view model dbt.my_second_dbt_model...................... [RUN]
2021-01-29 03:59:34.071186 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:59:34.071313 (Thread-1): Compiling model.jrtests_learn_dbt.my_second_dbt_model
2021-01-29 03:59:34.079595 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-29 03:59:34.079944 (Thread-1): finished collecting timing info
2021-01-29 03:59:34.098862 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-29 03:59:34.099483 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:59:34.099569 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: BEGIN
2021-01-29 03:59:34.099649 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 03:59:35.037337 (Thread-1): SQL status: SUCCESS 1 in 0.94 seconds
2021-01-29 03:59:35.037585 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:59:35.037732 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_second_dbt_model"} */

  create or replace  view analytics.dbt.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
  );
2021-01-29 03:59:35.566415 (Thread-1): SQL status: SUCCESS 1 in 0.53 seconds
2021-01-29 03:59:35.567961 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-29 03:59:35.568208 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 03:59:35.568328 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-29 03:59:35.690368 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-29 03:59:35.695157 (Thread-1): finished collecting timing info
2021-01-29 03:59:35.695482 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: Close
2021-01-29 03:59:35.871752 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05514bd0-4be6-492a-8f19-70e0162c43b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10759c070>]}
2021-01-29 03:59:35.873296 (Thread-1): 21:59:35 | 4 of 4 OK created view model dbt.my_second_dbt_model................. [SUCCESS 1 in 1.80s]
2021-01-29 03:59:35.873483 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-29 03:59:35.874715 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 03:59:35.874925 (MainThread): Using snowflake connection "master".
2021-01-29 03:59:35.875020 (MainThread): On master: BEGIN
2021-01-29 03:59:35.875115 (MainThread): Opening a new connection, currently in state closed
2021-01-29 03:59:36.446585 (MainThread): SQL status: SUCCESS 1 in 0.57 seconds
2021-01-29 03:59:36.446849 (MainThread): On master: COMMIT
2021-01-29 03:59:36.447088 (MainThread): Using snowflake connection "master".
2021-01-29 03:59:36.447224 (MainThread): On master: COMMIT
2021-01-29 03:59:36.792753 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-01-29 03:59:36.793025 (MainThread): On master: Close
2021-01-29 03:59:36.967661 (MainThread): 21:59:36 | 
2021-01-29 03:59:36.967895 (MainThread): 21:59:36 | Finished running 3 table models, 1 view model in 15.96s.
2021-01-29 03:59:36.968047 (MainThread): Connection 'master' was properly closed.
2021-01-29 03:59:36.968156 (MainThread): Connection 'model.jrtests_learn_dbt.my_second_dbt_model' was properly closed.
2021-01-29 03:59:36.981852 (MainThread): 
2021-01-29 03:59:36.981975 (MainThread): Completed successfully
2021-01-29 03:59:36.982089 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-01-29 03:59:36.982244 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107524ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10757d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10759ff40>]}
2021-01-29 03:59:36.982429 (MainThread): Flushing usage events
2021-01-29 14:44:27.811910 (MainThread): Running with dbt=0.18.1
2021-01-29 14:44:27.871515 (MainThread): Loading KWallet
2021-01-29 14:44:27.872007 (MainThread): Loading SecretService
2021-01-29 14:44:27.872469 (MainThread): Loading Windows
2021-01-29 14:44:27.872978 (MainThread): Loading chainer
2021-01-29 14:44:27.873233 (MainThread): Loading macOS
2021-01-29 14:44:28.120084 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 14:44:28.122194 (MainThread): Tracking: tracking
2021-01-29 14:44:28.122446 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113093070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11327fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11327f970>]}
2021-01-29 14:44:28.142784 (MainThread): Partial parsing not enabled
2021-01-29 14:44:28.144196 (MainThread): Parsing macros/catalog.sql
2021-01-29 14:44:28.146489 (MainThread): Parsing macros/adapters.sql
2021-01-29 14:44:28.174415 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 14:44:28.176502 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 14:44:28.178675 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 14:44:28.183330 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 14:44:28.195992 (MainThread): Parsing macros/core.sql
2021-01-29 14:44:28.200184 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 14:44:28.209241 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 14:44:28.211238 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 14:44:28.227951 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 14:44:28.259515 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 14:44:28.279509 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 14:44:28.281537 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 14:44:28.287586 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 14:44:28.300798 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 14:44:28.307432 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 14:44:28.313558 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 14:44:28.318677 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 14:44:28.319737 (MainThread): Parsing macros/etc/query.sql
2021-01-29 14:44:28.321047 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 14:44:28.322909 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 14:44:28.331386 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 14:44:28.333765 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 14:44:28.335932 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 14:44:28.377975 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 14:44:28.379845 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 14:44:28.381459 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 14:44:28.383598 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 14:44:28.391428 (MainThread): Partial parsing not enabled
2021-01-29 14:44:28.427212 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 14:44:28.447290 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 14:44:28.458288 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 14:44:28.469970 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-29 14:44:28.484385 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 14:44:28.691753 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140095b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114009af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11401c520>]}
2021-01-29 14:44:28.691979 (MainThread): Flushing usage events
2021-01-29 14:44:29.019859 (MainThread): Connection 'model.jrtests_learn_dbt.snowflake_customer_purchases' was properly closed.
2021-01-29 14:44:29.020107 (MainThread): Encountered an error:
2021-01-29 14:44:29.020306 (MainThread): Compilation Error in model covid_us (models/example/covid_us.sql)
  d_date is undefined
2021-01-29 14:44:29.029380 (MainThread): Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 399, in run
    self._runtime_initialize()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 748, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 350, in load_all
    loader.write_parse_results()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 211, in write_parse_results
    pickle.dump(self.results, fp)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 442, in __reduce__
    raise_compiler_error(f'{self.name} is undefined', node=node)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model covid_us (models/example/covid_us.sql)
  d_date is undefined

2021-01-29 14:45:07.465022 (MainThread): Running with dbt=0.18.1
2021-01-29 14:45:07.561566 (MainThread): Loading KWallet
2021-01-29 14:45:07.562331 (MainThread): Loading SecretService
2021-01-29 14:45:07.562996 (MainThread): Loading Windows
2021-01-29 14:45:07.563821 (MainThread): Loading chainer
2021-01-29 14:45:07.564380 (MainThread): Loading macOS
2021-01-29 14:45:07.913999 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 14:45:07.915261 (MainThread): Tracking: tracking
2021-01-29 14:45:07.915552 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ee3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097dac70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097da910>]}
2021-01-29 14:45:07.935384 (MainThread): Partial parsing not enabled
2021-01-29 14:45:07.936462 (MainThread): Parsing macros/catalog.sql
2021-01-29 14:45:07.938734 (MainThread): Parsing macros/adapters.sql
2021-01-29 14:45:07.967525 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 14:45:07.969586 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 14:45:07.971253 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 14:45:07.975162 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 14:45:07.985561 (MainThread): Parsing macros/core.sql
2021-01-29 14:45:07.989166 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 14:45:07.997477 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 14:45:07.999338 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 14:45:08.015246 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 14:45:08.043619 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 14:45:08.064147 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 14:45:08.066173 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 14:45:08.072195 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 14:45:08.085280 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 14:45:08.091945 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 14:45:08.097924 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 14:45:08.102787 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 14:45:08.103894 (MainThread): Parsing macros/etc/query.sql
2021-01-29 14:45:08.105158 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 14:45:08.106931 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 14:45:08.115307 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 14:45:08.117383 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 14:45:08.119238 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 14:45:08.159207 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 14:45:08.161145 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 14:45:08.162800 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 14:45:08.164550 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 14:45:08.172169 (MainThread): Partial parsing not enabled
2021-01-29 14:45:08.206764 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 14:45:08.226498 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 14:45:08.237064 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 14:45:08.247453 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-29 14:45:08.261213 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 14:45:08.465485 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5673a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a567760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a575d60>]}
2021-01-29 14:45:08.465710 (MainThread): Flushing usage events
2021-01-29 14:45:08.832703 (MainThread): Connection 'model.jrtests_learn_dbt.snowflake_customer_purchases' was properly closed.
2021-01-29 14:45:08.832947 (MainThread): Encountered an error:
2021-01-29 14:45:08.833144 (MainThread): Compilation Error in model covid_us (models/example/covid_us.sql)
  date is undefined
2021-01-29 14:45:08.837633 (MainThread): Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 399, in run
    self._runtime_initialize()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 748, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 350, in load_all
    loader.write_parse_results()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 211, in write_parse_results
    pickle.dump(self.results, fp)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 442, in __reduce__
    raise_compiler_error(f'{self.name} is undefined', node=node)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model covid_us (models/example/covid_us.sql)
  date is undefined

2021-01-29 14:46:04.455688 (MainThread): Running with dbt=0.18.1
2021-01-29 14:46:04.516656 (MainThread): Loading KWallet
2021-01-29 14:46:04.517122 (MainThread): Loading SecretService
2021-01-29 14:46:04.517492 (MainThread): Loading Windows
2021-01-29 14:46:04.517985 (MainThread): Loading chainer
2021-01-29 14:46:04.518240 (MainThread): Loading macOS
2021-01-29 14:46:04.765449 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 14:46:04.766342 (MainThread): Tracking: tracking
2021-01-29 14:46:04.766615 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c20cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e10c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e10bb0>]}
2021-01-29 14:46:04.785935 (MainThread): Partial parsing not enabled
2021-01-29 14:46:04.786814 (MainThread): Parsing macros/catalog.sql
2021-01-29 14:46:04.788872 (MainThread): Parsing macros/adapters.sql
2021-01-29 14:46:04.815234 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 14:46:04.817052 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 14:46:04.818389 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 14:46:04.821977 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 14:46:04.832018 (MainThread): Parsing macros/core.sql
2021-01-29 14:46:04.835350 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 14:46:04.843335 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 14:46:04.844932 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 14:46:04.860181 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 14:46:04.888326 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 14:46:04.907947 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 14:46:04.909640 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 14:46:04.915338 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 14:46:04.928041 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 14:46:04.934391 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 14:46:04.940700 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 14:46:04.945598 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 14:46:04.946754 (MainThread): Parsing macros/etc/query.sql
2021-01-29 14:46:04.947671 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 14:46:04.949309 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 14:46:04.957099 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 14:46:04.958810 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 14:46:04.960323 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 14:46:04.999958 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 14:46:05.001853 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 14:46:05.003291 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 14:46:05.004779 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 14:46:05.011809 (MainThread): Partial parsing not enabled
2021-01-29 14:46:05.046327 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 14:46:05.065730 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 14:46:05.076663 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 14:46:05.087787 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-29 14:46:05.101908 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 14:46:05.399292 (MainThread): Found 5 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-29 14:46:05.400266 (MainThread): 
2021-01-29 14:46:05.400510 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 14:46:05.407023 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-29 14:46:05.421107 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-29 14:46:05.421188 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-29 14:46:05.421260 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-29 14:46:06.514488 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.09 seconds
2021-01-29 14:46:06.520044 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-29 14:46:06.729350 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-29 14:46:06.735882 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-29 14:46:06.735984 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-29 14:46:06.736072 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-29 14:46:07.618105 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 0.88 seconds
2021-01-29 14:46:07.623856 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-29 14:46:07.832138 (MainThread): Using snowflake connection "master".
2021-01-29 14:46:07.832330 (MainThread): On master: BEGIN
2021-01-29 14:46:07.832465 (MainThread): Opening a new connection, currently in state init
2021-01-29 14:46:08.845572 (MainThread): SQL status: SUCCESS 1 in 1.01 seconds
2021-01-29 14:46:08.845849 (MainThread): On master: COMMIT
2021-01-29 14:46:08.846102 (MainThread): Using snowflake connection "master".
2021-01-29 14:46:08.846251 (MainThread): On master: COMMIT
2021-01-29 14:46:09.159101 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2021-01-29 14:46:09.159386 (MainThread): On master: Close
2021-01-29 14:46:09.403319 (MainThread): 08:46:09 | Concurrency: 1 threads (target='dev')
2021-01-29 14:46:09.403581 (MainThread): 08:46:09 | 
2021-01-29 14:46:09.406942 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-29 14:46:09.408498 (Thread-1): 08:46:09 | 1 of 5 START table model dbt.my_first_dbt_model...................... [RUN]
2021-01-29 14:46:09.408839 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 14:46:09.408971 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-29 14:46:09.429030 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-29 14:46:09.429789 (Thread-1): finished collecting timing info
2021-01-29 14:46:09.461014 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-29 14:46:09.462012 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 14:46:09.462107 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-01-29 14:46:09.462196 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 14:46:10.422820 (Thread-1): SQL status: SUCCESS 1 in 0.96 seconds
2021-01-29 14:46:10.423076 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 14:46:10.423230 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-01-29 14:46:11.916510 (Thread-1): SQL status: SUCCESS 1 in 1.49 seconds
2021-01-29 14:46:11.917912 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-29 14:46:11.918115 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 14:46:11.918236 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-29 14:46:12.024862 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-29 14:46:12.039309 (Thread-1): finished collecting timing info
2021-01-29 14:46:12.039553 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-01-29 14:46:12.229652 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de42615-99d2-4a5c-a82a-98a9abd5b307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a67f40>]}
2021-01-29 14:46:12.231191 (Thread-1): 08:46:12 | 1 of 5 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 2.82s]
2021-01-29 14:46:12.231394 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-29 14:46:12.231543 (Thread-1): Began running node model.jrtests_learn_dbt.covid_us
2021-01-29 14:46:12.232572 (Thread-1): 08:46:12 | 2 of 5 START view model dbt.covid_us................................. [RUN]
2021-01-29 14:46:12.232858 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-29 14:46:12.232979 (Thread-1): Compiling model.jrtests_learn_dbt.covid_us
2021-01-29 14:46:12.241272 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-29 14:46:12.241690 (Thread-1): finished collecting timing info
2021-01-29 14:46:12.258974 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-29 14:46:12.259552 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-29 14:46:12.259628 (Thread-1): On model.jrtests_learn_dbt.covid_us: BEGIN
2021-01-29 14:46:12.259700 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 14:46:12.907731 (Thread-1): SQL status: SUCCESS 1 in 0.65 seconds
2021-01-29 14:46:12.907982 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-29 14:46:12.908134 (Thread-1): On model.jrtests_learn_dbt.covid_us: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.covid_us"} */

  create or replace  view analytics.dbt.covid_us  as (
    


 select
   *
 from
  "COVID19_BY_STARSCHEMA"."PUBLIC"."JHU_COVID_19"
 where
    date <=current_date
  and
    country_region = 'United States'


  );
2021-01-29 14:46:13.111284 (Thread-1): Snowflake query id: 0199ef76-0b8a-50a6-0000-b6cd002606ea
2021-01-29 14:46:13.111521 (Thread-1): Snowflake error: 002003 (02000): SQL compilation error:
Database 'COVID19_BY_STARSCHEMA' does not exist or not authorized.
2021-01-29 14:46:13.111782 (Thread-1): finished collecting timing info
2021-01-29 14:46:13.112244 (Thread-1): On model.jrtests_learn_dbt.covid_us: ROLLBACK
2021-01-29 14:46:13.761654 (Thread-1): On model.jrtests_learn_dbt.covid_us: Close
2021-01-29 14:46:13.927414 (Thread-1): Database Error in model covid_us (models/example/covid_us.sql)
  002003 (02000): SQL compilation error:
  Database 'COVID19_BY_STARSCHEMA' does not exist or not authorized.
  compiled SQL at target/run/jrtests_learn_dbt/models/example/covid_us.sql
Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Database 'COVID19_BY_STARSCHEMA' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/local/Cellar/python@3.8/3.8.6/Frameworks/Python.framework/Versions/3.8/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model covid_us (models/example/covid_us.sql)
  002003 (02000): SQL compilation error:
  Database 'COVID19_BY_STARSCHEMA' does not exist or not authorized.
  compiled SQL at target/run/jrtests_learn_dbt/models/example/covid_us.sql
2021-01-29 14:46:13.943909 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de42615-99d2-4a5c-a82a-98a9abd5b307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e35160>]}
2021-01-29 14:46:13.945642 (Thread-1): 08:46:13 | 2 of 5 ERROR creating view model dbt.covid_us........................ [ERROR in 1.71s]
2021-01-29 14:46:13.945840 (Thread-1): Finished running node model.jrtests_learn_dbt.covid_us
2021-01-29 14:46:13.946033 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-29 14:46:13.947229 (Thread-1): 08:46:13 | 3 of 5 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-29 14:46:13.947557 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 14:46:13.947687 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-29 14:46:13.955757 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-29 14:46:13.956256 (Thread-1): finished collecting timing info
2021-01-29 14:46:13.960311 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-29 14:46:13.961222 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 14:46:13.961316 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-29 14:46:13.961405 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 14:46:14.623696 (Thread-1): SQL status: SUCCESS 1 in 0.66 seconds
2021-01-29 14:46:14.623956 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 14:46:14.624111 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate
      );
2021-01-29 14:46:17.168260 (Thread-1): SQL status: SUCCESS 1 in 2.54 seconds
2021-01-29 14:46:17.169828 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-29 14:46:17.170100 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 14:46:17.170222 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-29 14:46:17.304780 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-01-29 14:46:17.307887 (Thread-1): finished collecting timing info
2021-01-29 14:46:17.308222 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-29 14:46:17.503791 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de42615-99d2-4a5c-a82a-98a9abd5b307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119ebd60>]}
2021-01-29 14:46:17.505356 (Thread-1): 08:46:17 | 3 of 5 OK created table model dbt.cumulative_orders_by_date.......... [SUCCESS 1 in 3.56s]
2021-01-29 14:46:17.505545 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-29 14:46:17.505727 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-29 14:46:17.507014 (Thread-1): 08:46:17 | 4 of 5 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-29 14:46:17.507302 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 14:46:17.507424 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-29 14:46:17.515874 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-29 14:46:17.517764 (Thread-1): finished collecting timing info
2021-01-29 14:46:17.522985 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-29 14:46:17.524155 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 14:46:17.524265 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-29 14:46:17.524371 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 14:46:18.161780 (Thread-1): SQL status: SUCCESS 1 in 0.64 seconds
2021-01-29 14:46:18.162029 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 14:46:18.162180 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-29 14:46:20.515980 (Thread-1): SQL status: SUCCESS 1 in 2.35 seconds
2021-01-29 14:46:20.517569 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-29 14:46:20.517853 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 14:46:20.517980 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-29 14:46:20.611416 (Thread-1): SQL status: SUCCESS 1 in 0.09 seconds
2021-01-29 14:46:20.614511 (Thread-1): finished collecting timing info
2021-01-29 14:46:20.614840 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-29 14:46:20.796013 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de42615-99d2-4a5c-a82a-98a9abd5b307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119e0130>]}
2021-01-29 14:46:20.797343 (Thread-1): 08:46:20 | 4 of 5 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.29s]
2021-01-29 14:46:20.797509 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-29 14:46:20.797670 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-29 14:46:20.798753 (Thread-1): 08:46:20 | 5 of 5 START view model dbt.my_second_dbt_model...................... [RUN]
2021-01-29 14:46:20.799049 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 14:46:20.799177 (Thread-1): Compiling model.jrtests_learn_dbt.my_second_dbt_model
2021-01-29 14:46:20.808351 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-29 14:46:20.808748 (Thread-1): finished collecting timing info
2021-01-29 14:46:20.812846 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-29 14:46:20.813492 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 14:46:20.813584 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: BEGIN
2021-01-29 14:46:20.813670 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 14:46:21.688853 (Thread-1): SQL status: SUCCESS 1 in 0.88 seconds
2021-01-29 14:46:21.689107 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 14:46:21.689262 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_second_dbt_model"} */

  create or replace  view analytics.dbt.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
  );
2021-01-29 14:46:22.361918 (Thread-1): SQL status: SUCCESS 1 in 0.67 seconds
2021-01-29 14:46:22.363488 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-29 14:46:22.363785 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 14:46:22.363910 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-29 14:46:22.491232 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-01-29 14:46:22.496039 (Thread-1): finished collecting timing info
2021-01-29 14:46:22.496378 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: Close
2021-01-29 14:46:22.679601 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de42615-99d2-4a5c-a82a-98a9abd5b307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a402e0>]}
2021-01-29 14:46:22.681131 (Thread-1): 08:46:22 | 5 of 5 OK created view model dbt.my_second_dbt_model................. [SUCCESS 1 in 1.88s]
2021-01-29 14:46:22.681320 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-29 14:46:22.682521 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 14:46:22.682732 (MainThread): Using snowflake connection "master".
2021-01-29 14:46:22.682835 (MainThread): On master: BEGIN
2021-01-29 14:46:22.682937 (MainThread): Opening a new connection, currently in state closed
2021-01-29 14:46:23.555989 (MainThread): SQL status: SUCCESS 1 in 0.87 seconds
2021-01-29 14:46:23.556256 (MainThread): On master: COMMIT
2021-01-29 14:46:23.556508 (MainThread): Using snowflake connection "master".
2021-01-29 14:46:23.556660 (MainThread): On master: COMMIT
2021-01-29 14:46:24.001736 (MainThread): SQL status: SUCCESS 1 in 0.44 seconds
2021-01-29 14:46:24.002023 (MainThread): On master: Close
2021-01-29 14:46:24.231329 (MainThread): 08:46:24 | 
2021-01-29 14:46:24.231561 (MainThread): 08:46:24 | Finished running 3 table models, 2 view models in 18.83s.
2021-01-29 14:46:24.231715 (MainThread): Connection 'master' was properly closed.
2021-01-29 14:46:24.231825 (MainThread): Connection 'model.jrtests_learn_dbt.my_second_dbt_model' was properly closed.
2021-01-29 14:46:24.248300 (MainThread): 
2021-01-29 14:46:24.248422 (MainThread): Completed with 1 error and 0 warnings:
2021-01-29 14:46:24.248527 (MainThread): 
2021-01-29 14:46:24.248627 (MainThread): Database Error in model covid_us (models/example/covid_us.sql)
2021-01-29 14:46:24.248718 (MainThread):   002003 (02000): SQL compilation error:
2021-01-29 14:46:24.248803 (MainThread):   Database 'COVID19_BY_STARSCHEMA' does not exist or not authorized.
2021-01-29 14:46:24.248886 (MainThread):   compiled SQL at target/run/jrtests_learn_dbt/models/example/covid_us.sql
2021-01-29 14:46:24.248978 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-01-29 14:46:24.249125 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111948ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a85490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e904f0>]}
2021-01-29 14:46:24.249295 (MainThread): Flushing usage events
2021-01-29 15:01:32.977360 (MainThread): Running with dbt=0.18.1
2021-01-29 15:01:33.077503 (MainThread): Loading KWallet
2021-01-29 15:01:33.078208 (MainThread): Loading SecretService
2021-01-29 15:01:33.078968 (MainThread): Loading Windows
2021-01-29 15:01:33.079861 (MainThread): Loading chainer
2021-01-29 15:01:33.080291 (MainThread): Loading macOS
2021-01-29 15:01:33.498839 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 15:01:33.500242 (MainThread): Tracking: tracking
2021-01-29 15:01:33.500456 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11247b100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112668c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126688e0>]}
2021-01-29 15:01:33.522631 (MainThread): Partial parsing not enabled
2021-01-29 15:01:33.523746 (MainThread): Parsing macros/catalog.sql
2021-01-29 15:01:33.526535 (MainThread): Parsing macros/adapters.sql
2021-01-29 15:01:33.556086 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 15:01:33.558222 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 15:01:33.559850 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 15:01:33.563860 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 15:01:33.575028 (MainThread): Parsing macros/core.sql
2021-01-29 15:01:33.579368 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 15:01:33.589166 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 15:01:33.591024 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 15:01:33.609316 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 15:01:33.638772 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 15:01:33.659323 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 15:01:33.661282 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 15:01:33.667914 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 15:01:33.681687 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 15:01:33.688394 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 15:01:33.695118 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 15:01:33.700466 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 15:01:33.701646 (MainThread): Parsing macros/etc/query.sql
2021-01-29 15:01:33.703051 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 15:01:33.705099 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 15:01:33.714911 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 15:01:33.717139 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 15:01:33.719027 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 15:01:33.760440 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 15:01:33.762374 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 15:01:33.764034 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 15:01:33.765981 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 15:01:33.773492 (MainThread): Partial parsing not enabled
2021-01-29 15:01:33.812895 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 15:01:33.833572 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 15:01:33.844517 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 15:01:33.855133 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-29 15:01:33.869485 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 15:01:34.163100 (MainThread): Found 5 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-29 15:01:34.163931 (MainThread): 
2021-01-29 15:01:34.164158 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 15:01:34.169347 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-29 15:01:34.180593 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-29 15:01:34.180672 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-29 15:01:34.180745 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-29 15:01:35.576785 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.40 seconds
2021-01-29 15:01:35.581652 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-29 15:01:35.849035 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-29 15:01:35.855787 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-29 15:01:35.855888 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-29 15:01:35.855975 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-29 15:01:36.756577 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 0.90 seconds
2021-01-29 15:01:36.762134 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-29 15:01:37.015164 (MainThread): Using snowflake connection "master".
2021-01-29 15:01:37.015355 (MainThread): On master: BEGIN
2021-01-29 15:01:37.015488 (MainThread): Opening a new connection, currently in state init
2021-01-29 15:01:37.837434 (MainThread): SQL status: SUCCESS 1 in 0.82 seconds
2021-01-29 15:01:37.837695 (MainThread): On master: COMMIT
2021-01-29 15:01:37.837952 (MainThread): Using snowflake connection "master".
2021-01-29 15:01:37.838099 (MainThread): On master: COMMIT
2021-01-29 15:01:38.208515 (MainThread): SQL status: SUCCESS 1 in 0.37 seconds
2021-01-29 15:01:38.208799 (MainThread): On master: Close
2021-01-29 15:01:38.432745 (MainThread): 09:01:38 | Concurrency: 1 threads (target='dev')
2021-01-29 15:01:38.432978 (MainThread): 09:01:38 | 
2021-01-29 15:01:38.435591 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-29 15:01:38.437135 (Thread-1): 09:01:38 | 1 of 5 START table model dbt.my_first_dbt_model...................... [RUN]
2021-01-29 15:01:38.437498 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 15:01:38.437643 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-29 15:01:38.457871 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-29 15:01:38.458196 (Thread-1): finished collecting timing info
2021-01-29 15:01:38.488772 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-29 15:01:38.489730 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 15:01:38.489823 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-01-29 15:01:38.489910 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 15:01:39.258516 (Thread-1): SQL status: SUCCESS 1 in 0.77 seconds
2021-01-29 15:01:39.258777 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 15:01:39.258930 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-01-29 15:01:40.486900 (Thread-1): SQL status: SUCCESS 1 in 1.23 seconds
2021-01-29 15:01:40.488592 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-29 15:01:40.488843 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-29 15:01:40.488966 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-29 15:01:40.603304 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-29 15:01:40.617742 (Thread-1): finished collecting timing info
2021-01-29 15:01:40.617978 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-01-29 15:01:40.830110 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfd7987-064d-4bfa-8818-b7587d845bb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156b38b0>]}
2021-01-29 15:01:40.831693 (Thread-1): 09:01:40 | 1 of 5 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 2.39s]
2021-01-29 15:01:40.831854 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-29 15:01:40.832012 (Thread-1): Began running node model.jrtests_learn_dbt.covid_us
2021-01-29 15:01:40.833089 (Thread-1): 09:01:40 | 2 of 5 START view model dbt.covid_us................................. [RUN]
2021-01-29 15:01:40.833506 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-29 15:01:40.833647 (Thread-1): Compiling model.jrtests_learn_dbt.covid_us
2021-01-29 15:01:40.842581 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-29 15:01:40.842953 (Thread-1): finished collecting timing info
2021-01-29 15:01:40.862139 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-29 15:01:40.862809 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-29 15:01:40.862899 (Thread-1): On model.jrtests_learn_dbt.covid_us: BEGIN
2021-01-29 15:01:40.862985 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 15:01:41.711117 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-01-29 15:01:41.711384 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-29 15:01:41.711539 (Thread-1): On model.jrtests_learn_dbt.covid_us: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.covid_us"} */

  create or replace  view analytics.dbt.covid_us  as (
    


 select
   *
 from
  "COVID19_BY_STARSCHEMA"."PUBLIC"."JHU_COVID_19"
 where
    date <=current_date
  and
    country_region = 'United States'


  );
2021-01-29 15:01:42.533840 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-01-29 15:01:42.535374 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-29 15:01:42.535638 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-29 15:01:42.535787 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-29 15:01:42.723422 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-29 15:01:42.728253 (Thread-1): finished collecting timing info
2021-01-29 15:01:42.728587 (Thread-1): On model.jrtests_learn_dbt.covid_us: Close
2021-01-29 15:01:42.925954 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfd7987-064d-4bfa-8818-b7587d845bb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156bf670>]}
2021-01-29 15:01:42.927491 (Thread-1): 09:01:42 | 2 of 5 OK created view model dbt.covid_us............................ [SUCCESS 1 in 2.09s]
2021-01-29 15:01:42.927681 (Thread-1): Finished running node model.jrtests_learn_dbt.covid_us
2021-01-29 15:01:42.927866 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-29 15:01:42.929082 (Thread-1): 09:01:42 | 3 of 5 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-29 15:01:42.929470 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 15:01:42.929625 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-29 15:01:42.937083 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-29 15:01:42.937419 (Thread-1): finished collecting timing info
2021-01-29 15:01:42.941358 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-29 15:01:42.942216 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 15:01:42.942301 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-29 15:01:42.942382 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 15:01:43.601733 (Thread-1): SQL status: SUCCESS 1 in 0.66 seconds
2021-01-29 15:01:43.601981 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 15:01:43.602128 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate
      );
2021-01-29 15:01:46.074285 (Thread-1): SQL status: SUCCESS 1 in 2.47 seconds
2021-01-29 15:01:46.075853 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-29 15:01:46.076113 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-29 15:01:46.076249 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-29 15:01:46.212897 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-01-29 15:01:46.216029 (Thread-1): finished collecting timing info
2021-01-29 15:01:46.216359 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-29 15:01:46.419402 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfd7987-064d-4bfa-8818-b7587d845bb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113217970>]}
2021-01-29 15:01:46.420989 (Thread-1): 09:01:46 | 3 of 5 OK created table model dbt.cumulative_orders_by_date.......... [SUCCESS 1 in 3.49s]
2021-01-29 15:01:46.421175 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-29 15:01:46.421356 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-29 15:01:46.422584 (Thread-1): 09:01:46 | 4 of 5 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-29 15:01:46.422867 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 15:01:46.422987 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-29 15:01:46.431171 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-29 15:01:46.431502 (Thread-1): finished collecting timing info
2021-01-29 15:01:46.435451 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-29 15:01:46.436368 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 15:01:46.436456 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-29 15:01:46.436541 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 15:01:47.430689 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-01-29 15:01:47.430943 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 15:01:47.431097 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-29 15:01:49.910772 (Thread-1): SQL status: SUCCESS 1 in 2.48 seconds
2021-01-29 15:01:49.912349 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-29 15:01:49.912619 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-29 15:01:49.912742 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-29 15:01:50.035350 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-29 15:01:50.037903 (Thread-1): finished collecting timing info
2021-01-29 15:01:50.038172 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-29 15:01:50.346462 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfd7987-064d-4bfa-8818-b7587d845bb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11323d730>]}
2021-01-29 15:01:50.348045 (Thread-1): 09:01:50 | 4 of 5 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.92s]
2021-01-29 15:01:50.348237 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-29 15:01:50.348424 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-29 15:01:50.349647 (Thread-1): 09:01:50 | 5 of 5 START view model dbt.my_second_dbt_model...................... [RUN]
2021-01-29 15:01:50.349944 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 15:01:50.350158 (Thread-1): Compiling model.jrtests_learn_dbt.my_second_dbt_model
2021-01-29 15:01:50.358924 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-29 15:01:50.359322 (Thread-1): finished collecting timing info
2021-01-29 15:01:50.363356 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-29 15:01:50.364012 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 15:01:50.364105 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: BEGIN
2021-01-29 15:01:50.364193 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 15:01:50.990603 (Thread-1): SQL status: SUCCESS 1 in 0.63 seconds
2021-01-29 15:01:50.990855 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 15:01:50.991006 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_second_dbt_model"} */

  create or replace  view analytics.dbt.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
  );
2021-01-29 15:01:51.545494 (Thread-1): SQL status: SUCCESS 1 in 0.55 seconds
2021-01-29 15:01:51.546523 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-29 15:01:51.546696 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-29 15:01:51.546794 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-29 15:01:51.719037 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-29 15:01:51.723833 (Thread-1): finished collecting timing info
2021-01-29 15:01:51.724167 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: Close
2021-01-29 15:01:51.937635 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcfd7987-064d-4bfa-8818-b7587d845bb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115656670>]}
2021-01-29 15:01:51.939186 (Thread-1): 09:01:51 | 5 of 5 OK created view model dbt.my_second_dbt_model................. [SUCCESS 1 in 1.59s]
2021-01-29 15:01:51.939378 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-29 15:01:51.940582 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 15:01:51.940792 (MainThread): Using snowflake connection "master".
2021-01-29 15:01:51.940892 (MainThread): On master: BEGIN
2021-01-29 15:01:51.940993 (MainThread): Opening a new connection, currently in state closed
2021-01-29 15:01:52.941598 (MainThread): SQL status: SUCCESS 1 in 1.00 seconds
2021-01-29 15:01:52.941872 (MainThread): On master: COMMIT
2021-01-29 15:01:52.942120 (MainThread): Using snowflake connection "master".
2021-01-29 15:01:52.942266 (MainThread): On master: COMMIT
2021-01-29 15:01:53.290385 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-01-29 15:01:53.290670 (MainThread): On master: Close
2021-01-29 15:01:53.515253 (MainThread): 09:01:53 | 
2021-01-29 15:01:53.515484 (MainThread): 09:01:53 | Finished running 3 table models, 2 view models in 19.35s.
2021-01-29 15:01:53.515638 (MainThread): Connection 'master' was properly closed.
2021-01-29 15:01:53.515751 (MainThread): Connection 'model.jrtests_learn_dbt.my_second_dbt_model' was properly closed.
2021-01-29 15:01:53.532379 (MainThread): 
2021-01-29 15:01:53.532507 (MainThread): Completed successfully
2021-01-29 15:01:53.532615 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-01-29 15:01:53.532768 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131b8c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132a9cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113229ac0>]}
2021-01-29 15:01:53.532939 (MainThread): Flushing usage events
2021-01-30 04:21:31.708799 (MainThread): Running with dbt=0.18.1
2021-01-30 04:21:31.856555 (MainThread): Loading KWallet
2021-01-30 04:21:31.857307 (MainThread): Loading SecretService
2021-01-30 04:21:31.858091 (MainThread): Loading Windows
2021-01-30 04:21:31.858949 (MainThread): Loading chainer
2021-01-30 04:21:31.859343 (MainThread): Loading macOS
2021-01-30 04:21:32.344186 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-30 04:21:32.345741 (MainThread): Tracking: tracking
2021-01-30 04:21:32.346009 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf682b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c155bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c155850>]}
2021-01-30 04:21:32.366176 (MainThread): Partial parsing not enabled
2021-01-30 04:21:32.367253 (MainThread): Parsing macros/catalog.sql
2021-01-30 04:21:32.369530 (MainThread): Parsing macros/adapters.sql
2021-01-30 04:21:32.397024 (MainThread): Parsing macros/materializations/merge.sql
2021-01-30 04:21:32.399097 (MainThread): Parsing macros/materializations/view.sql
2021-01-30 04:21:32.400680 (MainThread): Parsing macros/materializations/table.sql
2021-01-30 04:21:32.404674 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-30 04:21:32.416731 (MainThread): Parsing macros/core.sql
2021-01-30 04:21:32.421110 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-30 04:21:32.430040 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-30 04:21:32.431934 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-30 04:21:32.448518 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-30 04:21:32.476546 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-30 04:21:32.496507 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-30 04:21:32.498840 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-30 04:21:32.505814 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-30 04:21:32.519367 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-30 04:21:32.526003 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-30 04:21:32.536080 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-30 04:21:32.542259 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-30 04:21:32.543501 (MainThread): Parsing macros/etc/query.sql
2021-01-30 04:21:32.545037 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-30 04:21:32.547593 (MainThread): Parsing macros/etc/datetime.sql
2021-01-30 04:21:32.557211 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-30 04:21:32.559261 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-30 04:21:32.561077 (MainThread): Parsing macros/adapters/common.sql
2021-01-30 04:21:32.600605 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-30 04:21:32.602582 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-30 04:21:32.604235 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-30 04:21:32.606057 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-30 04:21:32.613173 (MainThread): Partial parsing not enabled
2021-01-30 04:21:32.649561 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:21:32.669375 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:21:32.681060 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:21:32.692778 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:21:32.707274 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:21:32.718123 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:21:33.028872 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-30 04:21:33.030050 (MainThread): 
2021-01-30 04:21:33.030381 (MainThread): Acquiring new snowflake connection "master".
2021-01-30 04:21:33.037701 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-30 04:21:33.050536 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-30 04:21:33.050725 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-30 04:21:33.050802 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-30 04:21:34.236802 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.19 seconds
2021-01-30 04:21:34.242053 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-30 04:21:34.428664 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-30 04:21:34.435273 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-30 04:21:34.435379 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-30 04:21:34.435470 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-30 04:21:34.984284 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 0.55 seconds
2021-01-30 04:21:34.990761 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-30 04:21:35.183666 (MainThread): Using snowflake connection "master".
2021-01-30 04:21:35.183853 (MainThread): On master: BEGIN
2021-01-30 04:21:35.183982 (MainThread): Opening a new connection, currently in state init
2021-01-30 04:21:35.825846 (MainThread): SQL status: SUCCESS 1 in 0.64 seconds
2021-01-30 04:21:35.826116 (MainThread): On master: COMMIT
2021-01-30 04:21:35.826368 (MainThread): Using snowflake connection "master".
2021-01-30 04:21:35.826513 (MainThread): On master: COMMIT
2021-01-30 04:21:36.151120 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2021-01-30 04:21:36.151415 (MainThread): On master: Close
2021-01-30 04:21:36.325388 (MainThread): 22:21:36 | Concurrency: 1 threads (target='dev')
2021-01-30 04:21:36.325623 (MainThread): 22:21:36 | 
2021-01-30 04:21:36.328686 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-30 04:21:36.330195 (Thread-1): 22:21:36 | 1 of 6 START table model dbt.my_first_dbt_model...................... [RUN]
2021-01-30 04:21:36.330551 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:21:36.330725 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-30 04:21:36.350356 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-30 04:21:36.351315 (Thread-1): finished collecting timing info
2021-01-30 04:21:36.383008 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-30 04:21:36.385005 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:21:36.385105 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-01-30 04:21:36.385196 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:21:36.964851 (Thread-1): SQL status: SUCCESS 1 in 0.58 seconds
2021-01-30 04:21:36.965107 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:21:36.965263 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-01-30 04:21:38.171426 (Thread-1): SQL status: SUCCESS 1 in 1.21 seconds
2021-01-30 04:21:38.173146 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-30 04:21:38.173397 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:21:38.173517 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-30 04:21:38.288906 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-30 04:21:38.303382 (Thread-1): finished collecting timing info
2021-01-30 04:21:38.303619 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-01-30 04:21:38.587919 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c727742b-792d-4865-ab47-c0ad958805d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdba340>]}
2021-01-30 04:21:38.589510 (Thread-1): 22:21:38 | 1 of 6 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 2.26s]
2021-01-30 04:21:38.589705 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-30 04:21:38.589894 (Thread-1): Began running node model.jrtests_learn_dbt.covid_us
2021-01-30 04:21:38.591111 (Thread-1): 22:21:38 | 2 of 6 START view model dbt.covid_us................................. [RUN]
2021-01-30 04:21:38.591414 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:21:38.591559 (Thread-1): Compiling model.jrtests_learn_dbt.covid_us
2021-01-30 04:21:38.600969 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-30 04:21:38.602362 (Thread-1): finished collecting timing info
2021-01-30 04:21:38.621843 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-30 04:21:38.622536 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:21:38.622627 (Thread-1): On model.jrtests_learn_dbt.covid_us: BEGIN
2021-01-30 04:21:38.622713 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:21:39.396499 (Thread-1): SQL status: SUCCESS 1 in 0.77 seconds
2021-01-30 04:21:39.396703 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:21:39.396823 (Thread-1): On model.jrtests_learn_dbt.covid_us: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.covid_us"} */

  create or replace  view analytics.dbt.covid_us  as (
    


 select
   *
 from
  "COVID19_BY_STARSCHEMA"."PUBLIC"."JHU_COVID_19"
 where
    date <=current_date
  and
    country_region = 'United States'


  );
2021-01-30 04:21:40.046861 (Thread-1): SQL status: SUCCESS 1 in 0.65 seconds
2021-01-30 04:21:40.048420 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-30 04:21:40.048688 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:21:40.048827 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-30 04:21:40.161875 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-30 04:21:40.166365 (Thread-1): finished collecting timing info
2021-01-30 04:21:40.166635 (Thread-1): On model.jrtests_learn_dbt.covid_us: Close
2021-01-30 04:21:40.323682 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c727742b-792d-4865-ab47-c0ad958805d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf50bb0>]}
2021-01-30 04:21:40.325212 (Thread-1): 22:21:40 | 2 of 6 OK created view model dbt.covid_us............................ [SUCCESS 1 in 1.73s]
2021-01-30 04:21:40.325400 (Thread-1): Finished running node model.jrtests_learn_dbt.covid_us
2021-01-30 04:21:40.325584 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-30 04:21:40.326827 (Thread-1): 22:21:40 | 3 of 6 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-30 04:21:40.327128 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:21:40.327260 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-30 04:21:40.336443 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-30 04:21:40.336831 (Thread-1): finished collecting timing info
2021-01-30 04:21:40.341267 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-30 04:21:40.342177 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:21:40.342270 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-30 04:21:40.342359 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:21:41.253410 (Thread-1): SQL status: SUCCESS 1 in 0.91 seconds
2021-01-30 04:21:41.253664 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:21:41.253826 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate
      );
2021-01-30 04:21:43.934834 (Thread-1): SQL status: SUCCESS 1 in 2.68 seconds
2021-01-30 04:21:43.936400 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-30 04:21:43.936656 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:21:43.936814 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-30 04:21:44.066720 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-01-30 04:21:44.069831 (Thread-1): finished collecting timing info
2021-01-30 04:21:44.070164 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-30 04:21:44.265144 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c727742b-792d-4865-ab47-c0ad958805d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccd73d0>]}
2021-01-30 04:21:44.266741 (Thread-1): 22:21:44 | 3 of 6 OK created table model dbt.cumulative_orders_by_date.......... [SUCCESS 1 in 3.94s]
2021-01-30 04:21:44.266933 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-30 04:21:44.267120 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-30 04:21:44.268352 (Thread-1): 22:21:44 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-30 04:21:44.268648 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:21:44.268773 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-30 04:21:44.276647 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-30 04:21:44.277989 (Thread-1): finished collecting timing info
2021-01-30 04:21:44.282378 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-30 04:21:44.283365 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:21:44.283458 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-30 04:21:44.283548 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:21:44.820040 (Thread-1): SQL status: SUCCESS 1 in 0.54 seconds
2021-01-30 04:21:44.820299 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:21:44.820451 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-30 04:21:46.802651 (Thread-1): SQL status: SUCCESS 1 in 1.98 seconds
2021-01-30 04:21:46.804219 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-30 04:21:46.804481 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:21:46.804600 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-30 04:21:46.993092 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-30 04:21:46.996212 (Thread-1): finished collecting timing info
2021-01-30 04:21:46.996543 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-30 04:21:47.162843 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c727742b-792d-4865-ab47-c0ad958805d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc30700>]}
2021-01-30 04:21:47.164380 (Thread-1): 22:21:47 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.89s]
2021-01-30 04:21:47.164572 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-30 04:21:47.164759 (Thread-1): Began running node model.jrtests_learn_dbt.time
2021-01-30 04:21:47.165999 (Thread-1): 22:21:47 | 5 of 6 START view model dbt.time..................................... [RUN]
2021-01-30 04:21:47.166396 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:21:47.166531 (Thread-1): Compiling model.jrtests_learn_dbt.time
2021-01-30 04:21:47.174803 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.time"
2021-01-30 04:21:47.175158 (Thread-1): finished collecting timing info
2021-01-30 04:21:47.179203 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.time"
2021-01-30 04:21:47.179946 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:21:47.180038 (Thread-1): On model.jrtests_learn_dbt.time: BEGIN
2021-01-30 04:21:47.180124 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:21:47.841199 (Thread-1): SQL status: SUCCESS 1 in 0.66 seconds
2021-01-30 04:21:47.841458 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:21:47.841613 (Thread-1): On model.jrtests_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.time"} */

  create or replace  view analytics.dbt.time  as (
    


SELECT
  To_time(Concat(t_hour :: VARCHAR, ':', t_minute, ':', t_second)) TIME
FROM
  "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."time_dim"
WHERE
  TIME <= current_time
ORDER  BY TIME DESC


  );
2021-01-30 04:21:48.035463 (Thread-1): Snowflake query id: 0199f2a5-0b79-1855-0000-b6cd00261e0e
2021-01-30 04:21:48.035689 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL."time_dim"' does not exist or not authorized.
2021-01-30 04:21:48.035942 (Thread-1): finished collecting timing info
2021-01-30 04:21:48.036391 (Thread-1): On model.jrtests_learn_dbt.time: ROLLBACK
2021-01-30 04:21:48.275638 (Thread-1): On model.jrtests_learn_dbt.time: Close
2021-01-30 04:21:48.470615 (Thread-1): Database Error in model time (models/example/time.sql)
  002003 (42S02): SQL compilation error:
  Object 'SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL."time_dim"' does not exist or not authorized.
  compiled SQL at target/run/jrtests_learn_dbt/models/example/time.sql
Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL."time_dim"' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/local/Cellar/python@3.8/3.8.6/Frameworks/Python.framework/Versions/3.8/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model time (models/example/time.sql)
  002003 (42S02): SQL compilation error:
  Object 'SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL."time_dim"' does not exist or not authorized.
  compiled SQL at target/run/jrtests_learn_dbt/models/example/time.sql
2021-01-30 04:21:48.480007 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c727742b-792d-4865-ab47-c0ad958805d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc73910>]}
2021-01-30 04:21:48.481550 (Thread-1): 22:21:48 | 5 of 6 ERROR creating view model dbt.time............................ [ERROR in 1.31s]
2021-01-30 04:21:48.481740 (Thread-1): Finished running node model.jrtests_learn_dbt.time
2021-01-30 04:21:48.481928 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-30 04:21:48.483149 (Thread-1): 22:21:48 | 6 of 6 START view model dbt.my_second_dbt_model...................... [RUN]
2021-01-30 04:21:48.483555 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:21:48.483687 (Thread-1): Compiling model.jrtests_learn_dbt.my_second_dbt_model
2021-01-30 04:21:48.491908 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-30 04:21:48.492218 (Thread-1): finished collecting timing info
2021-01-30 04:21:48.496198 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-30 04:21:48.496821 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:21:48.496909 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: BEGIN
2021-01-30 04:21:48.496993 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:21:49.472133 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2021-01-30 04:21:49.472309 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:21:49.472409 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_second_dbt_model"} */

  create or replace  view analytics.dbt.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
  );
2021-01-30 04:21:50.076350 (Thread-1): SQL status: SUCCESS 1 in 0.60 seconds
2021-01-30 04:21:50.077890 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-30 04:21:50.078151 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:21:50.078297 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-30 04:21:50.201293 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-30 04:21:50.206066 (Thread-1): finished collecting timing info
2021-01-30 04:21:50.206395 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: Close
2021-01-30 04:21:50.379837 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c727742b-792d-4865-ab47-c0ad958805d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd29910>]}
2021-01-30 04:21:50.381431 (Thread-1): 22:21:50 | 6 of 6 OK created view model dbt.my_second_dbt_model................. [SUCCESS 1 in 1.90s]
2021-01-30 04:21:50.381624 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-30 04:21:50.382946 (MainThread): Acquiring new snowflake connection "master".
2021-01-30 04:21:50.383165 (MainThread): Using snowflake connection "master".
2021-01-30 04:21:50.383268 (MainThread): On master: BEGIN
2021-01-30 04:21:50.383370 (MainThread): Opening a new connection, currently in state closed
2021-01-30 04:21:51.289915 (MainThread): SQL status: SUCCESS 1 in 0.91 seconds
2021-01-30 04:21:51.290192 (MainThread): On master: COMMIT
2021-01-30 04:21:51.290437 (MainThread): Using snowflake connection "master".
2021-01-30 04:21:51.290583 (MainThread): On master: COMMIT
2021-01-30 04:21:51.714192 (MainThread): SQL status: SUCCESS 1 in 0.42 seconds
2021-01-30 04:21:51.714480 (MainThread): On master: Close
2021-01-30 04:21:51.890941 (MainThread): 22:21:51 | 
2021-01-30 04:21:51.891173 (MainThread): 22:21:51 | Finished running 3 table models, 3 view models in 18.86s.
2021-01-30 04:21:51.891327 (MainThread): Connection 'master' was properly closed.
2021-01-30 04:21:51.891439 (MainThread): Connection 'model.jrtests_learn_dbt.my_second_dbt_model' was properly closed.
2021-01-30 04:21:51.911144 (MainThread): 
2021-01-30 04:21:51.911336 (MainThread): Completed with 1 error and 0 warnings:
2021-01-30 04:21:51.911467 (MainThread): 
2021-01-30 04:21:51.911593 (MainThread): Database Error in model time (models/example/time.sql)
2021-01-30 04:21:51.911705 (MainThread):   002003 (42S02): SQL compilation error:
2021-01-30 04:21:51.911812 (MainThread):   Object 'SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL."time_dim"' does not exist or not authorized.
2021-01-30 04:21:51.911915 (MainThread):   compiled SQL at target/run/jrtests_learn_dbt/models/example/time.sql
2021-01-30 04:21:51.912024 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
2021-01-30 04:21:51.912215 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cec82e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cecbdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cecb280>]}
2021-01-30 04:21:51.912435 (MainThread): Flushing usage events
2021-01-30 04:23:39.865272 (MainThread): Running with dbt=0.18.1
2021-01-30 04:23:39.975614 (MainThread): Loading KWallet
2021-01-30 04:23:39.976529 (MainThread): Loading SecretService
2021-01-30 04:23:39.977453 (MainThread): Loading Windows
2021-01-30 04:23:39.978490 (MainThread): Loading chainer
2021-01-30 04:23:39.978978 (MainThread): Loading macOS
2021-01-30 04:23:40.386090 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-30 04:23:40.388074 (MainThread): Tracking: tracking
2021-01-30 04:23:40.388399 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103767100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103954c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039548e0>]}
2021-01-30 04:23:40.408727 (MainThread): Partial parsing not enabled
2021-01-30 04:23:40.409755 (MainThread): Parsing macros/catalog.sql
2021-01-30 04:23:40.412040 (MainThread): Parsing macros/adapters.sql
2021-01-30 04:23:40.439263 (MainThread): Parsing macros/materializations/merge.sql
2021-01-30 04:23:40.441291 (MainThread): Parsing macros/materializations/view.sql
2021-01-30 04:23:40.442914 (MainThread): Parsing macros/materializations/table.sql
2021-01-30 04:23:40.446849 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-30 04:23:40.457400 (MainThread): Parsing macros/core.sql
2021-01-30 04:23:40.461423 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-30 04:23:40.470313 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-30 04:23:40.472328 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-30 04:23:40.488999 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-30 04:23:40.517832 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-30 04:23:40.537609 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-30 04:23:40.539438 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-30 04:23:40.546635 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-30 04:23:40.562191 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-30 04:23:40.568832 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-30 04:23:40.574969 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-30 04:23:40.579733 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-30 04:23:40.580757 (MainThread): Parsing macros/etc/query.sql
2021-01-30 04:23:40.582140 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-30 04:23:40.584642 (MainThread): Parsing macros/etc/datetime.sql
2021-01-30 04:23:40.593303 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-30 04:23:40.595300 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-30 04:23:40.597089 (MainThread): Parsing macros/adapters/common.sql
2021-01-30 04:23:40.636852 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-30 04:23:40.638769 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-30 04:23:40.640435 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-30 04:23:40.642235 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-30 04:23:40.649341 (MainThread): Partial parsing not enabled
2021-01-30 04:23:40.684984 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:23:40.704784 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:23:40.715775 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:23:40.726025 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:23:40.740411 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:23:40.751033 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:23:41.052595 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-30 04:23:41.053474 (MainThread): 
2021-01-30 04:23:41.053780 (MainThread): Acquiring new snowflake connection "master".
2021-01-30 04:23:41.060154 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-30 04:23:41.071444 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-30 04:23:41.071526 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-30 04:23:41.071599 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-30 04:23:42.042603 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.97 seconds
2021-01-30 04:23:42.047986 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-30 04:23:42.267729 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-30 04:23:42.274231 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-30 04:23:42.274331 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-30 04:23:42.274419 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-30 04:23:43.084918 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 0.81 seconds
2021-01-30 04:23:43.091578 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-30 04:23:43.274865 (MainThread): Using snowflake connection "master".
2021-01-30 04:23:43.275059 (MainThread): On master: BEGIN
2021-01-30 04:23:43.275191 (MainThread): Opening a new connection, currently in state init
2021-01-30 04:23:43.847377 (MainThread): SQL status: SUCCESS 1 in 0.57 seconds
2021-01-30 04:23:43.847652 (MainThread): On master: COMMIT
2021-01-30 04:23:43.847908 (MainThread): Using snowflake connection "master".
2021-01-30 04:23:43.848052 (MainThread): On master: COMMIT
2021-01-30 04:23:44.152294 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2021-01-30 04:23:44.152567 (MainThread): On master: Close
2021-01-30 04:23:44.331030 (MainThread): 22:23:44 | Concurrency: 1 threads (target='dev')
2021-01-30 04:23:44.331265 (MainThread): 22:23:44 | 
2021-01-30 04:23:44.333954 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-30 04:23:44.335306 (Thread-1): 22:23:44 | 1 of 6 START table model dbt.my_first_dbt_model...................... [RUN]
2021-01-30 04:23:44.335614 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:23:44.335749 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-30 04:23:44.355591 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-30 04:23:44.355921 (Thread-1): finished collecting timing info
2021-01-30 04:23:44.387142 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-30 04:23:44.388205 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:23:44.388307 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-01-30 04:23:44.388395 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:23:44.959930 (Thread-1): SQL status: SUCCESS 1 in 0.57 seconds
2021-01-30 04:23:44.960183 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:23:44.960337 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-01-30 04:23:46.200700 (Thread-1): SQL status: SUCCESS 1 in 1.24 seconds
2021-01-30 04:23:46.202427 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-30 04:23:46.202673 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:23:46.202794 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-30 04:23:46.376323 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-30 04:23:46.390736 (Thread-1): finished collecting timing info
2021-01-30 04:23:46.390973 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-01-30 04:23:46.585789 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58cbaeed-430a-4036-9983-e7af15706a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044edc40>]}
2021-01-30 04:23:46.587384 (Thread-1): 22:23:46 | 1 of 6 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 2.25s]
2021-01-30 04:23:46.587577 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-30 04:23:46.587763 (Thread-1): Began running node model.jrtests_learn_dbt.covid_us
2021-01-30 04:23:46.588971 (Thread-1): 22:23:46 | 2 of 6 START view model dbt.covid_us................................. [RUN]
2021-01-30 04:23:46.589408 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:23:46.589550 (Thread-1): Compiling model.jrtests_learn_dbt.covid_us
2021-01-30 04:23:46.598538 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-30 04:23:46.598892 (Thread-1): finished collecting timing info
2021-01-30 04:23:46.617789 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-30 04:23:46.618430 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:23:46.618518 (Thread-1): On model.jrtests_learn_dbt.covid_us: BEGIN
2021-01-30 04:23:46.618602 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:23:47.225705 (Thread-1): SQL status: SUCCESS 1 in 0.61 seconds
2021-01-30 04:23:47.225960 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:23:47.226108 (Thread-1): On model.jrtests_learn_dbt.covid_us: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.covid_us"} */

  create or replace  view analytics.dbt.covid_us  as (
    


 select
   *
 from
  "COVID19_BY_STARSCHEMA"."PUBLIC"."JHU_COVID_19"
 where
    date <=current_date
  and
    country_region = 'United States'


  );
2021-01-30 04:23:47.838805 (Thread-1): SQL status: SUCCESS 1 in 0.61 seconds
2021-01-30 04:23:47.840367 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-30 04:23:47.840639 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:23:47.840779 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-30 04:23:47.946299 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-30 04:23:47.951132 (Thread-1): finished collecting timing info
2021-01-30 04:23:47.951465 (Thread-1): On model.jrtests_learn_dbt.covid_us: Close
2021-01-30 04:23:48.149362 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58cbaeed-430a-4036-9983-e7af15706a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10464ae80>]}
2021-01-30 04:23:48.150912 (Thread-1): 22:23:48 | 2 of 6 OK created view model dbt.covid_us............................ [SUCCESS 1 in 1.56s]
2021-01-30 04:23:48.151102 (Thread-1): Finished running node model.jrtests_learn_dbt.covid_us
2021-01-30 04:23:48.151288 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-30 04:23:48.152546 (Thread-1): 22:23:48 | 3 of 6 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-30 04:23:48.152959 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:23:48.153098 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-30 04:23:48.162176 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-30 04:23:48.162550 (Thread-1): finished collecting timing info
2021-01-30 04:23:48.167007 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-30 04:23:48.167936 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:23:48.168030 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-30 04:23:48.168120 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:23:49.027760 (Thread-1): SQL status: SUCCESS 1 in 0.86 seconds
2021-01-30 04:23:49.028017 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:23:49.028169 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate
      );
2021-01-30 04:23:52.344422 (Thread-1): SQL status: SUCCESS 1 in 3.32 seconds
2021-01-30 04:23:52.345973 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-30 04:23:52.346231 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:23:52.346392 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-30 04:23:52.484574 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-01-30 04:23:52.487748 (Thread-1): finished collecting timing info
2021-01-30 04:23:52.488086 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-30 04:23:52.658757 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58cbaeed-430a-4036-9983-e7af15706a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10464aaf0>]}
2021-01-30 04:23:52.660355 (Thread-1): 22:23:52 | 3 of 6 OK created table model dbt.cumulative_orders_by_date.......... [SUCCESS 1 in 4.51s]
2021-01-30 04:23:52.660510 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-30 04:23:52.660659 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-30 04:23:52.661794 (Thread-1): 22:23:52 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-30 04:23:52.662080 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:23:52.662200 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-30 04:23:52.669737 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-30 04:23:52.670059 (Thread-1): finished collecting timing info
2021-01-30 04:23:52.674076 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-30 04:23:52.674971 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:23:52.675059 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-30 04:23:52.675142 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:23:53.546175 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-01-30 04:23:53.546432 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:23:53.546586 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-30 04:23:55.825176 (Thread-1): SQL status: SUCCESS 1 in 2.28 seconds
2021-01-30 04:23:55.826780 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-30 04:23:55.827059 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:23:55.827182 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-30 04:23:55.970848 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-01-30 04:23:55.973961 (Thread-1): finished collecting timing info
2021-01-30 04:23:55.974291 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-30 04:23:56.162483 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58cbaeed-430a-4036-9983-e7af15706a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044784f0>]}
2021-01-30 04:23:56.164049 (Thread-1): 22:23:56 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.50s]
2021-01-30 04:23:56.164240 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-30 04:23:56.164425 (Thread-1): Began running node model.jrtests_learn_dbt.time
2021-01-30 04:23:56.165622 (Thread-1): 22:23:56 | 5 of 6 START view model dbt.time..................................... [RUN]
2021-01-30 04:23:56.166010 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:23:56.166145 (Thread-1): Compiling model.jrtests_learn_dbt.time
2021-01-30 04:23:56.174247 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.time"
2021-01-30 04:23:56.174610 (Thread-1): finished collecting timing info
2021-01-30 04:23:56.178632 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.time"
2021-01-30 04:23:56.179380 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:23:56.179472 (Thread-1): On model.jrtests_learn_dbt.time: BEGIN
2021-01-30 04:23:56.179560 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:23:56.842518 (Thread-1): SQL status: SUCCESS 1 in 0.66 seconds
2021-01-30 04:23:56.842774 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:23:56.842922 (Thread-1): On model.jrtests_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.time"} */

  create or replace  view analytics.dbt.time  as (
    


SELECT
  To_time(Concat(t_hour :: VARCHAR, ':', t_minute, ':', t_second)) TIME
FROM
  "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE
  TIME <= current_time
ORDER  BY TIME DESC


  );
2021-01-30 04:23:57.454021 (Thread-1): SQL status: SUCCESS 1 in 0.61 seconds
2021-01-30 04:23:57.455547 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-30 04:23:57.455808 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:23:57.455972 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-30 04:23:57.606300 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-01-30 04:23:57.611102 (Thread-1): finished collecting timing info
2021-01-30 04:23:57.611437 (Thread-1): On model.jrtests_learn_dbt.time: Close
2021-01-30 04:23:57.779738 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58cbaeed-430a-4036-9983-e7af15706a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10464afd0>]}
2021-01-30 04:23:57.781268 (Thread-1): 22:23:57 | 5 of 6 OK created view model dbt.time................................ [SUCCESS 1 in 1.61s]
2021-01-30 04:23:57.781457 (Thread-1): Finished running node model.jrtests_learn_dbt.time
2021-01-30 04:23:57.781640 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-30 04:23:57.782848 (Thread-1): 22:23:57 | 6 of 6 START view model dbt.my_second_dbt_model...................... [RUN]
2021-01-30 04:23:57.783243 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:23:57.783380 (Thread-1): Compiling model.jrtests_learn_dbt.my_second_dbt_model
2021-01-30 04:23:57.792229 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-30 04:23:57.792551 (Thread-1): finished collecting timing info
2021-01-30 04:23:57.797231 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-30 04:23:57.797868 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:23:57.797970 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: BEGIN
2021-01-30 04:23:57.798050 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:23:58.420834 (Thread-1): SQL status: SUCCESS 1 in 0.62 seconds
2021-01-30 04:23:58.421080 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:23:58.421224 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_second_dbt_model"} */

  create or replace  view analytics.dbt.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
  );
2021-01-30 04:23:58.897968 (Thread-1): SQL status: SUCCESS 1 in 0.48 seconds
2021-01-30 04:23:58.899470 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-30 04:23:58.899725 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:23:58.899870 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-30 04:23:59.015884 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-30 04:23:59.020697 (Thread-1): finished collecting timing info
2021-01-30 04:23:59.021022 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: Close
2021-01-30 04:23:59.215113 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58cbaeed-430a-4036-9983-e7af15706a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104781a60>]}
2021-01-30 04:23:59.216698 (Thread-1): 22:23:59 | 6 of 6 OK created view model dbt.my_second_dbt_model................. [SUCCESS 1 in 1.43s]
2021-01-30 04:23:59.216882 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-30 04:23:59.218086 (MainThread): Acquiring new snowflake connection "master".
2021-01-30 04:23:59.218289 (MainThread): Using snowflake connection "master".
2021-01-30 04:23:59.218385 (MainThread): On master: BEGIN
2021-01-30 04:23:59.218479 (MainThread): Opening a new connection, currently in state closed
2021-01-30 04:24:00.101432 (MainThread): SQL status: SUCCESS 1 in 0.88 seconds
2021-01-30 04:24:00.101721 (MainThread): On master: COMMIT
2021-01-30 04:24:00.101966 (MainThread): Using snowflake connection "master".
2021-01-30 04:24:00.102109 (MainThread): On master: COMMIT
2021-01-30 04:24:00.536436 (MainThread): SQL status: SUCCESS 1 in 0.43 seconds
2021-01-30 04:24:00.536709 (MainThread): On master: Close
2021-01-30 04:24:00.719723 (MainThread): 22:24:00 | 
2021-01-30 04:24:00.719951 (MainThread): 22:24:00 | Finished running 3 table models, 3 view models in 19.67s.
2021-01-30 04:24:00.720102 (MainThread): Connection 'master' was properly closed.
2021-01-30 04:24:00.720212 (MainThread): Connection 'model.jrtests_learn_dbt.my_second_dbt_model' was properly closed.
2021-01-30 04:24:00.738002 (MainThread): 
2021-01-30 04:24:00.738120 (MainThread): Completed successfully
2021-01-30 04:24:00.738226 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-01-30 04:24:00.738380 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045df4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045df700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045df730>]}
2021-01-30 04:24:00.738549 (MainThread): Flushing usage events
2021-01-30 04:25:18.056414 (MainThread): Running with dbt=0.18.1
2021-01-30 04:25:18.116104 (MainThread): Loading KWallet
2021-01-30 04:25:18.116570 (MainThread): Loading SecretService
2021-01-30 04:25:18.116946 (MainThread): Loading Windows
2021-01-30 04:25:18.117446 (MainThread): Loading chainer
2021-01-30 04:25:18.117702 (MainThread): Loading macOS
2021-01-30 04:25:18.366704 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-30 04:25:18.367691 (MainThread): Tracking: tracking
2021-01-30 04:25:18.367949 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c6e190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e5bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e5b8b0>]}
2021-01-30 04:25:18.387572 (MainThread): Partial parsing not enabled
2021-01-30 04:25:18.388438 (MainThread): Parsing macros/catalog.sql
2021-01-30 04:25:18.390517 (MainThread): Parsing macros/adapters.sql
2021-01-30 04:25:18.417773 (MainThread): Parsing macros/materializations/merge.sql
2021-01-30 04:25:18.419609 (MainThread): Parsing macros/materializations/view.sql
2021-01-30 04:25:18.420960 (MainThread): Parsing macros/materializations/table.sql
2021-01-30 04:25:18.424577 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-30 04:25:18.434556 (MainThread): Parsing macros/core.sql
2021-01-30 04:25:18.437908 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-30 04:25:18.446004 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-30 04:25:18.447626 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-30 04:25:18.462926 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-30 04:25:18.491450 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-30 04:25:18.513758 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-30 04:25:18.515637 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-30 04:25:18.521796 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-30 04:25:18.534674 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-30 04:25:18.541027 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-30 04:25:18.546682 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-30 04:25:18.551125 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-30 04:25:18.551975 (MainThread): Parsing macros/etc/query.sql
2021-01-30 04:25:18.552925 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-30 04:25:18.554439 (MainThread): Parsing macros/etc/datetime.sql
2021-01-30 04:25:18.562715 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-30 04:25:18.564475 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-30 04:25:18.565986 (MainThread): Parsing macros/adapters/common.sql
2021-01-30 04:25:18.604468 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-30 04:25:18.606224 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-30 04:25:18.607653 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-30 04:25:18.609256 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-30 04:25:18.616574 (MainThread): Partial parsing not enabled
2021-01-30 04:25:18.652023 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:25:18.671947 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:25:18.682339 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:25:18.692752 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:25:18.707314 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:25:18.717636 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:25:19.013399 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-30 04:25:19.014628 (MainThread): 
2021-01-30 04:25:19.014898 (MainThread): Acquiring new snowflake connection "master".
2021-01-30 04:25:19.021795 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-30 04:25:19.033119 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-30 04:25:19.033196 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-30 04:25:19.033265 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-30 04:25:19.897500 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.86 seconds
2021-01-30 04:25:19.902276 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-30 04:25:20.116470 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-30 04:25:20.123059 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-30 04:25:20.123165 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-30 04:25:20.123251 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-30 04:25:20.768983 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.65 seconds
2021-01-30 04:25:20.776352 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-30 04:25:20.991961 (MainThread): Using snowflake connection "master".
2021-01-30 04:25:20.992153 (MainThread): On master: BEGIN
2021-01-30 04:25:20.992284 (MainThread): Opening a new connection, currently in state init
2021-01-30 04:25:22.001718 (MainThread): SQL status: SUCCESS 1 in 1.01 seconds
2021-01-30 04:25:22.001991 (MainThread): On master: COMMIT
2021-01-30 04:25:22.002245 (MainThread): Using snowflake connection "master".
2021-01-30 04:25:22.002393 (MainThread): On master: COMMIT
2021-01-30 04:25:22.345135 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2021-01-30 04:25:22.345418 (MainThread): On master: Close
2021-01-30 04:25:22.527005 (MainThread): 22:25:22 | Concurrency: 1 threads (target='dev')
2021-01-30 04:25:22.527241 (MainThread): 22:25:22 | 
2021-01-30 04:25:22.529309 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-30 04:25:22.530763 (Thread-1): 22:25:22 | 1 of 6 START table model dbt.my_first_dbt_model...................... [RUN]
2021-01-30 04:25:22.531083 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:25:22.531215 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-30 04:25:22.550799 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-30 04:25:22.551126 (Thread-1): finished collecting timing info
2021-01-30 04:25:22.582071 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-30 04:25:22.583023 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:25:22.583119 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-01-30 04:25:22.583205 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:25:23.419324 (Thread-1): SQL status: SUCCESS 1 in 0.84 seconds
2021-01-30 04:25:23.419583 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:25:23.419737 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-01-30 04:25:25.116635 (Thread-1): SQL status: SUCCESS 1 in 1.70 seconds
2021-01-30 04:25:25.118371 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-30 04:25:25.118621 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:25:25.118743 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-30 04:25:25.303260 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-30 04:25:25.317760 (Thread-1): finished collecting timing info
2021-01-30 04:25:25.318000 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-01-30 04:25:25.572070 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a89d611b-720d-4dc7-bc91-cfa6f8eb8746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10996fe80>]}
2021-01-30 04:25:25.573646 (Thread-1): 22:25:25 | 1 of 6 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 3.04s]
2021-01-30 04:25:25.573837 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-30 04:25:25.574025 (Thread-1): Began running node model.jrtests_learn_dbt.covid_us
2021-01-30 04:25:25.575363 (Thread-1): 22:25:25 | 2 of 6 START view model dbt.covid_us................................. [RUN]
2021-01-30 04:25:25.575656 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:25:25.575776 (Thread-1): Compiling model.jrtests_learn_dbt.covid_us
2021-01-30 04:25:25.584196 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-30 04:25:25.584566 (Thread-1): finished collecting timing info
2021-01-30 04:25:25.603363 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-30 04:25:25.604031 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:25:25.604120 (Thread-1): On model.jrtests_learn_dbt.covid_us: BEGIN
2021-01-30 04:25:25.604202 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:25:26.543568 (Thread-1): SQL status: SUCCESS 1 in 0.94 seconds
2021-01-30 04:25:26.543814 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:25:26.543962 (Thread-1): On model.jrtests_learn_dbt.covid_us: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.covid_us"} */

  create or replace  view analytics.dbt.covid_us  as (
    


 select
   *
 from
  "COVID19_BY_STARSCHEMA"."PUBLIC"."JHU_COVID_19"
 where
    date <=current_date
  and
    country_region = 'United States'


  );
2021-01-30 04:25:27.166792 (Thread-1): SQL status: SUCCESS 1 in 0.62 seconds
2021-01-30 04:25:27.168351 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-30 04:25:27.168617 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:25:27.168740 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-30 04:25:27.340998 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-30 04:25:27.345817 (Thread-1): finished collecting timing info
2021-01-30 04:25:27.346147 (Thread-1): On model.jrtests_learn_dbt.covid_us: Close
2021-01-30 04:25:27.536969 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a89d611b-720d-4dc7-bc91-cfa6f8eb8746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c07a820>]}
2021-01-30 04:25:27.538528 (Thread-1): 22:25:27 | 2 of 6 OK created view model dbt.covid_us............................ [SUCCESS 1 in 1.96s]
2021-01-30 04:25:27.538718 (Thread-1): Finished running node model.jrtests_learn_dbt.covid_us
2021-01-30 04:25:27.538905 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-30 04:25:27.540118 (Thread-1): 22:25:27 | 3 of 6 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-30 04:25:27.540508 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:25:27.540639 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-30 04:25:27.548723 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-30 04:25:27.549062 (Thread-1): finished collecting timing info
2021-01-30 04:25:27.553075 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-30 04:25:27.553960 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:25:27.554049 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-30 04:25:27.554132 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:25:28.208773 (Thread-1): SQL status: SUCCESS 1 in 0.65 seconds
2021-01-30 04:25:28.209028 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:25:28.209180 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate
      );
2021-01-30 04:25:30.648397 (Thread-1): SQL status: SUCCESS 1 in 2.44 seconds
2021-01-30 04:25:30.649974 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-30 04:25:30.650261 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:25:30.650383 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-30 04:25:30.760297 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-30 04:25:30.763448 (Thread-1): finished collecting timing info
2021-01-30 04:25:30.763789 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-30 04:25:30.930699 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a89d611b-720d-4dc7-bc91-cfa6f8eb8746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b81a90>]}
2021-01-30 04:25:30.932320 (Thread-1): 22:25:30 | 3 of 6 OK created table model dbt.cumulative_orders_by_date.......... [SUCCESS 1 in 3.39s]
2021-01-30 04:25:30.932515 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-30 04:25:30.932698 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-30 04:25:30.933995 (Thread-1): 22:25:30 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-30 04:25:30.934275 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:25:30.934395 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-30 04:25:30.941978 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-30 04:25:30.942331 (Thread-1): finished collecting timing info
2021-01-30 04:25:30.946553 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-30 04:25:30.947507 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:25:30.947599 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-30 04:25:30.947684 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:25:31.519210 (Thread-1): SQL status: SUCCESS 1 in 0.57 seconds
2021-01-30 04:25:31.519464 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:25:31.519614 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-30 04:25:33.308757 (Thread-1): SQL status: SUCCESS 1 in 1.79 seconds
2021-01-30 04:25:33.310330 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-30 04:25:33.310593 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:25:33.310730 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-30 04:25:33.448106 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-01-30 04:25:33.451231 (Thread-1): finished collecting timing info
2021-01-30 04:25:33.451566 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-30 04:25:33.658161 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a89d611b-720d-4dc7-bc91-cfa6f8eb8746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099e12e0>]}
2021-01-30 04:25:33.659708 (Thread-1): 22:25:33 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.72s]
2021-01-30 04:25:33.659899 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-30 04:25:33.660091 (Thread-1): Began running node model.jrtests_learn_dbt.time
2021-01-30 04:25:33.661328 (Thread-1): 22:25:33 | 5 of 6 START view model dbt.time..................................... [RUN]
2021-01-30 04:25:33.661631 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:25:33.661836 (Thread-1): Compiling model.jrtests_learn_dbt.time
2021-01-30 04:25:33.669695 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.time"
2021-01-30 04:25:33.670021 (Thread-1): finished collecting timing info
2021-01-30 04:25:33.673998 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.time"
2021-01-30 04:25:33.674717 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:25:33.674808 (Thread-1): On model.jrtests_learn_dbt.time: BEGIN
2021-01-30 04:25:33.674892 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:25:34.922374 (Thread-1): SQL status: SUCCESS 1 in 1.25 seconds
2021-01-30 04:25:34.922631 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:25:34.922784 (Thread-1): On model.jrtests_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.time"} */

  create or replace  view analytics.dbt.time  as (
    


SELECT
  To_time(Concat(t_hour :: VARCHAR, ':', t_minute, ':', t_second)) TIME
FROM
  "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE
  TIME <= current_time
ORDER  BY TIME DESC


  );
2021-01-30 04:25:35.566443 (Thread-1): SQL status: SUCCESS 1 in 0.64 seconds
2021-01-30 04:25:35.568005 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-30 04:25:35.568297 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:25:35.568418 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-30 04:25:35.680998 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-30 04:25:35.685768 (Thread-1): finished collecting timing info
2021-01-30 04:25:35.686097 (Thread-1): On model.jrtests_learn_dbt.time: Close
2021-01-30 04:25:35.855242 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a89d611b-720d-4dc7-bc91-cfa6f8eb8746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bf9910>]}
2021-01-30 04:25:35.856770 (Thread-1): 22:25:35 | 5 of 6 OK created view model dbt.time................................ [SUCCESS 1 in 2.19s]
2021-01-30 04:25:35.856959 (Thread-1): Finished running node model.jrtests_learn_dbt.time
2021-01-30 04:25:35.857143 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-30 04:25:35.858364 (Thread-1): 22:25:35 | 6 of 6 START view model dbt.my_second_dbt_model...................... [RUN]
2021-01-30 04:25:35.858659 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:25:35.858877 (Thread-1): Compiling model.jrtests_learn_dbt.my_second_dbt_model
2021-01-30 04:25:35.867861 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-30 04:25:35.868223 (Thread-1): finished collecting timing info
2021-01-30 04:25:35.872973 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-30 04:25:35.873623 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:25:35.873717 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: BEGIN
2021-01-30 04:25:35.873805 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:25:36.741664 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-01-30 04:25:36.741911 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:25:36.742060 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_second_dbt_model"} */

  create or replace  view analytics.dbt.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
  );
2021-01-30 04:25:37.404239 (Thread-1): SQL status: SUCCESS 1 in 0.66 seconds
2021-01-30 04:25:37.405790 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-30 04:25:37.406087 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:25:37.406212 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-30 04:25:37.522383 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-30 04:25:37.527190 (Thread-1): finished collecting timing info
2021-01-30 04:25:37.527522 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: Close
2021-01-30 04:25:37.710273 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a89d611b-720d-4dc7-bc91-cfa6f8eb8746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c5de50>]}
2021-01-30 04:25:37.711856 (Thread-1): 22:25:37 | 6 of 6 OK created view model dbt.my_second_dbt_model................. [SUCCESS 1 in 1.85s]
2021-01-30 04:25:37.712043 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-30 04:25:37.713283 (MainThread): Acquiring new snowflake connection "master".
2021-01-30 04:25:37.713494 (MainThread): Using snowflake connection "master".
2021-01-30 04:25:37.713594 (MainThread): On master: BEGIN
2021-01-30 04:25:37.713692 (MainThread): Opening a new connection, currently in state closed
2021-01-30 04:25:38.301047 (MainThread): SQL status: SUCCESS 1 in 0.59 seconds
2021-01-30 04:25:38.301323 (MainThread): On master: COMMIT
2021-01-30 04:25:38.301573 (MainThread): Using snowflake connection "master".
2021-01-30 04:25:38.301723 (MainThread): On master: COMMIT
2021-01-30 04:25:38.545743 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-30 04:25:38.546028 (MainThread): On master: Close
2021-01-30 04:25:38.726219 (MainThread): 22:25:38 | 
2021-01-30 04:25:38.726446 (MainThread): 22:25:38 | Finished running 3 table models, 3 view models in 19.71s.
2021-01-30 04:25:38.726600 (MainThread): Connection 'master' was properly closed.
2021-01-30 04:25:38.726717 (MainThread): Connection 'model.jrtests_learn_dbt.my_second_dbt_model' was properly closed.
2021-01-30 04:25:38.744888 (MainThread): 
2021-01-30 04:25:38.745008 (MainThread): Completed successfully
2021-01-30 04:25:38.745118 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-01-30 04:25:38.745269 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ad4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bcb7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bcb220>]}
2021-01-30 04:25:38.745440 (MainThread): Flushing usage events
2021-01-30 04:29:56.304670 (MainThread): Running with dbt=0.18.1
2021-01-30 04:29:56.364785 (MainThread): Loading KWallet
2021-01-30 04:29:56.365253 (MainThread): Loading SecretService
2021-01-30 04:29:56.365633 (MainThread): Loading Windows
2021-01-30 04:29:56.366128 (MainThread): Loading chainer
2021-01-30 04:29:56.366380 (MainThread): Loading macOS
2021-01-30 04:29:56.615671 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-30 04:29:56.617360 (MainThread): Tracking: tracking
2021-01-30 04:29:56.617657 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10568e370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10587ac70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10587a910>]}
2021-01-30 04:29:56.637536 (MainThread): Partial parsing not enabled
2021-01-30 04:29:56.639279 (MainThread): Parsing macros/catalog.sql
2021-01-30 04:29:56.641545 (MainThread): Parsing macros/adapters.sql
2021-01-30 04:29:56.669594 (MainThread): Parsing macros/materializations/merge.sql
2021-01-30 04:29:56.671656 (MainThread): Parsing macros/materializations/view.sql
2021-01-30 04:29:56.673267 (MainThread): Parsing macros/materializations/table.sql
2021-01-30 04:29:56.677205 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-30 04:29:56.688735 (MainThread): Parsing macros/core.sql
2021-01-30 04:29:56.692990 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-30 04:29:56.702252 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-30 04:29:56.704314 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-30 04:29:56.721510 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-30 04:29:56.748971 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-30 04:29:56.768556 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-30 04:29:56.770688 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-30 04:29:56.777247 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-30 04:29:56.790507 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-30 04:29:56.797050 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-30 04:29:56.803633 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-30 04:29:56.808900 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-30 04:29:56.809984 (MainThread): Parsing macros/etc/query.sql
2021-01-30 04:29:56.811307 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-30 04:29:56.813237 (MainThread): Parsing macros/etc/datetime.sql
2021-01-30 04:29:56.822114 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-30 04:29:56.824280 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-30 04:29:56.826222 (MainThread): Parsing macros/adapters/common.sql
2021-01-30 04:29:56.869371 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-30 04:29:56.871358 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-30 04:29:56.873001 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-30 04:29:56.875245 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-30 04:29:56.882249 (MainThread): Partial parsing not enabled
2021-01-30 04:29:56.918271 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:29:56.938396 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:29:56.952518 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:29:56.963298 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:29:56.977278 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:29:56.987927 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:29:57.291027 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-30 04:29:57.292187 (MainThread): 
2021-01-30 04:29:57.292505 (MainThread): Acquiring new snowflake connection "master".
2021-01-30 04:29:57.299952 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-30 04:29:57.312506 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-30 04:29:57.312620 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-30 04:29:57.312698 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-30 04:29:57.961231 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.65 seconds
2021-01-30 04:29:57.964948 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-30 04:29:58.146202 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-30 04:29:58.152846 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-30 04:29:58.152950 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-30 04:29:58.153037 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-30 04:29:58.723920 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.57 seconds
2021-01-30 04:29:58.731220 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-30 04:29:58.899548 (MainThread): Using snowflake connection "master".
2021-01-30 04:29:58.899743 (MainThread): On master: BEGIN
2021-01-30 04:29:58.899879 (MainThread): Opening a new connection, currently in state init
2021-01-30 04:29:59.508548 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2021-01-30 04:29:59.508860 (MainThread): On master: COMMIT
2021-01-30 04:29:59.509133 (MainThread): Using snowflake connection "master".
2021-01-30 04:29:59.509708 (MainThread): On master: COMMIT
2021-01-30 04:29:59.963561 (MainThread): SQL status: SUCCESS 1 in 0.45 seconds
2021-01-30 04:29:59.963856 (MainThread): On master: Close
2021-01-30 04:30:00.162866 (MainThread): 22:30:00 | Concurrency: 1 threads (target='dev')
2021-01-30 04:30:00.163110 (MainThread): 22:30:00 | 
2021-01-30 04:30:00.167088 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-30 04:30:00.168709 (Thread-1): 22:30:00 | 1 of 6 START table model dbt.my_first_dbt_model...................... [RUN]
2021-01-30 04:30:00.169123 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:30:00.169288 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-30 04:30:00.189523 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-30 04:30:00.189867 (Thread-1): finished collecting timing info
2021-01-30 04:30:00.220856 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-30 04:30:00.223260 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:30:00.223407 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-01-30 04:30:00.223507 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:30:01.087297 (Thread-1): SQL status: SUCCESS 1 in 0.86 seconds
2021-01-30 04:30:01.087566 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:30:01.087725 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-01-30 04:30:02.415476 (Thread-1): SQL status: SUCCESS 1 in 1.33 seconds
2021-01-30 04:30:02.417260 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-30 04:30:02.417505 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:30:02.417631 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-30 04:30:02.583303 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-30 04:30:02.598496 (Thread-1): finished collecting timing info
2021-01-30 04:30:02.598747 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-01-30 04:30:02.784784 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec6e7f13-ba7c-4226-8f1b-7fcf60b01a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063bf2e0>]}
2021-01-30 04:30:02.786441 (Thread-1): 22:30:02 | 1 of 6 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 2.62s]
2021-01-30 04:30:02.786606 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-30 04:30:02.786764 (Thread-1): Began running node model.jrtests_learn_dbt.covid_us
2021-01-30 04:30:02.787880 (Thread-1): 22:30:02 | 2 of 6 START table model dbt.covid_us................................ [RUN]
2021-01-30 04:30:02.788353 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:30:02.788596 (Thread-1): Compiling model.jrtests_learn_dbt.covid_us
2021-01-30 04:30:02.797952 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-30 04:30:02.799191 (Thread-1): finished collecting timing info
2021-01-30 04:30:02.803111 (Thread-1): Dropping relation "ANALYTICS"."DBT"."COVID_US" because it is of type view
2021-01-30 04:30:02.809338 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:30:02.809470 (Thread-1): On model.jrtests_learn_dbt.covid_us: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.covid_us"} */
drop view if exists "ANALYTICS"."DBT"."COVID_US" cascade
2021-01-30 04:30:02.809578 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:30:04.055817 (Thread-1): SQL status: SUCCESS 1 in 1.25 seconds
2021-01-30 04:30:04.057787 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-30 04:30:04.058887 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:30:04.059023 (Thread-1): On model.jrtests_learn_dbt.covid_us: BEGIN
2021-01-30 04:30:04.218287 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-30 04:30:04.218538 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:30:04.218694 (Thread-1): On model.jrtests_learn_dbt.covid_us: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.covid_us"} */


      create or replace transient table analytics.dbt.covid_us  as
      (


 select
   *
 from
  "COVID19_BY_STARSCHEMA"."PUBLIC"."JHU_COVID_19"
 where
    date <=current_date
  and
    country_region = 'United States'


      );
2021-01-30 04:30:08.766864 (Thread-1): SQL status: SUCCESS 1 in 4.55 seconds
2021-01-30 04:30:08.768425 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-30 04:30:08.768688 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:30:08.768813 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-30 04:30:08.909590 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-01-30 04:30:08.912715 (Thread-1): finished collecting timing info
2021-01-30 04:30:08.913047 (Thread-1): On model.jrtests_learn_dbt.covid_us: Close
2021-01-30 04:30:09.140769 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec6e7f13-ba7c-4226-8f1b-7fcf60b01a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d7ee0>]}
2021-01-30 04:30:09.142323 (Thread-1): 22:30:09 | 2 of 6 OK created table model dbt.covid_us........................... [SUCCESS 1 in 6.35s]
2021-01-30 04:30:09.142515 (Thread-1): Finished running node model.jrtests_learn_dbt.covid_us
2021-01-30 04:30:09.142707 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-30 04:30:09.143906 (Thread-1): 22:30:09 | 3 of 6 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-30 04:30:09.144300 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:30:09.144435 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-30 04:30:09.152054 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-30 04:30:09.153880 (Thread-1): finished collecting timing info
2021-01-30 04:30:09.160643 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-30 04:30:09.161721 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:30:09.161833 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-30 04:30:09.161940 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:30:09.743856 (Thread-1): SQL status: SUCCESS 1 in 0.58 seconds
2021-01-30 04:30:09.744119 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:30:09.744282 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate
      );
2021-01-30 04:30:12.043670 (Thread-1): SQL status: SUCCESS 1 in 2.30 seconds
2021-01-30 04:30:12.045272 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-30 04:30:12.045550 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:30:12.045673 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-30 04:30:12.190564 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-01-30 04:30:12.193712 (Thread-1): finished collecting timing info
2021-01-30 04:30:12.194046 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-30 04:30:12.407144 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec6e7f13-ba7c-4226-8f1b-7fcf60b01a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d0550>]}
2021-01-30 04:30:12.408703 (Thread-1): 22:30:12 | 3 of 6 OK created table model dbt.cumulative_orders_by_date.......... [SUCCESS 1 in 3.26s]
2021-01-30 04:30:12.408896 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-30 04:30:12.409087 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-30 04:30:12.410322 (Thread-1): 22:30:12 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-30 04:30:12.410637 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:30:12.410862 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-30 04:30:12.418936 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-30 04:30:12.420253 (Thread-1): finished collecting timing info
2021-01-30 04:30:12.424647 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-30 04:30:12.425614 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:30:12.425707 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-30 04:30:12.425795 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:30:13.433214 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2021-01-30 04:30:13.433465 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:30:13.433619 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-30 04:30:15.525213 (Thread-1): SQL status: SUCCESS 1 in 2.09 seconds
2021-01-30 04:30:15.526798 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-30 04:30:15.527052 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:30:15.527183 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-30 04:30:15.631229 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2021-01-30 04:30:15.634362 (Thread-1): finished collecting timing info
2021-01-30 04:30:15.634699 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-30 04:30:15.847224 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec6e7f13-ba7c-4226-8f1b-7fcf60b01a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106364250>]}
2021-01-30 04:30:15.848817 (Thread-1): 22:30:15 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.44s]
2021-01-30 04:30:15.849012 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-30 04:30:15.849202 (Thread-1): Began running node model.jrtests_learn_dbt.time
2021-01-30 04:30:15.850394 (Thread-1): 22:30:15 | 5 of 6 START table model dbt.time.................................... [RUN]
2021-01-30 04:30:15.850798 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:30:15.850935 (Thread-1): Compiling model.jrtests_learn_dbt.time
2021-01-30 04:30:15.858644 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.time"
2021-01-30 04:30:15.860079 (Thread-1): finished collecting timing info
2021-01-30 04:30:15.865018 (Thread-1): Dropping relation "ANALYTICS"."DBT"."TIME" because it is of type view
2021-01-30 04:30:15.867040 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:30:15.867138 (Thread-1): On model.jrtests_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.time"} */
drop view if exists "ANALYTICS"."DBT"."TIME" cascade
2021-01-30 04:30:15.867231 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:30:16.520025 (Thread-1): SQL status: SUCCESS 1 in 0.65 seconds
2021-01-30 04:30:16.521984 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.time"
2021-01-30 04:30:16.523170 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:30:16.523310 (Thread-1): On model.jrtests_learn_dbt.time: BEGIN
2021-01-30 04:30:16.666290 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-01-30 04:30:16.666541 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:30:16.666697 (Thread-1): On model.jrtests_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.time"} */


      create or replace transient table analytics.dbt.time  as
      (


SELECT
  To_time(Concat(t_hour :: VARCHAR, ':', t_minute, ':', t_second)) TIME
FROM
  "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE
  TIME <= current_time
ORDER  BY TIME DESC


      );
2021-01-30 04:30:17.984922 (Thread-1): SQL status: SUCCESS 1 in 1.32 seconds
2021-01-30 04:30:17.986447 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-30 04:30:17.986711 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:30:17.986870 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-30 04:30:18.090510 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2021-01-30 04:30:18.093639 (Thread-1): finished collecting timing info
2021-01-30 04:30:18.093975 (Thread-1): On model.jrtests_learn_dbt.time: Close
2021-01-30 04:30:18.302615 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec6e7f13-ba7c-4226-8f1b-7fcf60b01a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659a760>]}
2021-01-30 04:30:18.304133 (Thread-1): 22:30:18 | 5 of 6 OK created table model dbt.time............................... [SUCCESS 1 in 2.45s]
2021-01-30 04:30:18.304323 (Thread-1): Finished running node model.jrtests_learn_dbt.time
2021-01-30 04:30:18.304509 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-30 04:30:18.305828 (Thread-1): 22:30:18 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-01-30 04:30:18.306124 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:30:18.306247 (Thread-1): Compiling model.jrtests_learn_dbt.my_second_dbt_model
2021-01-30 04:30:18.315455 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-30 04:30:18.315795 (Thread-1): finished collecting timing info
2021-01-30 04:30:18.319440 (Thread-1): Dropping relation "ANALYTICS"."DBT"."MY_SECOND_DBT_MODEL" because it is of type view
2021-01-30 04:30:18.321267 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:30:18.321362 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_second_dbt_model"} */
drop view if exists "ANALYTICS"."DBT"."MY_SECOND_DBT_MODEL" cascade
2021-01-30 04:30:18.321451 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:30:19.228928 (Thread-1): SQL status: SUCCESS 1 in 0.91 seconds
2021-01-30 04:30:19.230892 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-30 04:30:19.231956 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:30:19.232094 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: BEGIN
2021-01-30 04:30:19.377434 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-01-30 04:30:19.377686 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:30:19.377838 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
      );
2021-01-30 04:30:20.579501 (Thread-1): SQL status: SUCCESS 1 in 1.20 seconds
2021-01-30 04:30:20.581051 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-30 04:30:20.581317 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:30:20.581467 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-30 04:30:20.700688 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-30 04:30:20.703822 (Thread-1): finished collecting timing info
2021-01-30 04:30:20.704157 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: Close
2021-01-30 04:30:20.915546 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec6e7f13-ba7c-4226-8f1b-7fcf60b01a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106605850>]}
2021-01-30 04:30:20.917095 (Thread-1): 22:30:20 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.61s]
2021-01-30 04:30:20.917292 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-30 04:30:20.918398 (MainThread): Acquiring new snowflake connection "master".
2021-01-30 04:30:20.918605 (MainThread): Using snowflake connection "master".
2021-01-30 04:30:20.918705 (MainThread): On master: BEGIN
2021-01-30 04:30:20.918803 (MainThread): Opening a new connection, currently in state closed
2021-01-30 04:30:21.668592 (MainThread): SQL status: SUCCESS 1 in 0.75 seconds
2021-01-30 04:30:21.668812 (MainThread): On master: COMMIT
2021-01-30 04:30:21.669016 (MainThread): Using snowflake connection "master".
2021-01-30 04:30:21.669139 (MainThread): On master: COMMIT
2021-01-30 04:30:21.983159 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2021-01-30 04:30:21.983441 (MainThread): On master: Close
2021-01-30 04:30:22.226563 (MainThread): 22:30:22 | 
2021-01-30 04:30:22.226802 (MainThread): 22:30:22 | Finished running 6 table models in 24.93s.
2021-01-30 04:30:22.226960 (MainThread): Connection 'master' was properly closed.
2021-01-30 04:30:22.227074 (MainThread): Connection 'model.jrtests_learn_dbt.my_second_dbt_model' was properly closed.
2021-01-30 04:30:22.245956 (MainThread): 
2021-01-30 04:30:22.246081 (MainThread): Completed successfully
2021-01-30 04:30:22.246191 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-01-30 04:30:22.246348 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063bd6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063bd3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063bd940>]}
2021-01-30 04:30:22.246520 (MainThread): Flushing usage events
2021-01-30 04:31:18.505606 (MainThread): Running with dbt=0.18.1
2021-01-30 04:31:18.570553 (MainThread): Loading KWallet
2021-01-30 04:31:18.571009 (MainThread): Loading SecretService
2021-01-30 04:31:18.571388 (MainThread): Loading Windows
2021-01-30 04:31:18.571889 (MainThread): Loading chainer
2021-01-30 04:31:18.572145 (MainThread): Loading macOS
2021-01-30 04:31:18.822661 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-30 04:31:18.823703 (MainThread): Tracking: tracking
2021-01-30 04:31:18.823986 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117ceb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119b1d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119b1d90>]}
2021-01-30 04:31:18.843624 (MainThread): Partial parsing not enabled
2021-01-30 04:31:18.844718 (MainThread): Parsing macros/catalog.sql
2021-01-30 04:31:18.846867 (MainThread): Parsing macros/adapters.sql
2021-01-30 04:31:18.874046 (MainThread): Parsing macros/materializations/merge.sql
2021-01-30 04:31:18.875926 (MainThread): Parsing macros/materializations/view.sql
2021-01-30 04:31:18.877310 (MainThread): Parsing macros/materializations/table.sql
2021-01-30 04:31:18.881045 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-30 04:31:18.891259 (MainThread): Parsing macros/core.sql
2021-01-30 04:31:18.894701 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-30 04:31:18.902844 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-30 04:31:18.904448 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-30 04:31:18.920310 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-30 04:31:18.947871 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-30 04:31:18.967783 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-30 04:31:18.969480 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-30 04:31:18.975282 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-30 04:31:18.988132 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-30 04:31:18.994693 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-30 04:31:19.000473 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-30 04:31:19.005019 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-30 04:31:19.005896 (MainThread): Parsing macros/etc/query.sql
2021-01-30 04:31:19.006868 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-30 04:31:19.008369 (MainThread): Parsing macros/etc/datetime.sql
2021-01-30 04:31:19.016553 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-30 04:31:19.018357 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-30 04:31:19.019891 (MainThread): Parsing macros/adapters/common.sql
2021-01-30 04:31:19.062787 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-30 04:31:19.065036 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-30 04:31:19.066449 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-30 04:31:19.068212 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-30 04:31:19.075453 (MainThread): Partial parsing not enabled
2021-01-30 04:31:19.109371 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:31:19.129055 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:31:19.139258 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:31:19.149399 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:31:19.163145 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:31:19.173649 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:31:19.464566 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-30 04:31:19.465402 (MainThread): 
2021-01-30 04:31:19.465625 (MainThread): Acquiring new snowflake connection "master".
2021-01-30 04:31:19.471676 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-30 04:31:19.482492 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-30 04:31:19.482572 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-30 04:31:19.482644 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-30 04:31:20.661775 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.18 seconds
2021-01-30 04:31:20.666493 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-30 04:31:21.066271 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-30 04:31:21.073057 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-30 04:31:21.073160 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-30 04:31:21.073248 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-30 04:31:21.761453 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.69 seconds
2021-01-30 04:31:21.768747 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-30 04:31:22.097235 (MainThread): Using snowflake connection "master".
2021-01-30 04:31:22.097426 (MainThread): On master: BEGIN
2021-01-30 04:31:22.097562 (MainThread): Opening a new connection, currently in state init
2021-01-30 04:31:23.282631 (MainThread): SQL status: SUCCESS 1 in 1.19 seconds
2021-01-30 04:31:23.282904 (MainThread): On master: COMMIT
2021-01-30 04:31:23.283167 (MainThread): Using snowflake connection "master".
2021-01-30 04:31:23.283320 (MainThread): On master: COMMIT
2021-01-30 04:31:23.602184 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2021-01-30 04:31:23.602474 (MainThread): On master: Close
2021-01-30 04:31:23.788425 (MainThread): 22:31:23 | Concurrency: 1 threads (target='dev')
2021-01-30 04:31:23.788654 (MainThread): 22:31:23 | 
2021-01-30 04:31:23.790543 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-30 04:31:23.792029 (Thread-1): 22:31:23 | 1 of 6 START table model dbt.my_first_dbt_model...................... [RUN]
2021-01-30 04:31:23.792314 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:31:23.792443 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-30 04:31:23.811524 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-30 04:31:23.811855 (Thread-1): finished collecting timing info
2021-01-30 04:31:23.842654 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-30 04:31:23.843632 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:31:23.843723 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-01-30 04:31:23.843809 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:31:24.689653 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-01-30 04:31:24.689896 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:31:24.690040 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-01-30 04:31:25.669077 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2021-01-30 04:31:25.670866 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-30 04:31:25.671074 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:31:25.671195 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-30 04:31:25.793279 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-30 04:31:25.808453 (Thread-1): finished collecting timing info
2021-01-30 04:31:25.808710 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-01-30 04:31:26.009065 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99bb0ad5-6942-4f45-9830-cbe7b29fa2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125557c0>]}
2021-01-30 04:31:26.010654 (Thread-1): 22:31:26 | 1 of 6 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 2.22s]
2021-01-30 04:31:26.010844 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-30 04:31:26.011027 (Thread-1): Began running node model.jrtests_learn_dbt.covid_us
2021-01-30 04:31:26.012187 (Thread-1): 22:31:26 | 2 of 6 START table model dbt.covid_us................................ [RUN]
2021-01-30 04:31:26.012671 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:31:26.012808 (Thread-1): Compiling model.jrtests_learn_dbt.covid_us
2021-01-30 04:31:26.021249 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-30 04:31:26.021602 (Thread-1): finished collecting timing info
2021-01-30 04:31:26.025621 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-30 04:31:26.026290 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:31:26.026376 (Thread-1): On model.jrtests_learn_dbt.covid_us: BEGIN
2021-01-30 04:31:26.026459 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:31:27.208445 (Thread-1): SQL status: SUCCESS 1 in 1.18 seconds
2021-01-30 04:31:27.208694 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:31:27.208840 (Thread-1): On model.jrtests_learn_dbt.covid_us: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.covid_us"} */


      create or replace transient table analytics.dbt.covid_us  as
      (


 select
   *
 from
  "COVID19_BY_STARSCHEMA"."PUBLIC"."JHU_COVID_19"
 where
    date <=current_date
  and
    country_region = 'United States'


      );
2021-01-30 04:31:31.854319 (Thread-1): SQL status: SUCCESS 1 in 4.65 seconds
2021-01-30 04:31:31.855913 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-30 04:31:31.856179 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:31:31.856304 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-30 04:31:31.976681 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-30 04:31:31.979805 (Thread-1): finished collecting timing info
2021-01-30 04:31:31.980136 (Thread-1): On model.jrtests_learn_dbt.covid_us: Close
2021-01-30 04:31:32.145734 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99bb0ad5-6942-4f45-9830-cbe7b29fa2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125302e0>]}
2021-01-30 04:31:32.147261 (Thread-1): 22:31:32 | 2 of 6 OK created table model dbt.covid_us........................... [SUCCESS 1 in 6.13s]
2021-01-30 04:31:32.147450 (Thread-1): Finished running node model.jrtests_learn_dbt.covid_us
2021-01-30 04:31:32.147632 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-30 04:31:32.148964 (Thread-1): 22:31:32 | 3 of 6 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-30 04:31:32.149254 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:31:32.149377 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-30 04:31:32.157485 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-30 04:31:32.157864 (Thread-1): finished collecting timing info
2021-01-30 04:31:32.161816 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-30 04:31:32.162687 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:31:32.162778 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-30 04:31:32.162865 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:31:33.070886 (Thread-1): SQL status: SUCCESS 1 in 0.91 seconds
2021-01-30 04:31:33.071143 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:31:33.071294 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate
      );
2021-01-30 04:31:35.191180 (Thread-1): SQL status: SUCCESS 1 in 2.12 seconds
2021-01-30 04:31:35.192624 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-30 04:31:35.192839 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:31:35.192965 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-30 04:31:35.302274 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-30 04:31:35.305377 (Thread-1): finished collecting timing info
2021-01-30 04:31:35.305709 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-30 04:31:35.469488 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99bb0ad5-6942-4f45-9830-cbe7b29fa2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112543d00>]}
2021-01-30 04:31:35.471108 (Thread-1): 22:31:35 | 3 of 6 OK created table model dbt.cumulative_orders_by_date.......... [SUCCESS 1 in 3.32s]
2021-01-30 04:31:35.471302 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-30 04:31:35.471491 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-30 04:31:35.472805 (Thread-1): 22:31:35 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-30 04:31:35.473100 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:31:35.473223 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-30 04:31:35.480876 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-30 04:31:35.481208 (Thread-1): finished collecting timing info
2021-01-30 04:31:35.485285 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-30 04:31:35.486228 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:31:35.486320 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-30 04:31:35.486407 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:31:36.237787 (Thread-1): SQL status: SUCCESS 1 in 0.75 seconds
2021-01-30 04:31:36.238043 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:31:36.238192 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-30 04:31:37.966194 (Thread-1): SQL status: SUCCESS 1 in 1.73 seconds
2021-01-30 04:31:37.967814 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-30 04:31:37.968101 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:31:37.968227 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-30 04:31:38.132884 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-30 04:31:38.136006 (Thread-1): finished collecting timing info
2021-01-30 04:31:38.136349 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-30 04:31:38.304347 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99bb0ad5-6942-4f45-9830-cbe7b29fa2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11274b6d0>]}
2021-01-30 04:31:38.305905 (Thread-1): 22:31:38 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.83s]
2021-01-30 04:31:38.306099 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-30 04:31:38.306286 (Thread-1): Began running node model.jrtests_learn_dbt.time
2021-01-30 04:31:38.307568 (Thread-1): 22:31:38 | 5 of 6 START table model dbt.time.................................... [RUN]
2021-01-30 04:31:38.307855 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:31:38.307975 (Thread-1): Compiling model.jrtests_learn_dbt.time
2021-01-30 04:31:38.316006 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.time"
2021-01-30 04:31:38.316344 (Thread-1): finished collecting timing info
2021-01-30 04:31:38.320262 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.time"
2021-01-30 04:31:38.321035 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:31:38.321127 (Thread-1): On model.jrtests_learn_dbt.time: BEGIN
2021-01-30 04:31:38.321215 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:31:38.860723 (Thread-1): SQL status: SUCCESS 1 in 0.54 seconds
2021-01-30 04:31:38.860978 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:31:38.861135 (Thread-1): On model.jrtests_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.time"} */


      create or replace transient table analytics.dbt.time  as
      (


SELECT
  To_time(Concat(t_hour :: VARCHAR, ':', t_minute, ':', t_second)) TIME
FROM
  "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE
  TIME <= current_time
ORDER  BY TIME DESC


      );
2021-01-30 04:31:40.318934 (Thread-1): SQL status: SUCCESS 1 in 1.46 seconds
2021-01-30 04:31:40.320545 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-30 04:31:40.320783 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:31:40.320909 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-30 04:31:40.498885 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-30 04:31:40.501979 (Thread-1): finished collecting timing info
2021-01-30 04:31:40.502312 (Thread-1): On model.jrtests_learn_dbt.time: Close
2021-01-30 04:31:40.688729 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99bb0ad5-6942-4f45-9830-cbe7b29fa2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11273d4f0>]}
2021-01-30 04:31:40.689826 (Thread-1): 22:31:40 | 5 of 6 OK created table model dbt.time............................... [SUCCESS 1 in 2.38s]
2021-01-30 04:31:40.689961 (Thread-1): Finished running node model.jrtests_learn_dbt.time
2021-01-30 04:31:40.690094 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-30 04:31:40.691064 (Thread-1): 22:31:40 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-01-30 04:31:40.691311 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:31:40.691415 (Thread-1): Compiling model.jrtests_learn_dbt.my_second_dbt_model
2021-01-30 04:31:40.699034 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-30 04:31:40.699364 (Thread-1): finished collecting timing info
2021-01-30 04:31:40.703282 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-30 04:31:40.704859 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:31:40.704997 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: BEGIN
2021-01-30 04:31:40.705093 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:31:41.615821 (Thread-1): SQL status: SUCCESS 1 in 0.91 seconds
2021-01-30 04:31:41.616096 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:31:41.616253 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
      );
2021-01-30 04:31:42.974895 (Thread-1): SQL status: SUCCESS 1 in 1.36 seconds
2021-01-30 04:31:42.976459 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-30 04:31:42.976740 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:31:42.976866 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-30 04:31:43.074980 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2021-01-30 04:31:43.078100 (Thread-1): finished collecting timing info
2021-01-30 04:31:43.078439 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: Close
2021-01-30 04:31:43.281400 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99bb0ad5-6942-4f45-9830-cbe7b29fa2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112719be0>]}
2021-01-30 04:31:43.282969 (Thread-1): 22:31:43 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.59s]
2021-01-30 04:31:43.283158 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-30 04:31:43.284314 (MainThread): Acquiring new snowflake connection "master".
2021-01-30 04:31:43.284546 (MainThread): Using snowflake connection "master".
2021-01-30 04:31:43.284648 (MainThread): On master: BEGIN
2021-01-30 04:31:43.284748 (MainThread): Opening a new connection, currently in state closed
2021-01-30 04:31:44.123304 (MainThread): SQL status: SUCCESS 1 in 0.84 seconds
2021-01-30 04:31:44.123588 (MainThread): On master: COMMIT
2021-01-30 04:31:44.123844 (MainThread): Using snowflake connection "master".
2021-01-30 04:31:44.123998 (MainThread): On master: COMMIT
2021-01-30 04:31:44.375984 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-30 04:31:44.376264 (MainThread): On master: Close
2021-01-30 04:31:44.554747 (MainThread): 22:31:44 | 
2021-01-30 04:31:44.554972 (MainThread): 22:31:44 | Finished running 6 table models in 25.09s.
2021-01-30 04:31:44.555129 (MainThread): Connection 'master' was properly closed.
2021-01-30 04:31:44.555244 (MainThread): Connection 'model.jrtests_learn_dbt.my_second_dbt_model' was properly closed.
2021-01-30 04:31:44.573728 (MainThread): 
2021-01-30 04:31:44.573853 (MainThread): Completed successfully
2021-01-30 04:31:44.573960 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-01-30 04:31:44.574110 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124ede20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124c5d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126b0d00>]}
2021-01-30 04:31:44.574283 (MainThread): Flushing usage events
2021-01-30 04:33:33.321842 (MainThread): Running with dbt=0.18.1
2021-01-30 04:33:33.381873 (MainThread): Loading KWallet
2021-01-30 04:33:33.382346 (MainThread): Loading SecretService
2021-01-30 04:33:33.382722 (MainThread): Loading Windows
2021-01-30 04:33:33.383210 (MainThread): Loading chainer
2021-01-30 04:33:33.383460 (MainThread): Loading macOS
2021-01-30 04:33:33.630453 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-30 04:33:33.631510 (MainThread): Tracking: tracking
2021-01-30 04:33:33.631744 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b0c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf8ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf8940>]}
2021-01-30 04:33:33.651251 (MainThread): Partial parsing not enabled
2021-01-30 04:33:33.652115 (MainThread): Parsing macros/catalog.sql
2021-01-30 04:33:33.654197 (MainThread): Parsing macros/adapters.sql
2021-01-30 04:33:33.683219 (MainThread): Parsing macros/materializations/merge.sql
2021-01-30 04:33:33.685135 (MainThread): Parsing macros/materializations/view.sql
2021-01-30 04:33:33.686508 (MainThread): Parsing macros/materializations/table.sql
2021-01-30 04:33:33.690352 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-30 04:33:33.700581 (MainThread): Parsing macros/core.sql
2021-01-30 04:33:33.704023 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-30 04:33:33.712126 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-30 04:33:33.713723 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-30 04:33:33.729350 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-30 04:33:33.757779 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-30 04:33:33.777086 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-30 04:33:33.778789 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-30 04:33:33.784555 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-30 04:33:33.797433 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-30 04:33:33.803837 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-30 04:33:33.809978 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-30 04:33:33.814508 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-30 04:33:33.815365 (MainThread): Parsing macros/etc/query.sql
2021-01-30 04:33:33.816325 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-30 04:33:33.817811 (MainThread): Parsing macros/etc/datetime.sql
2021-01-30 04:33:33.826394 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-30 04:33:33.828228 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-30 04:33:33.829801 (MainThread): Parsing macros/adapters/common.sql
2021-01-30 04:33:33.869409 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-30 04:33:33.871141 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-30 04:33:33.872531 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-30 04:33:33.874154 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-30 04:33:33.881106 (MainThread): Partial parsing not enabled
2021-01-30 04:33:33.916105 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:33:33.935941 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:33:33.946233 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:33:33.956742 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:33:33.971006 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:33:33.984774 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:33:34.281886 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-30 04:33:34.282756 (MainThread): 
2021-01-30 04:33:34.282995 (MainThread): Acquiring new snowflake connection "master".
2021-01-30 04:33:34.289224 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-30 04:33:34.300513 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-30 04:33:34.300597 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-30 04:33:34.300672 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-30 04:33:35.354027 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.05 seconds
2021-01-30 04:33:35.358888 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-30 04:33:35.549513 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-30 04:33:35.556081 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-30 04:33:35.556179 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-30 04:33:35.556266 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-30 04:33:36.156934 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.60 seconds
2021-01-30 04:33:36.164305 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-30 04:33:36.393895 (MainThread): Using snowflake connection "master".
2021-01-30 04:33:36.394088 (MainThread): On master: BEGIN
2021-01-30 04:33:36.394224 (MainThread): Opening a new connection, currently in state init
2021-01-30 04:33:37.203959 (MainThread): SQL status: SUCCESS 1 in 0.81 seconds
2021-01-30 04:33:37.204232 (MainThread): On master: COMMIT
2021-01-30 04:33:37.204491 (MainThread): Using snowflake connection "master".
2021-01-30 04:33:37.204643 (MainThread): On master: COMMIT
2021-01-30 04:33:37.662418 (MainThread): SQL status: SUCCESS 1 in 0.46 seconds
2021-01-30 04:33:37.662619 (MainThread): On master: Close
2021-01-30 04:33:37.856580 (MainThread): 22:33:37 | Concurrency: 1 threads (target='dev')
2021-01-30 04:33:37.856815 (MainThread): 22:33:37 | 
2021-01-30 04:33:37.858594 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-30 04:33:37.859949 (Thread-1): 22:33:37 | 1 of 6 START table model dbt.my_first_dbt_model...................... [RUN]
2021-01-30 04:33:37.860249 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:33:37.860379 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-30 04:33:37.880435 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-30 04:33:37.880779 (Thread-1): finished collecting timing info
2021-01-30 04:33:37.911762 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-30 04:33:37.912773 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:33:37.912870 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-01-30 04:33:37.912960 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:33:38.530092 (Thread-1): SQL status: SUCCESS 1 in 0.62 seconds
2021-01-30 04:33:38.530395 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:33:38.530481 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-01-30 04:33:39.711279 (Thread-1): SQL status: SUCCESS 1 in 1.18 seconds
2021-01-30 04:33:39.713053 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-30 04:33:39.713269 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:33:39.713395 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-30 04:33:39.842176 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-01-30 04:33:39.856901 (Thread-1): finished collecting timing info
2021-01-30 04:33:39.857138 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-01-30 04:33:40.022734 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28999096-6ab9-4667-8aef-6e17ec957dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10795d220>]}
2021-01-30 04:33:40.024186 (Thread-1): 22:33:40 | 1 of 6 OK created table model dbt.my_first_dbt_model................. [SUCCESS 1 in 2.16s]
2021-01-30 04:33:40.024338 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-30 04:33:40.024486 (Thread-1): Began running node model.jrtests_learn_dbt.covid_us
2021-01-30 04:33:40.025659 (Thread-1): 22:33:40 | 2 of 6 START table model dbt.covid_us................................ [RUN]
2021-01-30 04:33:40.026089 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:33:40.026226 (Thread-1): Compiling model.jrtests_learn_dbt.covid_us
2021-01-30 04:33:40.034709 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-30 04:33:40.035073 (Thread-1): finished collecting timing info
2021-01-30 04:33:40.039132 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-30 04:33:40.039822 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:33:40.039914 (Thread-1): On model.jrtests_learn_dbt.covid_us: BEGIN
2021-01-30 04:33:40.040001 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:33:40.649926 (Thread-1): SQL status: SUCCESS 1 in 0.61 seconds
2021-01-30 04:33:40.650183 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:33:40.650332 (Thread-1): On model.jrtests_learn_dbt.covid_us: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.covid_us"} */


      create or replace transient table analytics.dbt.covid_us  as
      (


 select
   *
 from
  "COVID19_BY_STARSCHEMA"."PUBLIC"."JHU_COVID_19"
 where
    date <=current_date
  and
    country_region = 'United States'


      );
2021-01-30 04:33:44.828955 (Thread-1): SQL status: SUCCESS 1 in 4.18 seconds
2021-01-30 04:33:44.830519 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-30 04:33:44.830777 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:33:44.830923 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-30 04:33:44.948153 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-30 04:33:44.951289 (Thread-1): finished collecting timing info
2021-01-30 04:33:44.951623 (Thread-1): On model.jrtests_learn_dbt.covid_us: Close
2021-01-30 04:33:45.128892 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28999096-6ab9-4667-8aef-6e17ec957dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de1d60>]}
2021-01-30 04:33:45.130429 (Thread-1): 22:33:45 | 2 of 6 OK created table model dbt.covid_us........................... [SUCCESS 1 in 5.10s]
2021-01-30 04:33:45.130618 (Thread-1): Finished running node model.jrtests_learn_dbt.covid_us
2021-01-30 04:33:45.130802 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-30 04:33:45.132037 (Thread-1): 22:33:45 | 3 of 6 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-30 04:33:45.132429 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:33:45.132561 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-30 04:33:45.140604 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-30 04:33:45.140940 (Thread-1): finished collecting timing info
2021-01-30 04:33:45.144891 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-30 04:33:45.145749 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:33:45.145839 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-30 04:33:45.145924 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:33:46.029614 (Thread-1): SQL status: SUCCESS 1 in 0.88 seconds
2021-01-30 04:33:46.029872 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:33:46.030024 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate
      );
2021-01-30 04:33:48.312480 (Thread-1): SQL status: SUCCESS 1 in 2.28 seconds
2021-01-30 04:33:48.314050 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-30 04:33:48.314319 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:33:48.314461 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-30 04:33:48.428104 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-30 04:33:48.431215 (Thread-1): finished collecting timing info
2021-01-30 04:33:48.431547 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-30 04:33:48.619263 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28999096-6ab9-4667-8aef-6e17ec957dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107983130>]}
2021-01-30 04:33:48.620835 (Thread-1): 22:33:48 | 3 of 6 OK created table model dbt.cumulative_orders_by_date.......... [SUCCESS 1 in 3.49s]
2021-01-30 04:33:48.621021 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-30 04:33:48.621204 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-30 04:33:48.622393 (Thread-1): 22:33:48 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-30 04:33:48.622762 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:33:48.622894 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-30 04:33:48.630365 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-30 04:33:48.630690 (Thread-1): finished collecting timing info
2021-01-30 04:33:48.634666 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-30 04:33:48.635583 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:33:48.635672 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-30 04:33:48.635757 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:33:49.483521 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-01-30 04:33:49.483771 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:33:49.483921 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-30 04:33:51.395802 (Thread-1): SQL status: SUCCESS 1 in 1.91 seconds
2021-01-30 04:33:51.397378 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-30 04:33:51.397642 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:33:51.397778 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-30 04:33:51.525919 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-01-30 04:33:51.529015 (Thread-1): finished collecting timing info
2021-01-30 04:33:51.529346 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-30 04:33:51.679660 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28999096-6ab9-4667-8aef-6e17ec957dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107819190>]}
2021-01-30 04:33:51.681203 (Thread-1): 22:33:51 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.06s]
2021-01-30 04:33:51.681393 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-30 04:33:51.681579 (Thread-1): Began running node model.jrtests_learn_dbt.time
2021-01-30 04:33:51.682884 (Thread-1): 22:33:51 | 5 of 6 START table model dbt.time.................................... [RUN]
2021-01-30 04:33:51.683183 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:33:51.683306 (Thread-1): Compiling model.jrtests_learn_dbt.time
2021-01-30 04:33:51.691683 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.time"
2021-01-30 04:33:51.692041 (Thread-1): finished collecting timing info
2021-01-30 04:33:51.696004 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.time"
2021-01-30 04:33:51.696868 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:33:51.696960 (Thread-1): On model.jrtests_learn_dbt.time: BEGIN
2021-01-30 04:33:51.697048 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:33:52.625416 (Thread-1): SQL status: SUCCESS 1 in 0.93 seconds
2021-01-30 04:33:52.625672 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:33:52.625822 (Thread-1): On model.jrtests_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.time"} */


      create or replace transient table analytics.dbt.time  as
      (


SELECT
  To_time(Concat(t_hour :: VARCHAR, ':', t_minute, ':', t_second)) TIME,
  current_date last_update_date,
  current_time last_update_time
FROM
  "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE
  TIME <= current_time
ORDER  BY TIME DESC


      );
2021-01-30 04:33:54.251740 (Thread-1): SQL status: SUCCESS 1 in 1.63 seconds
2021-01-30 04:33:54.253313 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-30 04:33:54.253574 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:33:54.253723 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-30 04:33:54.381003 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-01-30 04:33:54.384105 (Thread-1): finished collecting timing info
2021-01-30 04:33:54.384440 (Thread-1): On model.jrtests_learn_dbt.time: Close
2021-01-30 04:33:54.539006 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28999096-6ab9-4667-8aef-6e17ec957dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b08190>]}
2021-01-30 04:33:54.540554 (Thread-1): 22:33:54 | 5 of 6 OK created table model dbt.time............................... [SUCCESS 1 in 2.86s]
2021-01-30 04:33:54.540746 (Thread-1): Finished running node model.jrtests_learn_dbt.time
2021-01-30 04:33:54.540934 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-30 04:33:54.542158 (Thread-1): 22:33:54 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-01-30 04:33:54.542568 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:33:54.542716 (Thread-1): Compiling model.jrtests_learn_dbt.my_second_dbt_model
2021-01-30 04:33:54.551748 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-30 04:33:54.552105 (Thread-1): finished collecting timing info
2021-01-30 04:33:54.556357 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-30 04:33:54.557040 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:33:54.557133 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: BEGIN
2021-01-30 04:33:54.557220 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:33:55.126069 (Thread-1): SQL status: SUCCESS 1 in 0.57 seconds
2021-01-30 04:33:55.126240 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:33:55.126339 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.my_first_dbt_model
where id = 1
      );
2021-01-30 04:33:56.300100 (Thread-1): SQL status: SUCCESS 1 in 1.17 seconds
2021-01-30 04:33:56.301697 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-30 04:33:56.301981 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:33:56.302102 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-30 04:33:56.424356 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-30 04:33:56.427468 (Thread-1): finished collecting timing info
2021-01-30 04:33:56.427796 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: Close
2021-01-30 04:33:56.621745 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28999096-6ab9-4667-8aef-6e17ec957dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e2e80>]}
2021-01-30 04:33:56.623317 (Thread-1): 22:33:56 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.08s]
2021-01-30 04:33:56.623505 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-30 04:33:56.624761 (MainThread): Acquiring new snowflake connection "master".
2021-01-30 04:33:56.624971 (MainThread): Using snowflake connection "master".
2021-01-30 04:33:56.625074 (MainThread): On master: BEGIN
2021-01-30 04:33:56.625179 (MainThread): Opening a new connection, currently in state closed
2021-01-30 04:33:57.470270 (MainThread): SQL status: SUCCESS 1 in 0.85 seconds
2021-01-30 04:33:57.470540 (MainThread): On master: COMMIT
2021-01-30 04:33:57.470789 (MainThread): Using snowflake connection "master".
2021-01-30 04:33:57.470937 (MainThread): On master: COMMIT
2021-01-30 04:33:57.934894 (MainThread): SQL status: SUCCESS 1 in 0.46 seconds
2021-01-30 04:33:57.935177 (MainThread): On master: Close
2021-01-30 04:33:58.124046 (MainThread): 22:33:58 | 
2021-01-30 04:33:58.124276 (MainThread): 22:33:58 | Finished running 6 table models in 23.84s.
2021-01-30 04:33:58.124430 (MainThread): Connection 'master' was properly closed.
2021-01-30 04:33:58.124543 (MainThread): Connection 'model.jrtests_learn_dbt.my_second_dbt_model' was properly closed.
2021-01-30 04:33:58.143125 (MainThread): 
2021-01-30 04:33:58.143247 (MainThread): Completed successfully
2021-01-30 04:33:58.143359 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-01-30 04:33:58.143511 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b257c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b25b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b258e0>]}
2021-01-30 04:33:58.143688 (MainThread): Flushing usage events
2021-01-30 04:56:16.283618 (MainThread): Running with dbt=0.18.1
2021-01-30 04:56:16.413960 (MainThread): Loading KWallet
2021-01-30 04:56:16.414893 (MainThread): Loading SecretService
2021-01-30 04:56:16.416301 (MainThread): Loading Windows
2021-01-30 04:56:16.417920 (MainThread): Loading chainer
2021-01-30 04:56:16.418631 (MainThread): Loading macOS
2021-01-30 04:56:16.875327 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-30 04:56:16.876991 (MainThread): Tracking: tracking
2021-01-30 04:56:16.877219 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032c2220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034afc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034af8e0>]}
2021-01-30 04:56:16.897528 (MainThread): Partial parsing not enabled
2021-01-30 04:56:16.899634 (MainThread): Parsing macros/catalog.sql
2021-01-30 04:56:16.901796 (MainThread): Parsing macros/adapters.sql
2021-01-30 04:56:16.929261 (MainThread): Parsing macros/materializations/merge.sql
2021-01-30 04:56:16.931309 (MainThread): Parsing macros/materializations/view.sql
2021-01-30 04:56:16.932942 (MainThread): Parsing macros/materializations/table.sql
2021-01-30 04:56:16.937164 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-30 04:56:16.949092 (MainThread): Parsing macros/core.sql
2021-01-30 04:56:16.953163 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-30 04:56:16.961923 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-30 04:56:16.963854 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-30 04:56:16.980157 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-30 04:56:17.008495 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-30 04:56:17.028195 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-30 04:56:17.031946 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-30 04:56:17.038985 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-30 04:56:17.053372 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-30 04:56:17.059905 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-30 04:56:17.065957 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-30 04:56:17.070769 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-30 04:56:17.071856 (MainThread): Parsing macros/etc/query.sql
2021-01-30 04:56:17.073264 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-30 04:56:17.075646 (MainThread): Parsing macros/etc/datetime.sql
2021-01-30 04:56:17.084308 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-30 04:56:17.086306 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-30 04:56:17.088148 (MainThread): Parsing macros/adapters/common.sql
2021-01-30 04:56:17.127670 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-30 04:56:17.129588 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-30 04:56:17.131223 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-30 04:56:17.132981 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-30 04:56:17.140064 (MainThread): Partial parsing not enabled
2021-01-30 04:56:17.180966 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:56:17.202016 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:56:17.213142 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:56:17.223634 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:56:17.237578 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:56:17.248185 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:56:17.554164 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-30 04:56:17.555103 (MainThread): 
2021-01-30 04:56:17.555360 (MainThread): Acquiring new snowflake connection "master".
2021-01-30 04:56:17.562305 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-30 04:56:17.573742 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-30 04:56:17.573828 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-30 04:56:17.573900 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-30 04:56:18.531386 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 0.96 seconds
2021-01-30 04:56:18.536437 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-30 04:56:18.707326 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-30 04:56:18.713975 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-30 04:56:18.714076 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-30 04:56:18.714162 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-30 04:56:19.550349 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.84 seconds
2021-01-30 04:56:19.557741 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-30 04:56:19.724682 (MainThread): Using snowflake connection "master".
2021-01-30 04:56:19.724874 (MainThread): On master: BEGIN
2021-01-30 04:56:19.725007 (MainThread): Opening a new connection, currently in state init
2021-01-30 04:56:20.566029 (MainThread): SQL status: SUCCESS 1 in 0.84 seconds
2021-01-30 04:56:20.566211 (MainThread): On master: COMMIT
2021-01-30 04:56:20.566375 (MainThread): Using snowflake connection "master".
2021-01-30 04:56:20.566468 (MainThread): On master: COMMIT
2021-01-30 04:56:21.028681 (MainThread): SQL status: SUCCESS 1 in 0.46 seconds
2021-01-30 04:56:21.028877 (MainThread): On master: Close
2021-01-30 04:56:21.251088 (MainThread): 22:56:21 | Concurrency: 1 threads (target='dev')
2021-01-30 04:56:21.251321 (MainThread): 22:56:21 | 
2021-01-30 04:56:21.255504 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-30 04:56:21.257068 (Thread-1): 22:56:21 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-01-30 04:56:21.257467 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:56:21.257624 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-30 04:56:21.277333 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-30 04:56:21.278879 (Thread-1): finished collecting timing info
2021-01-30 04:56:21.310395 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-30 04:56:21.311937 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:56:21.312044 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-01-30 04:56:21.312133 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:56:21.951293 (Thread-1): SQL status: SUCCESS 1 in 0.64 seconds
2021-01-30 04:56:21.951549 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:56:21.951702 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-01-30 04:56:22.939120 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-01-30 04:56:22.940838 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-30 04:56:22.941094 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 04:56:22.941216 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-30 04:56:23.068807 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-01-30 04:56:23.083390 (Thread-1): finished collecting timing info
2021-01-30 04:56:23.083630 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-01-30 04:56:23.282026 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e687879-eca2-445d-a9eb-32035a59a88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104320430>]}
2021-01-30 04:56:23.283590 (Thread-1): 22:56:23 | 1 of 6 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.02s]
2021-01-30 04:56:23.283777 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-30 04:56:23.283961 (Thread-1): Began running node model.jrtests_learn_dbt.covid_us
2021-01-30 04:56:23.285133 (Thread-1): 22:56:23 | 2 of 6 START table model dbt.covid_us................................ [RUN]
2021-01-30 04:56:23.285549 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:56:23.285684 (Thread-1): Compiling model.jrtests_learn_dbt.covid_us
2021-01-30 04:56:23.294146 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-30 04:56:23.296015 (Thread-1): finished collecting timing info
2021-01-30 04:56:23.300403 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-30 04:56:23.301155 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:56:23.301246 (Thread-1): On model.jrtests_learn_dbt.covid_us: BEGIN
2021-01-30 04:56:23.301337 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:56:24.120699 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-01-30 04:56:24.120950 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:56:24.121098 (Thread-1): On model.jrtests_learn_dbt.covid_us: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.covid_us"} */


      create or replace transient table analytics.dbt.covid_us  as
      (


 select
   *
 from
  "COVID19_BY_STARSCHEMA"."PUBLIC"."JHU_COVID_19"
 where
    date <=current_date
  and
    country_region = 'United States'


      );
2021-01-30 04:56:29.218749 (Thread-1): SQL status: SUCCESS 1 in 5.10 seconds
2021-01-30 04:56:29.220312 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-30 04:56:29.220607 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 04:56:29.220743 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-30 04:56:29.391640 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-30 04:56:29.394738 (Thread-1): finished collecting timing info
2021-01-30 04:56:29.395072 (Thread-1): On model.jrtests_learn_dbt.covid_us: Close
2021-01-30 04:56:29.596920 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e687879-eca2-445d-a9eb-32035a59a88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10422dd00>]}
2021-01-30 04:56:29.598442 (Thread-1): 22:56:29 | 2 of 6 OK created table model dbt.covid_us........................... [SUCCESS 1 in 6.31s]
2021-01-30 04:56:29.598632 (Thread-1): Finished running node model.jrtests_learn_dbt.covid_us
2021-01-30 04:56:29.598817 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-30 04:56:29.600085 (Thread-1): 22:56:29 | 3 of 6 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-30 04:56:29.600365 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:56:29.600486 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-30 04:56:29.608675 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-30 04:56:29.611187 (Thread-1): finished collecting timing info
2021-01-30 04:56:29.615577 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-30 04:56:29.616520 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:56:29.616614 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-30 04:56:29.616703 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:56:30.611199 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-01-30 04:56:30.611453 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:56:30.611603 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate
      );
2021-01-30 04:56:33.112414 (Thread-1): SQL status: SUCCESS 1 in 2.50 seconds
2021-01-30 04:56:33.113969 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-30 04:56:33.114205 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 04:56:33.114328 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-30 04:56:33.229059 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-30 04:56:33.232171 (Thread-1): finished collecting timing info
2021-01-30 04:56:33.232499 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-30 04:56:33.430900 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e687879-eca2-445d-a9eb-32035a59a88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104035be0>]}
2021-01-30 04:56:33.432478 (Thread-1): 22:56:33 | 3 of 6 OK created table model dbt.cumulative_orders_by_date.......... [SUCCESS 1 in 3.83s]
2021-01-30 04:56:33.432668 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-30 04:56:33.432855 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-30 04:56:33.434029 (Thread-1): 22:56:33 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-30 04:56:33.434414 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:56:33.434547 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-30 04:56:33.441999 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-30 04:56:33.444010 (Thread-1): finished collecting timing info
2021-01-30 04:56:33.449105 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-30 04:56:33.450936 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:56:33.451086 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-30 04:56:33.451195 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:56:34.507779 (Thread-1): SQL status: SUCCESS 1 in 1.06 seconds
2021-01-30 04:56:34.508037 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:56:34.508191 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-30 04:56:36.389607 (Thread-1): SQL status: SUCCESS 1 in 1.88 seconds
2021-01-30 04:56:36.391181 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-30 04:56:36.391449 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 04:56:36.391569 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-30 04:56:36.491479 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2021-01-30 04:56:36.494593 (Thread-1): finished collecting timing info
2021-01-30 04:56:36.494930 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-30 04:56:36.670173 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e687879-eca2-445d-a9eb-32035a59a88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10422df70>]}
2021-01-30 04:56:36.671707 (Thread-1): 22:56:36 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.24s]
2021-01-30 04:56:36.671895 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-30 04:56:36.672077 (Thread-1): Began running node model.jrtests_learn_dbt.time
2021-01-30 04:56:36.673385 (Thread-1): 22:56:36 | 5 of 6 START table model dbt.time.................................... [RUN]
2021-01-30 04:56:36.673670 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:56:36.673790 (Thread-1): Compiling model.jrtests_learn_dbt.time
2021-01-30 04:56:36.681841 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.time"
2021-01-30 04:56:36.682168 (Thread-1): finished collecting timing info
2021-01-30 04:56:36.686100 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.time"
2021-01-30 04:56:36.686952 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:56:36.687043 (Thread-1): On model.jrtests_learn_dbt.time: BEGIN
2021-01-30 04:56:36.687128 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:56:37.561763 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-01-30 04:56:37.562014 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:56:37.562196 (Thread-1): On model.jrtests_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.time"} */


      create or replace transient table analytics.dbt.time  as
      (


SELECT
  To_time(Concat(t_hour :: VARCHAR, ':', t_minute, ':', t_second)) TIME,
  current_date last_update_date,
  current_time last_update_time
FROM
  "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE
  TIME <= current_time
ORDER  BY TIME DESC


      );
2021-01-30 04:56:38.846982 (Thread-1): SQL status: SUCCESS 1 in 1.28 seconds
2021-01-30 04:56:38.848546 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-30 04:56:38.848803 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 04:56:38.848948 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-30 04:56:38.951897 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2021-01-30 04:56:38.954827 (Thread-1): finished collecting timing info
2021-01-30 04:56:38.955148 (Thread-1): On model.jrtests_learn_dbt.time: Close
2021-01-30 04:56:39.150736 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e687879-eca2-445d-a9eb-32035a59a88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104233640>]}
2021-01-30 04:56:39.152267 (Thread-1): 22:56:39 | 5 of 6 OK created table model dbt.time............................... [SUCCESS 1 in 2.48s]
2021-01-30 04:56:39.152450 (Thread-1): Finished running node model.jrtests_learn_dbt.time
2021-01-30 04:56:39.152629 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-30 04:56:39.153854 (Thread-1): 22:56:39 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-01-30 04:56:39.154156 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:56:39.154282 (Thread-1): Compiling model.jrtests_learn_dbt.my_second_dbt_model
2021-01-30 04:56:39.163251 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-30 04:56:39.163626 (Thread-1): finished collecting timing info
2021-01-30 04:56:39.167742 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-30 04:56:39.168405 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:56:39.168495 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: BEGIN
2021-01-30 04:56:39.168578 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 04:56:39.749872 (Thread-1): SQL status: SUCCESS 1 in 0.58 seconds
2021-01-30 04:56:39.750119 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:56:39.750263 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.first_model
where id = 1
      );
2021-01-30 04:56:41.099850 (Thread-1): SQL status: SUCCESS 1 in 1.35 seconds
2021-01-30 04:56:41.101406 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-30 04:56:41.101657 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 04:56:41.101809 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-30 04:56:41.226459 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-30 04:56:41.229611 (Thread-1): finished collecting timing info
2021-01-30 04:56:41.229938 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: Close
2021-01-30 04:56:41.500490 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e687879-eca2-445d-a9eb-32035a59a88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042a15b0>]}
2021-01-30 04:56:41.502061 (Thread-1): 22:56:41 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.35s]
2021-01-30 04:56:41.502243 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-30 04:56:41.503431 (MainThread): Acquiring new snowflake connection "master".
2021-01-30 04:56:41.503641 (MainThread): Using snowflake connection "master".
2021-01-30 04:56:41.503738 (MainThread): On master: BEGIN
2021-01-30 04:56:41.503831 (MainThread): Opening a new connection, currently in state closed
2021-01-30 04:56:42.109612 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2021-01-30 04:56:42.109872 (MainThread): On master: COMMIT
2021-01-30 04:56:42.110114 (MainThread): Using snowflake connection "master".
2021-01-30 04:56:42.110256 (MainThread): On master: COMMIT
2021-01-30 04:56:42.533613 (MainThread): SQL status: SUCCESS 1 in 0.42 seconds
2021-01-30 04:56:42.533882 (MainThread): On master: Close
2021-01-30 04:56:42.738719 (MainThread): 22:56:42 | 
2021-01-30 04:56:42.738938 (MainThread): 22:56:42 | Finished running 6 table models in 25.18s.
2021-01-30 04:56:42.739083 (MainThread): Connection 'master' was properly closed.
2021-01-30 04:56:42.739191 (MainThread): Connection 'model.jrtests_learn_dbt.my_second_dbt_model' was properly closed.
2021-01-30 04:56:42.757136 (MainThread): 
2021-01-30 04:56:42.757253 (MainThread): Completed successfully
2021-01-30 04:56:42.757360 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-01-30 04:56:42.757507 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104240190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104240640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042400d0>]}
2021-01-30 04:56:42.757674 (MainThread): Flushing usage events
2021-01-30 14:22:35.282364 (MainThread): Running with dbt=0.18.1
2021-01-30 14:22:35.412625 (MainThread): Loading KWallet
2021-01-30 14:22:35.413467 (MainThread): Loading SecretService
2021-01-30 14:22:35.414662 (MainThread): Loading Windows
2021-01-30 14:22:35.415986 (MainThread): Loading chainer
2021-01-30 14:22:35.416584 (MainThread): Loading macOS
2021-01-30 14:22:35.861541 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-30 14:22:35.862947 (MainThread): Tracking: tracking
2021-01-30 14:22:35.863247 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e5cd0>]}
2021-01-30 14:22:35.882808 (MainThread): Partial parsing not enabled
2021-01-30 14:22:35.883819 (MainThread): Parsing macros/catalog.sql
2021-01-30 14:22:35.886021 (MainThread): Parsing macros/adapters.sql
2021-01-30 14:22:35.913865 (MainThread): Parsing macros/materializations/merge.sql
2021-01-30 14:22:35.916342 (MainThread): Parsing macros/materializations/view.sql
2021-01-30 14:22:35.918252 (MainThread): Parsing macros/materializations/table.sql
2021-01-30 14:22:35.922617 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-30 14:22:35.935046 (MainThread): Parsing macros/core.sql
2021-01-30 14:22:35.939090 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-30 14:22:35.948517 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-30 14:22:35.950593 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-30 14:22:35.966440 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-30 14:22:35.993923 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-30 14:22:36.014422 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-30 14:22:36.016534 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-30 14:22:36.022465 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-30 14:22:36.035433 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-30 14:22:36.044576 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-30 14:22:36.051321 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-30 14:22:36.056261 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-30 14:22:36.057623 (MainThread): Parsing macros/etc/query.sql
2021-01-30 14:22:36.059393 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-30 14:22:36.061716 (MainThread): Parsing macros/etc/datetime.sql
2021-01-30 14:22:36.071372 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-30 14:22:36.073541 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-30 14:22:36.075417 (MainThread): Parsing macros/adapters/common.sql
2021-01-30 14:22:36.113920 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-30 14:22:36.116208 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-30 14:22:36.117840 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-30 14:22:36.119610 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-30 14:22:36.126653 (MainThread): Partial parsing not enabled
2021-01-30 14:22:36.160636 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 14:22:36.169181 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107496d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10765a070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10766d310>]}
2021-01-30 14:22:36.169563 (MainThread): Flushing usage events
2021-01-30 14:22:36.603383 (MainThread): Connection 'model.jrtests_learn_dbt.my_first_dbt_model' was properly closed.
2021-01-30 14:22:36.603627 (MainThread): Encountered an error:
2021-01-30 14:22:36.603825 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  expected token 'end of print statement', got '='
    line 9
      {{ config(materialized='table', alias= 'first_model'), schema = 'venu_test'   }}
2021-01-30 14:22:36.620336 (MainThread): Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 9, in template
jinja2.exceptions.TemplateSyntaxError: expected token 'end of print statement', got '='
  line 9
    {{ config(materialized='table', alias= 'first_model'), schema = 'venu_test'   }}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 399, in run
    self._runtime_initialize()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 748, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 349, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 204, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 177, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 133, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/base.py", line 429, in parse_file
    self.parse_node(file_block)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/base.py", line 402, in parse_node
    self.render_update(node, config)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/base.py", line 377, in render_update
    self.render_with_context(node, config)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 570, in get_rendered
    template = get_template(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/Cellar/python@3.8/3.8.6/Frameworks/Python.framework/Versions/3.8/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  expected token 'end of print statement', got '='
    line 9
      {{ config(materialized='table', alias= 'first_model'), schema = 'venu_test'   }}

2021-01-30 14:23:06.808218 (MainThread): Running with dbt=0.18.1
2021-01-30 14:23:06.869905 (MainThread): Loading KWallet
2021-01-30 14:23:06.870391 (MainThread): Loading SecretService
2021-01-30 14:23:06.870767 (MainThread): Loading Windows
2021-01-30 14:23:06.871259 (MainThread): Loading chainer
2021-01-30 14:23:06.871511 (MainThread): Loading macOS
2021-01-30 14:23:07.115654 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-30 14:23:07.116565 (MainThread): Tracking: tracking
2021-01-30 14:23:07.116829 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d951f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f81cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f81970>]}
2021-01-30 14:23:07.135839 (MainThread): Partial parsing not enabled
2021-01-30 14:23:07.136692 (MainThread): Parsing macros/catalog.sql
2021-01-30 14:23:07.138932 (MainThread): Parsing macros/adapters.sql
2021-01-30 14:23:07.165794 (MainThread): Parsing macros/materializations/merge.sql
2021-01-30 14:23:07.167805 (MainThread): Parsing macros/materializations/view.sql
2021-01-30 14:23:07.169408 (MainThread): Parsing macros/materializations/table.sql
2021-01-30 14:23:07.172894 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-30 14:23:07.182632 (MainThread): Parsing macros/core.sql
2021-01-30 14:23:07.185886 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-30 14:23:07.193901 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-30 14:23:07.195505 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-30 14:23:07.210737 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-30 14:23:07.238611 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-30 14:23:07.261375 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-30 14:23:07.263320 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-30 14:23:07.269300 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-30 14:23:07.282364 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-30 14:23:07.289304 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-30 14:23:07.294961 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-30 14:23:07.299413 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-30 14:23:07.300458 (MainThread): Parsing macros/etc/query.sql
2021-01-30 14:23:07.301447 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-30 14:23:07.302893 (MainThread): Parsing macros/etc/datetime.sql
2021-01-30 14:23:07.310645 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-30 14:23:07.312375 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-30 14:23:07.313897 (MainThread): Parsing macros/adapters/common.sql
2021-01-30 14:23:07.353621 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-30 14:23:07.355414 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-30 14:23:07.356870 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-30 14:23:07.358503 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-30 14:23:07.365769 (MainThread): Partial parsing not enabled
2021-01-30 14:23:07.401031 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 14:23:07.407748 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ab8340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bfa040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c132e0>]}
2021-01-30 14:23:07.407918 (MainThread): Flushing usage events
2021-01-30 14:23:07.729938 (MainThread): Connection 'model.jrtests_learn_dbt.my_first_dbt_model' was properly closed.
2021-01-30 14:23:07.730175 (MainThread): Encountered an error:
2021-01-30 14:23:07.730376 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  expected token 'end of print statement', got '='
    line 9
      {{ config(materialized='table', alias= 'first_model'), schema= 'venu_test'   }}
2021-01-30 14:23:07.733057 (MainThread): Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 9, in template
jinja2.exceptions.TemplateSyntaxError: expected token 'end of print statement', got '='
  line 9
    {{ config(materialized='table', alias= 'first_model'), schema= 'venu_test'   }}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 399, in run
    self._runtime_initialize()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 748, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 349, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 204, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 177, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/manifest.py", line 133, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/base.py", line 429, in parse_file
    self.parse_node(file_block)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/base.py", line 402, in parse_node
    self.render_update(node, config)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/base.py", line 377, in render_update
    self.render_with_context(node, config)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 570, in get_rendered
    template = get_template(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/Cellar/python@3.8/3.8.6/Frameworks/Python.framework/Versions/3.8/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  expected token 'end of print statement', got '='
    line 9
      {{ config(materialized='table', alias= 'first_model'), schema= 'venu_test'   }}

2021-01-30 14:23:50.007181 (MainThread): Running with dbt=0.18.1
2021-01-30 14:23:50.066844 (MainThread): Loading KWallet
2021-01-30 14:23:50.067854 (MainThread): Loading SecretService
2021-01-30 14:23:50.068652 (MainThread): Loading Windows
2021-01-30 14:23:50.069427 (MainThread): Loading chainer
2021-01-30 14:23:50.069918 (MainThread): Loading macOS
2021-01-30 14:23:50.314572 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-30 14:23:50.315531 (MainThread): Tracking: tracking
2021-01-30 14:23:50.315776 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bce1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dbacd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dba970>]}
2021-01-30 14:23:50.335133 (MainThread): Partial parsing not enabled
2021-01-30 14:23:50.335987 (MainThread): Parsing macros/catalog.sql
2021-01-30 14:23:50.338008 (MainThread): Parsing macros/adapters.sql
2021-01-30 14:23:50.364528 (MainThread): Parsing macros/materializations/merge.sql
2021-01-30 14:23:50.366290 (MainThread): Parsing macros/materializations/view.sql
2021-01-30 14:23:50.367588 (MainThread): Parsing macros/materializations/table.sql
2021-01-30 14:23:50.371218 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-30 14:23:50.381224 (MainThread): Parsing macros/core.sql
2021-01-30 14:23:50.384598 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-30 14:23:50.392638 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-30 14:23:50.394493 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-30 14:23:50.409886 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-30 14:23:50.437106 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-30 14:23:50.456770 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-30 14:23:50.458475 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-30 14:23:50.464208 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-30 14:23:50.476990 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-30 14:23:50.483431 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-30 14:23:50.489092 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-30 14:23:50.493480 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-30 14:23:50.494294 (MainThread): Parsing macros/etc/query.sql
2021-01-30 14:23:50.495203 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-30 14:23:50.496631 (MainThread): Parsing macros/etc/datetime.sql
2021-01-30 14:23:50.504675 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-30 14:23:50.506453 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-30 14:23:50.508383 (MainThread): Parsing macros/adapters/common.sql
2021-01-30 14:23:50.546520 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-30 14:23:50.548305 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-30 14:23:50.549707 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-30 14:23:50.551227 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-30 14:23:50.558188 (MainThread): Partial parsing not enabled
2021-01-30 14:23:50.595149 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 14:23:50.616015 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 14:23:50.628709 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 14:23:50.642371 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 14:23:50.657955 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 14:23:50.669783 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 14:23:50.972289 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-30 14:23:50.973216 (MainThread): 
2021-01-30 14:23:50.973455 (MainThread): Acquiring new snowflake connection "master".
2021-01-30 14:23:50.979737 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-30 14:23:50.991195 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-30 14:23:50.991279 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-30 14:23:50.991354 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-30 14:23:52.069999 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.08 seconds
2021-01-30 14:23:52.074815 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-30 14:23:52.251651 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-30 14:23:52.254708 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-30 14:23:52.254823 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-30 14:23:52.254927 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-01-30 14:23:53.365749 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.11 seconds
2021-01-30 14:23:53.366798 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-30 14:23:53.547693 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt_venu_test".
2021-01-30 14:23:53.548037 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt_venu_test".
2021-01-30 14:23:53.548247 (ThreadPoolExecutor-0_0): Creating schema "analytics.dbt_venu_test"
2021-01-30 14:23:53.554354 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt_venu_test".
2021-01-30 14:23:53.554466 (ThreadPoolExecutor-0_0): On create_analytics_dbt_venu_test: BEGIN
2021-01-30 14:23:53.554569 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-01-30 14:23:54.389945 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.84 seconds
2021-01-30 14:23:54.390203 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt_venu_test".
2021-01-30 14:23:54.390351 (ThreadPoolExecutor-0_0): On create_analytics_dbt_venu_test: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "create_analytics_dbt_venu_test"} */
create schema if not exists analytics.dbt_venu_test
2021-01-30 14:23:54.995862 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.61 seconds
2021-01-30 14:23:54.997360 (ThreadPoolExecutor-0_0): On create_analytics_dbt_venu_test: COMMIT
2021-01-30 14:23:54.997628 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt_venu_test".
2021-01-30 14:23:54.997786 (ThreadPoolExecutor-0_0): On create_analytics_dbt_venu_test: COMMIT
2021-01-30 14:23:55.134450 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.14 seconds
2021-01-30 14:23:55.134729 (ThreadPoolExecutor-0_0): On create_analytics_dbt_venu_test: Close
2021-01-30 14:23:55.395312 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-30 14:23:55.401857 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-30 14:23:55.401955 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-30 14:23:55.402041 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-30 14:23:55.975294 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.57 seconds
2021-01-30 14:23:55.983379 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-30 14:23:56.166102 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_venu_test".
2021-01-30 14:23:56.169345 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_venu_test".
2021-01-30 14:23:56.169458 (ThreadPoolExecutor-1_0): On list_analytics_dbt_venu_test: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt_venu_test"} */

    show terse objects in analytics.dbt_venu_test
2021-01-30 14:23:56.169562 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-30 14:23:56.973293 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.80 seconds
2021-01-30 14:23:56.973884 (ThreadPoolExecutor-1_0): On list_analytics_dbt_venu_test: Close
2021-01-30 14:23:57.181781 (MainThread): Using snowflake connection "master".
2021-01-30 14:23:57.181969 (MainThread): On master: BEGIN
2021-01-30 14:23:57.182100 (MainThread): Opening a new connection, currently in state init
2021-01-30 14:23:57.808856 (MainThread): SQL status: SUCCESS 1 in 0.63 seconds
2021-01-30 14:23:57.809131 (MainThread): On master: COMMIT
2021-01-30 14:23:57.809383 (MainThread): Using snowflake connection "master".
2021-01-30 14:23:57.809533 (MainThread): On master: COMMIT
2021-01-30 14:23:58.272217 (MainThread): SQL status: SUCCESS 1 in 0.46 seconds
2021-01-30 14:23:58.272500 (MainThread): On master: Close
2021-01-30 14:23:58.436948 (MainThread): 08:23:58 | Concurrency: 1 threads (target='dev')
2021-01-30 14:23:58.437208 (MainThread): 08:23:58 | 
2021-01-30 14:23:58.440125 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-30 14:23:58.441717 (Thread-1): 08:23:58 | 1 of 6 START table model dbt_venu_test.first_model................... [RUN]
2021-01-30 14:23:58.442103 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 14:23:58.442259 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-30 14:23:58.467335 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-30 14:23:58.467722 (Thread-1): finished collecting timing info
2021-01-30 14:23:58.498879 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-30 14:23:58.500252 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 14:23:58.500365 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-01-30 14:23:58.500456 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 14:23:59.094137 (Thread-1): SQL status: SUCCESS 1 in 0.59 seconds
2021-01-30 14:23:59.094387 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 14:23:59.094542 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt_venu_test.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-01-30 14:24:00.528524 (Thread-1): SQL status: SUCCESS 1 in 1.43 seconds
2021-01-30 14:24:00.530098 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-30 14:24:00.530361 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-30 14:24:00.530485 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-30 14:24:00.670821 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-01-30 14:24:00.685225 (Thread-1): finished collecting timing info
2021-01-30 14:24:00.685461 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-01-30 14:24:00.905474 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f89db7e2-de5d-4728-9dae-45c9a395e514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104962be0>]}
2021-01-30 14:24:00.906781 (Thread-1): 08:24:00 | 1 of 6 OK created table model dbt_venu_test.first_model.............. [SUCCESS 1 in 2.46s]
2021-01-30 14:24:00.906936 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-30 14:24:00.907090 (Thread-1): Began running node model.jrtests_learn_dbt.covid_us
2021-01-30 14:24:00.908155 (Thread-1): 08:24:00 | 2 of 6 START table model dbt.covid_us................................ [RUN]
2021-01-30 14:24:00.908437 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 14:24:00.908559 (Thread-1): Compiling model.jrtests_learn_dbt.covid_us
2021-01-30 14:24:00.917441 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-30 14:24:00.917793 (Thread-1): finished collecting timing info
2021-01-30 14:24:00.921823 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-30 14:24:00.922518 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 14:24:00.922608 (Thread-1): On model.jrtests_learn_dbt.covid_us: BEGIN
2021-01-30 14:24:00.922694 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 14:24:01.483939 (Thread-1): SQL status: SUCCESS 1 in 0.56 seconds
2021-01-30 14:24:01.484197 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 14:24:01.484350 (Thread-1): On model.jrtests_learn_dbt.covid_us: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.covid_us"} */


      create or replace transient table analytics.dbt.covid_us  as
      (


 select
   *
 from
  "COVID19_BY_STARSCHEMA"."PUBLIC"."JHU_COVID_19"
 where
    date <=current_date
  and
    country_region = 'United States'


      );
2021-01-30 14:24:06.264575 (Thread-1): SQL status: SUCCESS 1 in 4.78 seconds
2021-01-30 14:24:06.266197 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-30 14:24:06.266409 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-30 14:24:06.266531 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-30 14:24:06.379009 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-30 14:24:06.382150 (Thread-1): finished collecting timing info
2021-01-30 14:24:06.382482 (Thread-1): On model.jrtests_learn_dbt.covid_us: Close
2021-01-30 14:24:06.546906 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f89db7e2-de5d-4728-9dae-45c9a395e514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cadcd0>]}
2021-01-30 14:24:06.548428 (Thread-1): 08:24:06 | 2 of 6 OK created table model dbt.covid_us........................... [SUCCESS 1 in 5.64s]
2021-01-30 14:24:06.548613 (Thread-1): Finished running node model.jrtests_learn_dbt.covid_us
2021-01-30 14:24:06.548795 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-30 14:24:06.549991 (Thread-1): 08:24:06 | 3 of 6 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-30 14:24:06.550404 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 14:24:06.550537 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-30 14:24:06.558392 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-30 14:24:06.559622 (Thread-1): finished collecting timing info
2021-01-30 14:24:06.564061 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-30 14:24:06.564991 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 14:24:06.565085 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-30 14:24:06.565176 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 14:24:07.437240 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-01-30 14:24:07.437503 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 14:24:07.437655 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate
      );
2021-01-30 14:24:09.744124 (Thread-1): SQL status: SUCCESS 1 in 2.31 seconds
2021-01-30 14:24:09.745697 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-30 14:24:09.745963 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-30 14:24:09.746102 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-30 14:24:09.886929 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-01-30 14:24:09.890033 (Thread-1): finished collecting timing info
2021-01-30 14:24:09.890365 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-30 14:24:10.204949 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f89db7e2-de5d-4728-9dae-45c9a395e514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049622e0>]}
2021-01-30 14:24:10.206210 (Thread-1): 08:24:10 | 3 of 6 OK created table model dbt.cumulative_orders_by_date.......... [SUCCESS 1 in 3.65s]
2021-01-30 14:24:10.206360 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-30 14:24:10.206506 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-30 14:24:10.207630 (Thread-1): 08:24:10 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-30 14:24:10.207916 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 14:24:10.208035 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-30 14:24:10.215457 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-30 14:24:10.216535 (Thread-1): finished collecting timing info
2021-01-30 14:24:10.220653 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-30 14:24:10.221565 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 14:24:10.221657 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-30 14:24:10.221744 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 14:24:11.114667 (Thread-1): SQL status: SUCCESS 1 in 0.89 seconds
2021-01-30 14:24:11.114917 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 14:24:11.115066 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-30 14:24:13.120752 (Thread-1): SQL status: SUCCESS 1 in 2.01 seconds
2021-01-30 14:24:13.122293 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-30 14:24:13.122552 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-30 14:24:13.122702 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-30 14:24:13.242269 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-30 14:24:13.245365 (Thread-1): finished collecting timing info
2021-01-30 14:24:13.245701 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-30 14:24:13.473690 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f89db7e2-de5d-4728-9dae-45c9a395e514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bcc670>]}
2021-01-30 14:24:13.475206 (Thread-1): 08:24:13 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.27s]
2021-01-30 14:24:13.475394 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-30 14:24:13.475579 (Thread-1): Began running node model.jrtests_learn_dbt.time
2021-01-30 14:24:13.476765 (Thread-1): 08:24:13 | 5 of 6 START table model dbt.time.................................... [RUN]
2021-01-30 14:24:13.477073 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 14:24:13.477203 (Thread-1): Compiling model.jrtests_learn_dbt.time
2021-01-30 14:24:13.485754 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.time"
2021-01-30 14:24:13.487324 (Thread-1): finished collecting timing info
2021-01-30 14:24:13.491966 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.time"
2021-01-30 14:24:13.492885 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 14:24:13.492977 (Thread-1): On model.jrtests_learn_dbt.time: BEGIN
2021-01-30 14:24:13.493065 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 14:24:14.465766 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-01-30 14:24:14.466021 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 14:24:14.466170 (Thread-1): On model.jrtests_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.time"} */


      create or replace transient table analytics.dbt.time  as
      (


SELECT
  To_time(Concat(t_hour :: VARCHAR, ':', t_minute, ':', t_second)) TIME,
  current_date last_update_date,
  current_time last_update_time
FROM
  "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE
  TIME <= current_time
ORDER  BY TIME DESC


      );
2021-01-30 14:24:15.889436 (Thread-1): SQL status: SUCCESS 1 in 1.42 seconds
2021-01-30 14:24:15.890998 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-30 14:24:15.891256 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-30 14:24:15.891412 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-30 14:24:15.987243 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2021-01-30 14:24:15.990340 (Thread-1): finished collecting timing info
2021-01-30 14:24:15.990670 (Thread-1): On model.jrtests_learn_dbt.time: Close
2021-01-30 14:24:16.156219 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f89db7e2-de5d-4728-9dae-45c9a395e514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bb89d0>]}
2021-01-30 14:24:16.157803 (Thread-1): 08:24:16 | 5 of 6 OK created table model dbt.time............................... [SUCCESS 1 in 2.68s]
2021-01-30 14:24:16.157993 (Thread-1): Finished running node model.jrtests_learn_dbt.time
2021-01-30 14:24:16.158178 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-30 14:24:16.159357 (Thread-1): 08:24:16 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-01-30 14:24:16.159660 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 14:24:16.159785 (Thread-1): Compiling model.jrtests_learn_dbt.my_second_dbt_model
2021-01-30 14:24:16.168040 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-30 14:24:16.168462 (Thread-1): finished collecting timing info
2021-01-30 14:24:16.172542 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-30 14:24:16.173222 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 14:24:16.173315 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: BEGIN
2021-01-30 14:24:16.173403 (Thread-1): Opening a new connection, currently in state closed
2021-01-30 14:24:16.732823 (Thread-1): SQL status: SUCCESS 1 in 0.56 seconds
2021-01-30 14:24:16.733081 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 14:24:16.733235 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt_venu_test.first_model
where id = 1
      );
2021-01-30 14:24:18.061026 (Thread-1): SQL status: SUCCESS 1 in 1.33 seconds
2021-01-30 14:24:18.062591 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-30 14:24:18.062869 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-30 14:24:18.062992 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-30 14:24:18.185933 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-30 14:24:18.189031 (Thread-1): finished collecting timing info
2021-01-30 14:24:18.189362 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: Close
2021-01-30 14:24:18.371194 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f89db7e2-de5d-4728-9dae-45c9a395e514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bb3c40>]}
2021-01-30 14:24:18.372714 (Thread-1): 08:24:18 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.21s]
2021-01-30 14:24:18.372901 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-30 14:24:18.374114 (MainThread): Acquiring new snowflake connection "master".
2021-01-30 14:24:18.374318 (MainThread): Using snowflake connection "master".
2021-01-30 14:24:18.374417 (MainThread): On master: BEGIN
2021-01-30 14:24:18.374514 (MainThread): Opening a new connection, currently in state closed
2021-01-30 14:24:20.149116 (MainThread): SQL status: SUCCESS 1 in 1.77 seconds
2021-01-30 14:24:20.149387 (MainThread): On master: COMMIT
2021-01-30 14:24:20.149632 (MainThread): Using snowflake connection "master".
2021-01-30 14:24:20.149778 (MainThread): On master: COMMIT
2021-01-30 14:24:20.600121 (MainThread): SQL status: SUCCESS 1 in 0.45 seconds
2021-01-30 14:24:20.600406 (MainThread): On master: Close
2021-01-30 14:24:20.840201 (MainThread): 08:24:20 | 
2021-01-30 14:24:20.840429 (MainThread): 08:24:20 | Finished running 6 table models in 29.87s.
2021-01-30 14:24:20.840583 (MainThread): Connection 'master' was properly closed.
2021-01-30 14:24:20.840696 (MainThread): Connection 'model.jrtests_learn_dbt.my_second_dbt_model' was properly closed.
2021-01-30 14:24:20.858846 (MainThread): 
2021-01-30 14:24:20.858965 (MainThread): Completed successfully
2021-01-30 14:24:20.859078 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-01-30 14:24:20.859230 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104be6d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104be6d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104be6f40>]}
2021-01-30 14:24:20.859400 (MainThread): Flushing usage events
2021-01-31 00:03:44.592691 (MainThread): Running with dbt=0.18.1
2021-01-31 00:03:44.679972 (MainThread): Loading KWallet
2021-01-31 00:03:44.680544 (MainThread): Loading SecretService
2021-01-31 00:03:44.681012 (MainThread): Loading Windows
2021-01-31 00:03:44.681628 (MainThread): Loading chainer
2021-01-31 00:03:44.681956 (MainThread): Loading macOS
2021-01-31 00:03:45.014359 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-31 00:03:45.016448 (MainThread): Tracking: tracking
2021-01-31 00:03:45.016704 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1f1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3ddca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3dd940>]}
2021-01-31 00:03:45.039765 (MainThread): Partial parsing not enabled
2021-01-31 00:03:45.041120 (MainThread): Parsing macros/catalog.sql
2021-01-31 00:03:45.043257 (MainThread): Parsing macros/adapters.sql
2021-01-31 00:03:45.070006 (MainThread): Parsing macros/materializations/merge.sql
2021-01-31 00:03:45.071855 (MainThread): Parsing macros/materializations/view.sql
2021-01-31 00:03:45.073225 (MainThread): Parsing macros/materializations/table.sql
2021-01-31 00:03:45.076885 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-31 00:03:45.088185 (MainThread): Parsing macros/core.sql
2021-01-31 00:03:45.091713 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-31 00:03:45.099946 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-31 00:03:45.101587 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-31 00:03:45.117242 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-31 00:03:45.145044 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-31 00:03:45.164676 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-31 00:03:45.166391 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-31 00:03:45.172183 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-31 00:03:45.185011 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-31 00:03:45.191378 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-31 00:03:45.197360 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-31 00:03:45.202143 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-31 00:03:45.203014 (MainThread): Parsing macros/etc/query.sql
2021-01-31 00:03:45.204030 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-31 00:03:45.205543 (MainThread): Parsing macros/etc/datetime.sql
2021-01-31 00:03:45.213843 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-31 00:03:45.215658 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-31 00:03:45.217210 (MainThread): Parsing macros/adapters/common.sql
2021-01-31 00:03:45.259248 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-31 00:03:45.261124 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-31 00:03:45.262582 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-31 00:03:45.264176 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-31 00:03:45.271246 (MainThread): Partial parsing not enabled
2021-01-31 00:03:45.304969 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:03:45.324855 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:03:45.339871 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:03:45.352803 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:03:45.367591 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:03:45.378273 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:03:45.669541 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-31 00:03:45.670401 (MainThread): 
2021-01-31 00:03:45.670639 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:03:45.676807 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-31 00:03:45.688074 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-31 00:03:45.688157 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-31 00:03:45.688232 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-31 00:03:46.811224 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.12 seconds
2021-01-31 00:03:46.816037 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-31 00:03:46.999298 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-31 00:03:47.002325 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-31 00:03:47.002448 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-31 00:03:47.002557 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-01-31 00:03:47.902607 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.90 seconds
2021-01-31 00:03:47.903713 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-31 00:03:48.104392 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-31 00:03:48.110979 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-31 00:03:48.111080 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-31 00:03:48.111165 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-31 00:03:48.863619 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.75 seconds
2021-01-31 00:03:48.871705 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-31 00:03:49.048352 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt_venu_test".
2021-01-31 00:03:49.051642 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt_venu_test".
2021-01-31 00:03:49.051759 (ThreadPoolExecutor-1_0): On list_analytics_dbt_venu_test: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt_venu_test"} */

    show terse objects in analytics.dbt_venu_test
2021-01-31 00:03:49.051867 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-31 00:03:49.943285 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 0.89 seconds
2021-01-31 00:03:49.945657 (ThreadPoolExecutor-1_0): On list_analytics_dbt_venu_test: Close
2021-01-31 00:03:50.129825 (MainThread): Using snowflake connection "master".
2021-01-31 00:03:50.130015 (MainThread): On master: BEGIN
2021-01-31 00:03:50.130148 (MainThread): Opening a new connection, currently in state init
2021-01-31 00:03:50.697271 (MainThread): SQL status: SUCCESS 1 in 0.57 seconds
2021-01-31 00:03:50.697546 (MainThread): On master: COMMIT
2021-01-31 00:03:50.697799 (MainThread): Using snowflake connection "master".
2021-01-31 00:03:50.697945 (MainThread): On master: COMMIT
2021-01-31 00:03:50.994951 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2021-01-31 00:03:50.995225 (MainThread): On master: Close
2021-01-31 00:03:51.185328 (MainThread): 18:03:51 | Concurrency: 1 threads (target='dev')
2021-01-31 00:03:51.185561 (MainThread): 18:03:51 | 
2021-01-31 00:03:51.189431 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:03:51.191014 (Thread-1): 18:03:51 | 1 of 6 START table model dbt_venu_test.first_model................... [RUN]
2021-01-31 00:03:51.191417 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:03:51.191549 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:03:51.211918 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-31 00:03:51.212275 (Thread-1): finished collecting timing info
2021-01-31 00:03:51.243767 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-31 00:03:51.245197 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:03:51.245348 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-01-31 00:03:51.245444 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:03:51.859537 (Thread-1): SQL status: SUCCESS 1 in 0.61 seconds
2021-01-31 00:03:51.859786 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:03:51.859932 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt_venu_test.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-01-31 00:03:53.043582 (Thread-1): SQL status: SUCCESS 1 in 1.18 seconds
2021-01-31 00:03:53.045269 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-31 00:03:53.045524 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:03:53.045638 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-31 00:03:53.168098 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-31 00:03:53.182430 (Thread-1): finished collecting timing info
2021-01-31 00:03:53.182664 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-01-31 00:03:53.356145 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afe2821e-8dd1-468a-841e-449c6094af61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0ac0a0>]}
2021-01-31 00:03:53.357671 (Thread-1): 18:03:53 | 1 of 6 OK created table model dbt_venu_test.first_model.............. [SUCCESS 1 in 2.16s]
2021-01-31 00:03:53.357851 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:03:53.358028 (Thread-1): Began running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:03:53.359243 (Thread-1): 18:03:53 | 2 of 6 START table model dbt.covid_us................................ [RUN]
2021-01-31 00:03:53.359516 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:03:53.359749 (Thread-1): Compiling model.jrtests_learn_dbt.covid_us
2021-01-31 00:03:53.368915 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:03:53.369235 (Thread-1): finished collecting timing info
2021-01-31 00:03:53.373163 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:03:53.373848 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:03:53.373935 (Thread-1): On model.jrtests_learn_dbt.covid_us: BEGIN
2021-01-31 00:03:53.374018 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:03:53.963844 (Thread-1): SQL status: SUCCESS 1 in 0.59 seconds
2021-01-31 00:03:53.964092 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:03:53.964235 (Thread-1): On model.jrtests_learn_dbt.covid_us: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.covid_us"} */


      create or replace transient table analytics.dbt.covid_us  as
      (


 select
   *
 from
  "COVID19_BY_STARSCHEMA"."PUBLIC"."JHU_COVID_19"
 where
    date <=current_date
  and
    country_region = 'United States'


      );
2021-01-31 00:03:58.374840 (Thread-1): SQL status: SUCCESS 1 in 4.41 seconds
2021-01-31 00:03:58.376103 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:03:58.376307 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:03:58.376430 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:03:58.483304 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-31 00:03:58.486419 (Thread-1): finished collecting timing info
2021-01-31 00:03:58.486745 (Thread-1): On model.jrtests_learn_dbt.covid_us: Close
2021-01-31 00:03:58.666828 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afe2821e-8dd1-468a-841e-449c6094af61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4c7be0>]}
2021-01-31 00:03:58.668346 (Thread-1): 18:03:58 | 2 of 6 OK created table model dbt.covid_us........................... [SUCCESS 1 in 5.31s]
2021-01-31 00:03:58.668531 (Thread-1): Finished running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:03:58.668712 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:03:58.669927 (Thread-1): 18:03:58 | 3 of 6 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-31 00:03:58.670220 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:03:58.670340 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:03:58.678132 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:03:58.679484 (Thread-1): finished collecting timing info
2021-01-31 00:03:58.683952 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:03:58.684889 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:03:58.684981 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-31 00:03:58.685068 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:03:59.582337 (Thread-1): SQL status: SUCCESS 1 in 0.90 seconds
2021-01-31 00:03:59.582583 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:03:59.582730 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate
      );
2021-01-31 00:04:02.053850 (Thread-1): SQL status: SUCCESS 1 in 2.47 seconds
2021-01-31 00:04:02.055384 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:04:02.055635 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:04:02.055785 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:04:02.176431 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-31 00:04:02.179530 (Thread-1): finished collecting timing info
2021-01-31 00:04:02.179857 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-31 00:04:02.338832 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afe2821e-8dd1-468a-841e-449c6094af61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c050670>]}
2021-01-31 00:04:02.340450 (Thread-1): 18:04:02 | 3 of 6 OK created table model dbt.cumulative_orders_by_date.......... [SUCCESS 1 in 3.67s]
2021-01-31 00:04:02.340637 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:04:02.340817 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:04:02.342005 (Thread-1): 18:04:02 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-31 00:04:02.342399 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:04:02.342535 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:04:02.350452 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:04:02.351728 (Thread-1): finished collecting timing info
2021-01-31 00:04:02.356277 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:04:02.357283 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:04:02.357375 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-31 00:04:02.357462 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:04:03.213496 (Thread-1): SQL status: SUCCESS 1 in 0.86 seconds
2021-01-31 00:04:03.213743 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:04:03.213888 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-31 00:04:05.122507 (Thread-1): SQL status: SUCCESS 1 in 1.91 seconds
2021-01-31 00:04:05.124050 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:04:05.124306 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:04:05.124422 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:04:05.228225 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2021-01-31 00:04:05.231352 (Thread-1): finished collecting timing info
2021-01-31 00:04:05.231681 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-31 00:04:05.399189 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afe2821e-8dd1-468a-841e-449c6094af61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3dd940>]}
2021-01-31 00:04:05.400713 (Thread-1): 18:04:05 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.06s]
2021-01-31 00:04:05.400898 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:04:05.401077 (Thread-1): Began running node model.jrtests_learn_dbt.time
2021-01-31 00:04:05.402265 (Thread-1): 18:04:05 | 5 of 6 START table model dbt.time.................................... [RUN]
2021-01-31 00:04:05.402556 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:04:05.402678 (Thread-1): Compiling model.jrtests_learn_dbt.time
2021-01-31 00:04:05.410998 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:04:05.412019 (Thread-1): finished collecting timing info
2021-01-31 00:04:05.415927 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:04:05.416755 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:04:05.416841 (Thread-1): On model.jrtests_learn_dbt.time: BEGIN
2021-01-31 00:04:05.416920 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:04:06.312087 (Thread-1): SQL status: SUCCESS 1 in 0.90 seconds
2021-01-31 00:04:06.312332 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:04:06.312474 (Thread-1): On model.jrtests_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.time"} */


      create or replace transient table analytics.dbt.time  as
      (


SELECT
  To_time(Concat(t_hour :: VARCHAR, ':', t_minute, ':', t_second)) TIME,
  current_date last_update_date,
  current_time last_update_time
FROM
  "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE
  TIME <= current_time
ORDER  BY TIME DESC


      );
2021-01-31 00:04:07.787379 (Thread-1): SQL status: SUCCESS 1 in 1.47 seconds
2021-01-31 00:04:07.788926 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:04:07.789177 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:04:07.789324 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:04:07.904422 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-31 00:04:07.907559 (Thread-1): finished collecting timing info
2021-01-31 00:04:07.907886 (Thread-1): On model.jrtests_learn_dbt.time: Close
2021-01-31 00:04:08.067955 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afe2821e-8dd1-468a-841e-449c6094af61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1ecbb0>]}
2021-01-31 00:04:08.069504 (Thread-1): 18:04:08 | 5 of 6 OK created table model dbt.time............................... [SUCCESS 1 in 2.67s]
2021-01-31 00:04:08.069689 (Thread-1): Finished running node model.jrtests_learn_dbt.time
2021-01-31 00:04:08.069870 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:04:08.071078 (Thread-1): 18:04:08 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-01-31 00:04:08.071371 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:04:08.071509 (Thread-1): Compiling model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:04:08.080053 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-31 00:04:08.080479 (Thread-1): finished collecting timing info
2021-01-31 00:04:08.084528 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-31 00:04:08.085193 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:04:08.085282 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: BEGIN
2021-01-31 00:04:08.085365 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:04:08.666177 (Thread-1): SQL status: SUCCESS 1 in 0.58 seconds
2021-01-31 00:04:08.666413 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:04:08.666554 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt_venu_test.first_model
where id = 1
      );
2021-01-31 00:04:09.835514 (Thread-1): SQL status: SUCCESS 1 in 1.17 seconds
2021-01-31 00:04:09.837057 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-31 00:04:09.837338 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:04:09.837454 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-31 00:04:09.989551 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-01-31 00:04:09.992656 (Thread-1): finished collecting timing info
2021-01-31 00:04:09.992989 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: Close
2021-01-31 00:04:10.199007 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afe2821e-8dd1-468a-841e-449c6094af61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3e26a0>]}
2021-01-31 00:04:10.200546 (Thread-1): 18:04:10 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.13s]
2021-01-31 00:04:10.200739 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:04:10.201968 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:04:10.202173 (MainThread): Using snowflake connection "master".
2021-01-31 00:04:10.202267 (MainThread): On master: BEGIN
2021-01-31 00:04:10.202360 (MainThread): Opening a new connection, currently in state closed
2021-01-31 00:04:10.813464 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2021-01-31 00:04:10.813725 (MainThread): On master: COMMIT
2021-01-31 00:04:10.813970 (MainThread): Using snowflake connection "master".
2021-01-31 00:04:10.814114 (MainThread): On master: COMMIT
2021-01-31 00:04:11.044049 (MainThread): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-31 00:04:11.044314 (MainThread): On master: Close
2021-01-31 00:04:11.212160 (MainThread): 18:04:11 | 
2021-01-31 00:04:11.212381 (MainThread): 18:04:11 | Finished running 6 table models in 25.54s.
2021-01-31 00:04:11.212528 (MainThread): Connection 'master' was properly closed.
2021-01-31 00:04:11.212634 (MainThread): Connection 'model.jrtests_learn_dbt.my_second_dbt_model' was properly closed.
2021-01-31 00:04:11.231088 (MainThread): 
2021-01-31 00:04:11.231205 (MainThread): Completed successfully
2021-01-31 00:04:11.231308 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-01-31 00:04:11.231456 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be89e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c04b100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c04b790>]}
2021-01-31 00:04:11.231622 (MainThread): Flushing usage events
2021-01-31 00:06:25.569426 (MainThread): Running with dbt=0.18.1
2021-01-31 00:06:25.629644 (MainThread): Loading KWallet
2021-01-31 00:06:25.630147 (MainThread): Loading SecretService
2021-01-31 00:06:25.630529 (MainThread): Loading Windows
2021-01-31 00:06:25.631038 (MainThread): Loading chainer
2021-01-31 00:06:25.631286 (MainThread): Loading macOS
2021-01-31 00:06:25.883862 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-31 00:06:25.884850 (MainThread): Tracking: tracking
2021-01-31 00:06:25.885170 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a773190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a95fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a95f940>]}
2021-01-31 00:06:25.904727 (MainThread): Partial parsing not enabled
2021-01-31 00:06:25.905600 (MainThread): Parsing macros/catalog.sql
2021-01-31 00:06:25.907642 (MainThread): Parsing macros/adapters.sql
2021-01-31 00:06:25.934997 (MainThread): Parsing macros/materializations/merge.sql
2021-01-31 00:06:25.936941 (MainThread): Parsing macros/materializations/view.sql
2021-01-31 00:06:25.938325 (MainThread): Parsing macros/materializations/table.sql
2021-01-31 00:06:25.942058 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-31 00:06:25.952387 (MainThread): Parsing macros/core.sql
2021-01-31 00:06:25.955815 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-31 00:06:25.964134 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-31 00:06:25.966050 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-31 00:06:25.982058 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-31 00:06:26.010047 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-31 00:06:26.029576 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-31 00:06:26.031278 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-31 00:06:26.037036 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-31 00:06:26.050294 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-31 00:06:26.056705 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-31 00:06:26.062782 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-31 00:06:26.067402 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-31 00:06:26.068274 (MainThread): Parsing macros/etc/query.sql
2021-01-31 00:06:26.069240 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-31 00:06:26.070926 (MainThread): Parsing macros/etc/datetime.sql
2021-01-31 00:06:26.079047 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-31 00:06:26.080863 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-31 00:06:26.082417 (MainThread): Parsing macros/adapters/common.sql
2021-01-31 00:06:26.122027 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-31 00:06:26.124141 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-31 00:06:26.125565 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-31 00:06:26.127161 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-31 00:06:26.134049 (MainThread): Partial parsing not enabled
2021-01-31 00:06:26.168692 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:06:26.188913 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:06:26.198999 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:06:26.209363 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:06:26.223294 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:06:26.233775 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:06:26.531675 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-31 00:06:26.532542 (MainThread): 
2021-01-31 00:06:26.532780 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:06:26.538742 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-31 00:06:26.550082 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-31 00:06:26.550164 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-31 00:06:26.550237 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-31 00:06:27.862810 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.31 seconds
2021-01-31 00:06:27.867688 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-31 00:06:28.195250 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics_test".
2021-01-31 00:06:28.198302 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics_test".
2021-01-31 00:06:28.198424 (ThreadPoolExecutor-0_0): On list_analytics_test: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_test"} */

    show terse schemas in database analytics_test
    limit 10000
2021-01-31 00:06:28.198535 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-01-31 00:06:28.831025 (ThreadPoolExecutor-0_0): Snowflake query id: 0199f746-0b09-c33b-0000-b6cd002659b2
2021-01-31 00:06:28.831260 (ThreadPoolExecutor-0_0): Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
2021-01-31 00:06:28.831488 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-01-31 00:06:28.831631 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-01-31 00:06:28.831850 (ThreadPoolExecutor-0_0): On list_analytics_test: Close
2021-01-31 00:06:28.959906 (MainThread): Connection 'master' was properly closed.
2021-01-31 00:06:28.960091 (MainThread): Connection 'list_analytics_test' was properly closed.
2021-01-31 00:06:28.960298 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7a4220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8728b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8728e0>]}
2021-01-31 00:06:28.960553 (MainThread): Flushing usage events
2021-01-31 00:06:29.272299 (MainThread): Encountered an error:
2021-01-31 00:06:29.272530 (MainThread): Runtime Error
  Database error while listing schemas in database "analytics_test"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
2021-01-31 00:06:29.284466 (MainThread): Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 101, in list_schemas
    results = self.execute_macro(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 984, in execute_macro
    result = macro_function(**kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 42, in macro
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/local/Cellar/python@3.8/3.8.6/Frameworks/Python.framework/Versions/3.8/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002043 (02000): SQL compilation error:
  Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 419, in run
    result = self.execute_with_hooks(selected_uids)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 379, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/run.py", line 394, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 500, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/usr/local/Cellar/python@3.8/3.8.6/Frameworks/Python.framework/Versions/3.8/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/usr/local/Cellar/python@3.8/3.8.6/Frameworks/Python.framework/Versions/3.8/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/usr/local/Cellar/python@3.8/3.8.6/Frameworks/Python.framework/Versions/3.8/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 477, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/impl.py", line 110, in list_schemas
    raise RuntimeException(msg)
dbt.exceptions.RuntimeException: Runtime Error
  Database error while listing schemas in database "analytics_test"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.

2021-01-31 00:26:54.296574 (MainThread): Running with dbt=0.18.1
2021-01-31 00:26:54.357491 (MainThread): Loading KWallet
2021-01-31 00:26:54.357968 (MainThread): Loading SecretService
2021-01-31 00:26:54.358350 (MainThread): Loading Windows
2021-01-31 00:26:54.358947 (MainThread): Loading chainer
2021-01-31 00:26:54.359229 (MainThread): Loading macOS
2021-01-31 00:26:54.613387 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-31 00:26:54.614379 (MainThread): Tracking: tracking
2021-01-31 00:26:54.614682 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0e2a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2d2dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2d2cd0>]}
2021-01-31 00:26:54.634990 (MainThread): Partial parsing not enabled
2021-01-31 00:26:54.636334 (MainThread): Parsing macros/catalog.sql
2021-01-31 00:26:54.638475 (MainThread): Parsing macros/adapters.sql
2021-01-31 00:26:54.665534 (MainThread): Parsing macros/materializations/merge.sql
2021-01-31 00:26:54.667426 (MainThread): Parsing macros/materializations/view.sql
2021-01-31 00:26:54.668816 (MainThread): Parsing macros/materializations/table.sql
2021-01-31 00:26:54.672552 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-31 00:26:54.683214 (MainThread): Parsing macros/core.sql
2021-01-31 00:26:54.686649 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-31 00:26:54.694963 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-31 00:26:54.696694 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-31 00:26:54.712286 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-31 00:26:54.740257 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-31 00:26:54.759978 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-31 00:26:54.761701 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-31 00:26:54.767561 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-31 00:26:54.780391 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-31 00:26:54.786601 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-31 00:26:54.792591 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-31 00:26:54.797452 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-31 00:26:54.798341 (MainThread): Parsing macros/etc/query.sql
2021-01-31 00:26:54.799294 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-31 00:26:54.800820 (MainThread): Parsing macros/etc/datetime.sql
2021-01-31 00:26:54.809171 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-31 00:26:54.810932 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-31 00:26:54.812436 (MainThread): Parsing macros/adapters/common.sql
2021-01-31 00:26:54.852844 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-31 00:26:54.854537 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-31 00:26:54.855913 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-31 00:26:54.857452 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-31 00:26:54.864616 (MainThread): Partial parsing not enabled
2021-01-31 00:26:54.905522 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:26:54.926825 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:26:54.937030 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:26:54.948117 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:26:54.962003 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:26:54.972982 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:26:55.275139 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-31 00:26:55.276126 (MainThread): 
2021-01-31 00:26:55.276455 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:26:55.282649 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics_test".
2021-01-31 00:26:55.296915 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics_test".
2021-01-31 00:26:55.297030 (ThreadPoolExecutor-0_0): On list_analytics_test: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_test"} */

    show terse schemas in database analytics_test
    limit 10000
2021-01-31 00:26:55.297108 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-31 00:26:56.670562 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 1.37 seconds
2021-01-31 00:26:56.675223 (ThreadPoolExecutor-0_0): On list_analytics_test: Close
2021-01-31 00:26:56.866089 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-31 00:26:56.869006 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-31 00:26:56.869130 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-31 00:26:56.869244 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-01-31 00:26:57.631577 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.76 seconds
2021-01-31 00:26:57.632451 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-31 00:26:57.810789 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_test_dbt_venu_test".
2021-01-31 00:26:57.811135 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_test_dbt_venu_test".
2021-01-31 00:26:57.811345 (ThreadPoolExecutor-0_0): Creating schema "analytics_test.dbt_venu_test"
2021-01-31 00:26:57.817683 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_test_dbt_venu_test".
2021-01-31 00:26:57.817793 (ThreadPoolExecutor-0_0): On create_analytics_test_dbt_venu_test: BEGIN
2021-01-31 00:26:57.817895 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-01-31 00:26:58.681116 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.86 seconds
2021-01-31 00:26:58.681373 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_test_dbt_venu_test".
2021-01-31 00:26:58.681526 (ThreadPoolExecutor-0_0): On create_analytics_test_dbt_venu_test: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "create_analytics_test_dbt_venu_test"} */
create schema if not exists analytics_test.dbt_venu_test
2021-01-31 00:26:59.128378 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.45 seconds
2021-01-31 00:26:59.129926 (ThreadPoolExecutor-0_0): On create_analytics_test_dbt_venu_test: COMMIT
2021-01-31 00:26:59.130192 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_test_dbt_venu_test".
2021-01-31 00:26:59.130350 (ThreadPoolExecutor-0_0): On create_analytics_test_dbt_venu_test: COMMIT
2021-01-31 00:26:59.241582 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-31 00:26:59.241858 (ThreadPoolExecutor-0_0): On create_analytics_test_dbt_venu_test: Close
2021-01-31 00:26:59.444237 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-31 00:26:59.450994 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-31 00:26:59.451112 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-31 00:26:59.451202 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-31 00:26:59.994720 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.54 seconds
2021-01-31 00:27:00.003116 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-31 00:27:00.171701 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_test_dbt_venu_test".
2021-01-31 00:27:00.174998 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_test_dbt_venu_test".
2021-01-31 00:27:00.175113 (ThreadPoolExecutor-1_0): On list_analytics_test_dbt_venu_test: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_test_dbt_venu_test"} */

    show terse objects in analytics_test.dbt_venu_test
2021-01-31 00:27:00.175221 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-31 00:27:01.126454 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.95 seconds
2021-01-31 00:27:01.127052 (ThreadPoolExecutor-1_0): On list_analytics_test_dbt_venu_test: Close
2021-01-31 00:27:01.295865 (MainThread): Using snowflake connection "master".
2021-01-31 00:27:01.296056 (MainThread): On master: BEGIN
2021-01-31 00:27:01.296189 (MainThread): Opening a new connection, currently in state init
2021-01-31 00:27:01.854566 (MainThread): SQL status: SUCCESS 1 in 0.56 seconds
2021-01-31 00:27:01.854844 (MainThread): On master: COMMIT
2021-01-31 00:27:01.855097 (MainThread): Using snowflake connection "master".
2021-01-31 00:27:01.855249 (MainThread): On master: COMMIT
2021-01-31 00:27:02.199655 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2021-01-31 00:27:02.199940 (MainThread): On master: Close
2021-01-31 00:27:02.385731 (MainThread): 18:27:02 | Concurrency: 1 threads (target='dev')
2021-01-31 00:27:02.385964 (MainThread): 18:27:02 | 
2021-01-31 00:27:02.387725 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:27:02.389232 (Thread-1): 18:27:02 | 1 of 6 START table model analytics_test.dbt_venu_test.first_model.... [RUN]
2021-01-31 00:27:02.389534 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:27:02.389667 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:27:02.410245 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-31 00:27:02.410605 (Thread-1): finished collecting timing info
2021-01-31 00:27:02.441238 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-31 00:27:02.442255 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:27:02.442363 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-01-31 00:27:02.442454 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:27:03.059103 (Thread-1): SQL status: SUCCESS 1 in 0.62 seconds
2021-01-31 00:27:03.059360 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:27:03.059515 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics_test.dbt_venu_test.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-01-31 00:27:04.244820 (Thread-1): SQL status: SUCCESS 1 in 1.19 seconds
2021-01-31 00:27:04.246389 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-31 00:27:04.246643 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:27:04.246768 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-31 00:27:04.363799 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-31 00:27:04.377924 (Thread-1): finished collecting timing info
2021-01-31 00:27:04.378163 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-01-31 00:27:04.595321 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8c63a0-21a6-455b-a574-cc348fce135c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113ab070>]}
2021-01-31 00:27:04.596883 (Thread-1): 18:27:04 | 1 of 6 OK created table model analytics_test.dbt_venu_test.first_model [SUCCESS 1 in 2.21s]
2021-01-31 00:27:04.597076 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:27:04.597265 (Thread-1): Began running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:27:04.598627 (Thread-1): 18:27:04 | 2 of 6 START table model dbt.covid_us................................ [RUN]
2021-01-31 00:27:04.599033 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:27:04.599176 (Thread-1): Compiling model.jrtests_learn_dbt.covid_us
2021-01-31 00:27:04.608403 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:27:04.608780 (Thread-1): finished collecting timing info
2021-01-31 00:27:04.612963 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:27:04.613670 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:27:04.613761 (Thread-1): On model.jrtests_learn_dbt.covid_us: BEGIN
2021-01-31 00:27:04.613848 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:27:05.206719 (Thread-1): SQL status: SUCCESS 1 in 0.59 seconds
2021-01-31 00:27:05.206974 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:27:05.207128 (Thread-1): On model.jrtests_learn_dbt.covid_us: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.covid_us"} */


      create or replace transient table analytics.dbt.covid_us  as
      (


 select
   *
 from
  "COVID19_BY_STARSCHEMA"."PUBLIC"."JHU_COVID_19"
 where
    date <=current_date
  and
    country_region = 'United States'


      );
2021-01-31 00:27:09.367880 (Thread-1): unclosed <socket.socket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.24', 49304), raddr=('52.184.166.117', 443)>
2021-01-31 00:27:09.368523 (Thread-1): SQL status: SUCCESS 1 in 4.16 seconds
2021-01-31 00:27:09.370015 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:27:09.370220 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:27:09.370342 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:27:09.773755 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2021-01-31 00:27:09.776868 (Thread-1): finished collecting timing info
2021-01-31 00:27:09.777199 (Thread-1): On model.jrtests_learn_dbt.covid_us: Close
2021-01-31 00:27:09.952645 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8c63a0-21a6-455b-a574-cc348fce135c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee40e80>]}
2021-01-31 00:27:09.954200 (Thread-1): 18:27:09 | 2 of 6 OK created table model dbt.covid_us........................... [SUCCESS 1 in 5.35s]
2021-01-31 00:27:09.954392 (Thread-1): Finished running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:27:09.954584 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:27:09.955765 (Thread-1): 18:27:09 | 3 of 6 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-31 00:27:09.956068 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:27:09.956200 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:27:09.964430 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:27:09.964896 (Thread-1): finished collecting timing info
2021-01-31 00:27:09.969219 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:27:09.970109 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:27:09.970202 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-31 00:27:09.970291 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:27:10.872028 (Thread-1): SQL status: SUCCESS 1 in 0.90 seconds
2021-01-31 00:27:10.872279 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:27:10.872442 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate
      );
2021-01-31 00:27:13.254498 (Thread-1): SQL status: SUCCESS 1 in 2.38 seconds
2021-01-31 00:27:13.255758 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:27:13.255967 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:27:13.256090 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:27:13.371904 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-31 00:27:13.374764 (Thread-1): finished collecting timing info
2021-01-31 00:27:13.375097 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-31 00:27:13.573961 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8c63a0-21a6-455b-a574-cc348fce135c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f14f670>]}
2021-01-31 00:27:13.575530 (Thread-1): 18:27:13 | 3 of 6 OK created table model dbt.cumulative_orders_by_date.......... [SUCCESS 1 in 3.62s]
2021-01-31 00:27:13.575723 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:27:13.575911 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:27:13.577099 (Thread-1): 18:27:13 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-31 00:27:13.577401 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:27:13.577531 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:27:13.585662 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:27:13.586071 (Thread-1): finished collecting timing info
2021-01-31 00:27:13.590315 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:27:13.591250 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:27:13.591341 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-31 00:27:13.591428 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:27:14.431002 (Thread-1): SQL status: SUCCESS 1 in 0.84 seconds
2021-01-31 00:27:14.431260 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:27:14.431415 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-31 00:27:16.581908 (Thread-1): SQL status: SUCCESS 1 in 2.15 seconds
2021-01-31 00:27:16.583296 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:27:16.583522 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:27:16.583648 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:27:16.696613 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-31 00:27:16.699395 (Thread-1): finished collecting timing info
2021-01-31 00:27:16.699759 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-31 00:27:16.876866 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8c63a0-21a6-455b-a574-cc348fce135c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0b82e0>]}
2021-01-31 00:27:16.878465 (Thread-1): 18:27:16 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.30s]
2021-01-31 00:27:16.878658 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:27:16.878851 (Thread-1): Began running node model.jrtests_learn_dbt.time
2021-01-31 00:27:16.880015 (Thread-1): 18:27:16 | 5 of 6 START table model dbt.time.................................... [RUN]
2021-01-31 00:27:16.880408 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:27:16.880541 (Thread-1): Compiling model.jrtests_learn_dbt.time
2021-01-31 00:27:16.889184 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:27:16.889555 (Thread-1): finished collecting timing info
2021-01-31 00:27:16.893564 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:27:16.894421 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:27:16.894514 (Thread-1): On model.jrtests_learn_dbt.time: BEGIN
2021-01-31 00:27:16.894603 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:27:17.935401 (Thread-1): SQL status: SUCCESS 1 in 1.04 seconds
2021-01-31 00:27:17.935659 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:27:17.935814 (Thread-1): On model.jrtests_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.time"} */


      create or replace transient table analytics.dbt.time  as
      (


SELECT
  To_time(Concat(t_hour :: VARCHAR, ':', t_minute, ':', t_second)) TIME,
  current_date last_update_date,
  current_time last_update_time
FROM
  "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE
  TIME <= current_time
ORDER  BY TIME DESC


      );
2021-01-31 00:27:19.197606 (Thread-1): SQL status: SUCCESS 1 in 1.26 seconds
2021-01-31 00:27:19.199080 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:27:19.199292 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:27:19.199417 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:27:19.305834 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-31 00:27:19.307981 (Thread-1): finished collecting timing info
2021-01-31 00:27:19.308226 (Thread-1): On model.jrtests_learn_dbt.time: Close
2021-01-31 00:27:19.489355 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8c63a0-21a6-455b-a574-cc348fce135c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f030640>]}
2021-01-31 00:27:19.490903 (Thread-1): 18:27:19 | 5 of 6 OK created table model dbt.time............................... [SUCCESS 1 in 2.61s]
2021-01-31 00:27:19.491094 (Thread-1): Finished running node model.jrtests_learn_dbt.time
2021-01-31 00:27:19.491283 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:27:19.492559 (Thread-1): 18:27:19 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-01-31 00:27:19.492872 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:27:19.493006 (Thread-1): Compiling model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:27:19.502345 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-31 00:27:19.502711 (Thread-1): finished collecting timing info
2021-01-31 00:27:19.507047 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-31 00:27:19.507723 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:27:19.507818 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: BEGIN
2021-01-31 00:27:19.507906 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:27:20.038211 (Thread-1): SQL status: SUCCESS 1 in 0.53 seconds
2021-01-31 00:27:20.038469 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:27:20.038626 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics_test.dbt_venu_test.first_model
where id = 1
      );
2021-01-31 00:27:21.245020 (Thread-1): SQL status: SUCCESS 1 in 1.21 seconds
2021-01-31 00:27:21.246582 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-31 00:27:21.246839 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:27:21.246984 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-31 00:27:21.389886 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-01-31 00:27:21.392996 (Thread-1): finished collecting timing info
2021-01-31 00:27:21.393332 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: Close
2021-01-31 00:27:21.549573 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8c63a0-21a6-455b-a574-cc348fce135c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f06ca30>]}
2021-01-31 00:27:21.551171 (Thread-1): 18:27:21 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.06s]
2021-01-31 00:27:21.551363 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:27:21.552622 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:27:21.552832 (MainThread): Using snowflake connection "master".
2021-01-31 00:27:21.552932 (MainThread): On master: BEGIN
2021-01-31 00:27:21.553031 (MainThread): Opening a new connection, currently in state closed
2021-01-31 00:27:22.400958 (MainThread): SQL status: SUCCESS 1 in 0.85 seconds
2021-01-31 00:27:22.401185 (MainThread): On master: COMMIT
2021-01-31 00:27:22.401380 (MainThread): Using snowflake connection "master".
2021-01-31 00:27:22.401496 (MainThread): On master: COMMIT
2021-01-31 00:27:22.882963 (MainThread): SQL status: SUCCESS 1 in 0.48 seconds
2021-01-31 00:27:22.883237 (MainThread): On master: Close
2021-01-31 00:27:23.064710 (MainThread): 18:27:23 | 
2021-01-31 00:27:23.064938 (MainThread): 18:27:23 | Finished running 6 table models in 27.79s.
2021-01-31 00:27:23.065091 (MainThread): Connection 'master' was properly closed.
2021-01-31 00:27:23.065201 (MainThread): Connection 'model.jrtests_learn_dbt.my_second_dbt_model' was properly closed.
2021-01-31 00:27:23.083182 (MainThread): 
2021-01-31 00:27:23.083302 (MainThread): Completed successfully
2021-01-31 00:27:23.083409 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-01-31 00:27:23.083563 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee40f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee40d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee40e50>]}
2021-01-31 00:27:23.083732 (MainThread): Flushing usage events
2021-01-31 00:35:24.497590 (MainThread): Running with dbt=0.18.1
2021-01-31 00:35:24.575302 (MainThread): Loading KWallet
2021-01-31 00:35:24.575784 (MainThread): Loading SecretService
2021-01-31 00:35:24.576154 (MainThread): Loading Windows
2021-01-31 00:35:24.576763 (MainThread): Loading chainer
2021-01-31 00:35:24.577131 (MainThread): Loading macOS
2021-01-31 00:35:24.875983 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-31 00:35:24.877968 (MainThread): Tracking: tracking
2021-01-31 00:35:24.878397 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db0cb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcfcc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcfce20>]}
2021-01-31 00:35:24.899722 (MainThread): Partial parsing not enabled
2021-01-31 00:35:24.901028 (MainThread): Parsing macros/catalog.sql
2021-01-31 00:35:24.903253 (MainThread): Parsing macros/adapters.sql
2021-01-31 00:35:24.931370 (MainThread): Parsing macros/materializations/merge.sql
2021-01-31 00:35:24.933302 (MainThread): Parsing macros/materializations/view.sql
2021-01-31 00:35:24.934692 (MainThread): Parsing macros/materializations/table.sql
2021-01-31 00:35:24.939069 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-31 00:35:24.950851 (MainThread): Parsing macros/core.sql
2021-01-31 00:35:24.954791 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-31 00:35:24.963284 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-31 00:35:24.965071 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-31 00:35:24.981601 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-31 00:35:25.012148 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-31 00:35:25.032099 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-31 00:35:25.033954 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-31 00:35:25.039943 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-31 00:35:25.054111 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-31 00:35:25.061190 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-31 00:35:25.068378 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-31 00:35:25.073598 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-31 00:35:25.074563 (MainThread): Parsing macros/etc/query.sql
2021-01-31 00:35:25.075748 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-31 00:35:25.077483 (MainThread): Parsing macros/etc/datetime.sql
2021-01-31 00:35:25.087265 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-31 00:35:25.089329 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-31 00:35:25.090987 (MainThread): Parsing macros/adapters/common.sql
2021-01-31 00:35:25.132003 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-31 00:35:25.133786 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-31 00:35:25.135279 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-31 00:35:25.137015 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-31 00:35:25.144271 (MainThread): Partial parsing not enabled
2021-01-31 00:35:25.182624 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:35:25.204541 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:35:25.215006 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:35:25.225565 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:35:25.240594 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:35:25.251439 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:35:25.561500 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-31 00:35:25.562394 (MainThread): 
2021-01-31 00:35:25.562676 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:35:25.570057 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-31 00:35:25.583580 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-31 00:35:25.583728 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-31 00:35:25.583824 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-31 00:35:26.940092 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.36 seconds
2021-01-31 00:35:26.943431 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-31 00:35:27.159058 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-31 00:35:27.165622 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-31 00:35:27.165721 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-31 00:35:27.165803 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-31 00:35:27.944413 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.78 seconds
2021-01-31 00:35:27.950325 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-31 00:35:28.230869 (MainThread): Using snowflake connection "master".
2021-01-31 00:35:28.231003 (MainThread): On master: BEGIN
2021-01-31 00:35:28.231091 (MainThread): Opening a new connection, currently in state init
2021-01-31 00:35:29.070090 (MainThread): SQL status: SUCCESS 1 in 0.84 seconds
2021-01-31 00:35:29.070268 (MainThread): On master: COMMIT
2021-01-31 00:35:29.070408 (MainThread): Using snowflake connection "master".
2021-01-31 00:35:29.070486 (MainThread): On master: COMMIT
2021-01-31 00:35:29.486527 (MainThread): SQL status: SUCCESS 1 in 0.42 seconds
2021-01-31 00:35:29.486699 (MainThread): On master: Close
2021-01-31 00:35:29.717721 (MainThread): 18:35:29 | Concurrency: 1 threads (target='dev')
2021-01-31 00:35:29.717886 (MainThread): 18:35:29 | 
2021-01-31 00:35:29.719135 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:35:29.720181 (Thread-1): 18:35:29 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-01-31 00:35:29.720423 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:35:29.720525 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:35:29.740459 (Thread-1): finished collecting timing info
2021-01-31 00:35:29.740948 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 270, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/compile.py", line 23, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/compilation.py", line 479, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/compilation.py", line 385, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 19, in top-level template code
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/context/base.py", line 148, in __call__
    return self.get_missing_var(var_name)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/context/base.py", line 129, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:35:29.747145 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df5333b0-488e-40f8-8585-50e69688377b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e97a3a0>]}
2021-01-31 00:35:29.748247 (Thread-1): 18:35:29 | 1 of 6 ERROR creating table model dbt.first_model.................... [ERROR in 0.03s]
2021-01-31 00:35:29.748397 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:35:29.748520 (Thread-1): Began running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:35:29.749384 (Thread-1): 18:35:29 | 2 of 6 START table model dbt.covid_us................................ [RUN]
2021-01-31 00:35:29.749651 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:35:29.749933 (Thread-1): Compiling model.jrtests_learn_dbt.covid_us
2021-01-31 00:35:29.757912 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:35:29.758318 (Thread-1): finished collecting timing info
2021-01-31 00:35:29.789605 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:35:29.790386 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:35:29.790463 (Thread-1): On model.jrtests_learn_dbt.covid_us: BEGIN
2021-01-31 00:35:29.790535 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:35:30.419220 (Thread-1): SQL status: SUCCESS 1 in 0.63 seconds
2021-01-31 00:35:30.419384 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:35:30.419487 (Thread-1): On model.jrtests_learn_dbt.covid_us: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.covid_us"} */


      create or replace transient table analytics.dbt.covid_us  as
      (


 select
   *
 from
  "COVID19_BY_STARSCHEMA"."PUBLIC"."JHU_COVID_19"
 where
    date <=current_date
  and
    country_region = 'United States'


      );
2021-01-31 00:35:35.222155 (Thread-1): SQL status: SUCCESS 1 in 4.80 seconds
2021-01-31 00:35:35.223193 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:35:35.223337 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:35:35.223420 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:35:35.333783 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-31 00:35:35.345910 (Thread-1): finished collecting timing info
2021-01-31 00:35:35.346166 (Thread-1): On model.jrtests_learn_dbt.covid_us: Close
2021-01-31 00:35:35.523683 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df5333b0-488e-40f8-8585-50e69688377b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8165e0>]}
2021-01-31 00:35:35.524625 (Thread-1): 18:35:35 | 2 of 6 OK created table model dbt.covid_us........................... [SUCCESS 1 in 5.77s]
2021-01-31 00:35:35.524737 (Thread-1): Finished running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:35:35.524873 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:35:35.525724 (Thread-1): 18:35:35 | 3 of 6 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-31 00:35:35.525963 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:35:35.526318 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:35:35.533595 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:35:35.533983 (Thread-1): finished collecting timing info
2021-01-31 00:35:35.538589 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:35:35.539526 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:35:35.539603 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-31 00:35:35.539676 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:35:36.147038 (Thread-1): SQL status: SUCCESS 1 in 0.61 seconds
2021-01-31 00:35:36.147197 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:35:36.147279 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate
      );
2021-01-31 00:35:38.704317 (Thread-1): SQL status: SUCCESS 1 in 2.56 seconds
2021-01-31 00:35:38.705186 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:35:38.705307 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:35:38.705373 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:35:38.850731 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-01-31 00:35:38.852766 (Thread-1): finished collecting timing info
2021-01-31 00:35:38.853023 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-31 00:35:39.036345 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df5333b0-488e-40f8-8585-50e69688377b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e93aa00>]}
2021-01-31 00:35:39.037419 (Thread-1): 18:35:39 | 3 of 6 OK created table model dbt.cumulative_orders_by_date.......... [SUCCESS 1 in 3.51s]
2021-01-31 00:35:39.037548 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:35:39.037674 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:35:39.038614 (Thread-1): 18:35:39 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-31 00:35:39.038904 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:35:39.039021 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:35:39.045978 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:35:39.046442 (Thread-1): finished collecting timing info
2021-01-31 00:35:39.050125 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:35:39.051005 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:35:39.051090 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-31 00:35:39.051170 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:35:40.136171 (Thread-1): SQL status: SUCCESS 1 in 1.08 seconds
2021-01-31 00:35:40.136343 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:35:40.136434 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-31 00:35:41.976158 (Thread-1): SQL status: SUCCESS 1 in 1.84 seconds
2021-01-31 00:35:41.977151 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:35:41.977287 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:35:41.977361 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:35:42.110568 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-01-31 00:35:42.112532 (Thread-1): finished collecting timing info
2021-01-31 00:35:42.112764 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-31 00:35:42.298990 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df5333b0-488e-40f8-8585-50e69688377b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e93edc0>]}
2021-01-31 00:35:42.300013 (Thread-1): 18:35:42 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.26s]
2021-01-31 00:35:42.300146 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:35:42.300265 (Thread-1): Began running node model.jrtests_learn_dbt.time
2021-01-31 00:35:42.301106 (Thread-1): 18:35:42 | 5 of 6 START table model dbt.time.................................... [RUN]
2021-01-31 00:35:42.301341 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:35:42.301439 (Thread-1): Compiling model.jrtests_learn_dbt.time
2021-01-31 00:35:42.308059 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:35:42.308479 (Thread-1): finished collecting timing info
2021-01-31 00:35:42.312362 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:35:42.313308 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:35:42.313393 (Thread-1): On model.jrtests_learn_dbt.time: BEGIN
2021-01-31 00:35:42.313474 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:35:43.156939 (Thread-1): SQL status: SUCCESS 1 in 0.84 seconds
2021-01-31 00:35:43.157109 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:35:43.157202 (Thread-1): On model.jrtests_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.time"} */


      create or replace transient table analytics.dbt.time  as
      (


SELECT
  To_time(Concat(t_hour :: VARCHAR, ':', t_minute, ':', t_second)) TIME,
  current_date last_update_date,
  current_time last_update_time
FROM
  "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE
  TIME <= current_time
ORDER  BY TIME DESC


      );
2021-01-31 00:35:44.641682 (Thread-1): SQL status: SUCCESS 1 in 1.48 seconds
2021-01-31 00:35:44.642637 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:35:44.642812 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:35:44.642895 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:35:44.778207 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-01-31 00:35:44.780192 (Thread-1): finished collecting timing info
2021-01-31 00:35:44.780424 (Thread-1): On model.jrtests_learn_dbt.time: Close
2021-01-31 00:35:44.957929 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df5333b0-488e-40f8-8585-50e69688377b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea68ca0>]}
2021-01-31 00:35:44.959003 (Thread-1): 18:35:44 | 5 of 6 OK created table model dbt.time............................... [SUCCESS 1 in 2.66s]
2021-01-31 00:35:44.959132 (Thread-1): Finished running node model.jrtests_learn_dbt.time
2021-01-31 00:35:44.959256 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:35:44.959372 (Thread-1): 18:35:44 | 6 of 6 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-01-31 00:35:44.959479 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:35:44.960364 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:35:44.960545 (MainThread): Using snowflake connection "master".
2021-01-31 00:35:44.960628 (MainThread): On master: BEGIN
2021-01-31 00:35:44.960708 (MainThread): Opening a new connection, currently in state closed
2021-01-31 00:35:45.821795 (MainThread): SQL status: SUCCESS 1 in 0.86 seconds
2021-01-31 00:35:45.821969 (MainThread): On master: COMMIT
2021-01-31 00:35:45.822162 (MainThread): Using snowflake connection "master".
2021-01-31 00:35:45.822234 (MainThread): On master: COMMIT
2021-01-31 00:35:46.279908 (MainThread): SQL status: SUCCESS 1 in 0.46 seconds
2021-01-31 00:35:46.280074 (MainThread): On master: Close
2021-01-31 00:35:46.458412 (MainThread): 18:35:46 | 
2021-01-31 00:35:46.458580 (MainThread): 18:35:46 | Finished running 6 table models in 20.90s.
2021-01-31 00:35:46.458680 (MainThread): Connection 'master' was properly closed.
2021-01-31 00:35:46.458751 (MainThread): Connection 'model.jrtests_learn_dbt.time' was properly closed.
2021-01-31 00:35:46.474619 (MainThread): 
2021-01-31 00:35:46.474747 (MainThread): Completed with 1 error and 0 warnings:
2021-01-31 00:35:46.474850 (MainThread): 
2021-01-31 00:35:46.474945 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:35:46.475031 (MainThread):   Required var 'my_first_variable' not found in config:
2021-01-31 00:35:46.475110 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-01-31 00:35:46.475187 (MainThread):   
2021-01-31 00:35:46.475264 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:35:46.475341 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:35:46.475413 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
2021-01-31 00:35:46.475564 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e93efd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcfc790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e934d60>]}
2021-01-31 00:35:46.475747 (MainThread): Flushing usage events
2021-01-31 00:38:20.211738 (MainThread): Running with dbt=0.18.1
2021-01-31 00:38:20.271306 (MainThread): Loading KWallet
2021-01-31 00:38:20.271755 (MainThread): Loading SecretService
2021-01-31 00:38:20.272120 (MainThread): Loading Windows
2021-01-31 00:38:20.272596 (MainThread): Loading chainer
2021-01-31 00:38:20.272842 (MainThread): Loading macOS
2021-01-31 00:38:20.520923 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-31 00:38:20.521870 (MainThread): Tracking: tracking
2021-01-31 00:38:20.522149 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa3d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc2acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc2a970>]}
2021-01-31 00:38:20.542152 (MainThread): Partial parsing not enabled
2021-01-31 00:38:20.543050 (MainThread): Parsing macros/catalog.sql
2021-01-31 00:38:20.545269 (MainThread): Parsing macros/adapters.sql
2021-01-31 00:38:20.573125 (MainThread): Parsing macros/materializations/merge.sql
2021-01-31 00:38:20.575028 (MainThread): Parsing macros/materializations/view.sql
2021-01-31 00:38:20.576420 (MainThread): Parsing macros/materializations/table.sql
2021-01-31 00:38:20.580418 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-31 00:38:20.590799 (MainThread): Parsing macros/core.sql
2021-01-31 00:38:20.594383 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-31 00:38:20.602509 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-31 00:38:20.604128 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-31 00:38:20.620095 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-31 00:38:20.648479 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-31 00:38:20.667870 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-31 00:38:20.669619 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-31 00:38:20.675330 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-31 00:38:20.688518 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-31 00:38:20.694884 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-31 00:38:20.700833 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-31 00:38:20.705359 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-31 00:38:20.706216 (MainThread): Parsing macros/etc/query.sql
2021-01-31 00:38:20.707182 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-31 00:38:20.708705 (MainThread): Parsing macros/etc/datetime.sql
2021-01-31 00:38:20.717075 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-31 00:38:20.718907 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-31 00:38:20.720480 (MainThread): Parsing macros/adapters/common.sql
2021-01-31 00:38:20.760444 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-31 00:38:20.762182 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-31 00:38:20.763580 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-31 00:38:20.765187 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-31 00:38:20.772949 (MainThread): Partial parsing not enabled
2021-01-31 00:38:20.807750 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:38:20.828358 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:38:20.838663 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:38:20.850176 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:38:20.864470 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:38:20.875052 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:38:21.118323 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jrtests_learn_dbt.example.vars

2021-01-31 00:38:21.180551 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-31 00:38:21.181470 (MainThread): 
2021-01-31 00:38:21.181715 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:38:21.187921 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-31 00:38:21.199695 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-31 00:38:21.199789 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-31 00:38:21.199865 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-31 00:38:22.284889 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.09 seconds
2021-01-31 00:38:22.289524 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-31 00:38:22.491983 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-31 00:38:22.498578 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-31 00:38:22.498689 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-31 00:38:22.498780 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-31 00:38:23.318330 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.82 seconds
2021-01-31 00:38:23.326111 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-31 00:38:23.501306 (MainThread): Using snowflake connection "master".
2021-01-31 00:38:23.501492 (MainThread): On master: BEGIN
2021-01-31 00:38:23.501627 (MainThread): Opening a new connection, currently in state init
2021-01-31 00:38:24.041501 (MainThread): SQL status: SUCCESS 1 in 0.54 seconds
2021-01-31 00:38:24.041777 (MainThread): On master: COMMIT
2021-01-31 00:38:24.042035 (MainThread): Using snowflake connection "master".
2021-01-31 00:38:24.042183 (MainThread): On master: COMMIT
2021-01-31 00:38:24.289458 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-31 00:38:24.289737 (MainThread): On master: Close
2021-01-31 00:38:24.456168 (MainThread): 18:38:24 | Concurrency: 1 threads (target='dev')
2021-01-31 00:38:24.456404 (MainThread): 18:38:24 | 
2021-01-31 00:38:24.458208 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:38:24.459646 (Thread-1): 18:38:24 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-01-31 00:38:24.459951 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:38:24.460082 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:38:24.479792 (Thread-1): finished collecting timing info
2021-01-31 00:38:24.480168 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 270, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/compile.py", line 23, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/compilation.py", line 479, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/compilation.py", line 385, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 19, in top-level template code
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/context/base.py", line 148, in __call__
    return self.get_missing_var(var_name)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/context/base.py", line 129, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:38:24.481745 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3925867-d248-47a5-a35a-59408b75aa88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a4a280>]}
2021-01-31 00:38:24.482711 (Thread-1): 18:38:24 | 1 of 6 ERROR creating table model dbt.first_model.................... [ERROR in 0.02s]
2021-01-31 00:38:24.482830 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:38:24.482948 (Thread-1): Began running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:38:24.483951 (Thread-1): 18:38:24 | 2 of 6 START table model dbt.covid_us................................ [RUN]
2021-01-31 00:38:24.484276 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:38:24.484376 (Thread-1): Compiling model.jrtests_learn_dbt.covid_us
2021-01-31 00:38:24.491994 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:38:24.492580 (Thread-1): finished collecting timing info
2021-01-31 00:38:24.522961 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:38:24.523674 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:38:24.523757 (Thread-1): On model.jrtests_learn_dbt.covid_us: BEGIN
2021-01-31 00:38:24.523834 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:38:25.342122 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-01-31 00:38:25.342382 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:38:25.342539 (Thread-1): On model.jrtests_learn_dbt.covid_us: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.covid_us"} */


      create or replace transient table analytics.dbt.covid_us  as
      (


 select
   *
 from
  "COVID19_BY_STARSCHEMA"."PUBLIC"."JHU_COVID_19"
 where
    date <=current_date
  and
    country_region = 'United States'


      );
2021-01-31 00:38:29.711062 (Thread-1): SQL status: SUCCESS 1 in 4.37 seconds
2021-01-31 00:38:29.712932 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:38:29.713156 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:38:29.713282 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:38:29.851019 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-01-31 00:38:29.866228 (Thread-1): finished collecting timing info
2021-01-31 00:38:29.866507 (Thread-1): On model.jrtests_learn_dbt.covid_us: Close
2021-01-31 00:38:30.020955 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3925867-d248-47a5-a35a-59408b75aa88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a56d90>]}
2021-01-31 00:38:30.022236 (Thread-1): 18:38:30 | 2 of 6 OK created table model dbt.covid_us........................... [SUCCESS 1 in 5.54s]
2021-01-31 00:38:30.022396 (Thread-1): Finished running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:38:30.022545 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:38:30.023700 (Thread-1): 18:38:30 | 3 of 6 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-31 00:38:30.023985 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:38:30.024106 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:38:30.031224 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:38:30.031563 (Thread-1): finished collecting timing info
2021-01-31 00:38:30.035972 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:38:30.036841 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:38:30.036932 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-31 00:38:30.037017 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:38:30.899280 (Thread-1): SQL status: SUCCESS 1 in 0.86 seconds
2021-01-31 00:38:30.899540 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:38:30.899696 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate
      );
2021-01-31 00:38:32.989328 (Thread-1): SQL status: SUCCESS 1 in 2.09 seconds
2021-01-31 00:38:32.990936 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:38:32.991183 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:38:32.991309 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:38:33.091206 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2021-01-31 00:38:33.094338 (Thread-1): finished collecting timing info
2021-01-31 00:38:33.094678 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-31 00:38:33.261479 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3925867-d248-47a5-a35a-59408b75aa88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11074c280>]}
2021-01-31 00:38:33.262987 (Thread-1): 18:38:33 | 3 of 6 OK created table model dbt.cumulative_orders_by_date.......... [SUCCESS 1 in 3.24s]
2021-01-31 00:38:33.263174 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:38:33.263356 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:38:33.264558 (Thread-1): 18:38:33 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-31 00:38:33.264965 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:38:33.265099 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:38:33.272927 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:38:33.273298 (Thread-1): finished collecting timing info
2021-01-31 00:38:33.277389 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:38:33.278321 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:38:33.278417 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-31 00:38:33.278507 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:38:33.894635 (Thread-1): SQL status: SUCCESS 1 in 0.62 seconds
2021-01-31 00:38:33.894897 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:38:33.895055 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-31 00:38:35.646563 (Thread-1): SQL status: SUCCESS 1 in 1.75 seconds
2021-01-31 00:38:35.648040 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:38:35.648243 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:38:35.648347 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:38:35.784526 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-01-31 00:38:35.787469 (Thread-1): finished collecting timing info
2021-01-31 00:38:35.787809 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-31 00:38:35.983700 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3925867-d248-47a5-a35a-59408b75aa88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ab6a30>]}
2021-01-31 00:38:35.985267 (Thread-1): 18:38:35 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.72s]
2021-01-31 00:38:35.985455 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:38:35.985638 (Thread-1): Began running node model.jrtests_learn_dbt.time
2021-01-31 00:38:35.986860 (Thread-1): 18:38:35 | 5 of 6 START table model dbt.time.................................... [RUN]
2021-01-31 00:38:35.987255 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:38:35.987390 (Thread-1): Compiling model.jrtests_learn_dbt.time
2021-01-31 00:38:35.995436 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:38:35.995821 (Thread-1): finished collecting timing info
2021-01-31 00:38:35.999772 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:38:36.000627 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:38:36.000720 (Thread-1): On model.jrtests_learn_dbt.time: BEGIN
2021-01-31 00:38:36.000808 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:38:36.817324 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-01-31 00:38:36.817587 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:38:36.817743 (Thread-1): On model.jrtests_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.time"} */


      create or replace transient table analytics.dbt.time  as
      (


SELECT
  To_time(Concat(t_hour :: VARCHAR, ':', t_minute, ':', t_second)) TIME,
  current_date last_update_date,
  current_time last_update_time
FROM
  "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE
  TIME <= current_time
ORDER  BY TIME DESC


      );
2021-01-31 00:38:38.108198 (Thread-1): SQL status: SUCCESS 1 in 1.29 seconds
2021-01-31 00:38:38.109101 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:38:38.109249 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:38:38.109333 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:38:38.311196 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-31 00:38:38.314303 (Thread-1): finished collecting timing info
2021-01-31 00:38:38.314640 (Thread-1): On model.jrtests_learn_dbt.time: Close
2021-01-31 00:38:38.481026 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3925867-d248-47a5-a35a-59408b75aa88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ab6040>]}
2021-01-31 00:38:38.482334 (Thread-1): 18:38:38 | 5 of 6 OK created table model dbt.time............................... [SUCCESS 1 in 2.49s]
2021-01-31 00:38:38.482533 (Thread-1): Finished running node model.jrtests_learn_dbt.time
2021-01-31 00:38:38.482713 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:38:38.482985 (Thread-1): 18:38:38 | 6 of 6 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-01-31 00:38:38.483170 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:38:38.484203 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:38:38.484424 (MainThread): Using snowflake connection "master".
2021-01-31 00:38:38.484521 (MainThread): On master: BEGIN
2021-01-31 00:38:38.484620 (MainThread): Opening a new connection, currently in state closed
2021-01-31 00:38:39.151024 (MainThread): SQL status: SUCCESS 1 in 0.67 seconds
2021-01-31 00:38:39.151246 (MainThread): On master: COMMIT
2021-01-31 00:38:39.151448 (MainThread): Using snowflake connection "master".
2021-01-31 00:38:39.151570 (MainThread): On master: COMMIT
2021-01-31 00:38:39.543015 (MainThread): SQL status: SUCCESS 1 in 0.39 seconds
2021-01-31 00:38:39.543291 (MainThread): On master: Close
2021-01-31 00:38:39.708077 (MainThread): 18:38:39 | 
2021-01-31 00:38:39.708301 (MainThread): 18:38:39 | Finished running 6 table models in 18.53s.
2021-01-31 00:38:39.708457 (MainThread): Connection 'master' was properly closed.
2021-01-31 00:38:39.708573 (MainThread): Connection 'model.jrtests_learn_dbt.time' was properly closed.
2021-01-31 00:38:39.726293 (MainThread): 
2021-01-31 00:38:39.726416 (MainThread): Completed with 1 error and 0 warnings:
2021-01-31 00:38:39.726523 (MainThread): 
2021-01-31 00:38:39.726625 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:38:39.726716 (MainThread):   Required var 'my_first_variable' not found in config:
2021-01-31 00:38:39.726800 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-01-31 00:38:39.726894 (MainThread):   
2021-01-31 00:38:39.726976 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:38:39.727058 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:38:39.727150 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
2021-01-31 00:38:39.727299 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109a46a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109a48b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109a4070>]}
2021-01-31 00:38:39.727470 (MainThread): Flushing usage events
2021-01-31 00:40:28.873037 (MainThread): Running with dbt=0.18.1
2021-01-31 00:40:28.934898 (MainThread): Loading KWallet
2021-01-31 00:40:28.935359 (MainThread): Loading SecretService
2021-01-31 00:40:28.935737 (MainThread): Loading Windows
2021-01-31 00:40:28.936234 (MainThread): Loading chainer
2021-01-31 00:40:28.936488 (MainThread): Loading macOS
2021-01-31 00:40:29.187631 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-31 00:40:29.188620 (MainThread): Tracking: tracking
2021-01-31 00:40:29.188937 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7ba100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9a7c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9a78e0>]}
2021-01-31 00:40:29.209311 (MainThread): Partial parsing not enabled
2021-01-31 00:40:29.210254 (MainThread): Parsing macros/catalog.sql
2021-01-31 00:40:29.212856 (MainThread): Parsing macros/adapters.sql
2021-01-31 00:40:29.239987 (MainThread): Parsing macros/materializations/merge.sql
2021-01-31 00:40:29.241906 (MainThread): Parsing macros/materializations/view.sql
2021-01-31 00:40:29.243269 (MainThread): Parsing macros/materializations/table.sql
2021-01-31 00:40:29.246923 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-31 00:40:29.257015 (MainThread): Parsing macros/core.sql
2021-01-31 00:40:29.260639 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-31 00:40:29.268747 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-31 00:40:29.270370 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-31 00:40:29.286054 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-31 00:40:29.314001 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-31 00:40:29.333879 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-31 00:40:29.335571 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-31 00:40:29.341380 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-31 00:40:29.354261 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-31 00:40:29.360759 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-31 00:40:29.366685 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-31 00:40:29.374308 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-31 00:40:29.375539 (MainThread): Parsing macros/etc/query.sql
2021-01-31 00:40:29.376627 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-31 00:40:29.378416 (MainThread): Parsing macros/etc/datetime.sql
2021-01-31 00:40:29.387689 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-31 00:40:29.389558 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-31 00:40:29.391303 (MainThread): Parsing macros/adapters/common.sql
2021-01-31 00:40:29.430839 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-31 00:40:29.432602 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-31 00:40:29.434023 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-31 00:40:29.435609 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-31 00:40:29.442955 (MainThread): Partial parsing not enabled
2021-01-31 00:40:29.478128 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:40:29.498824 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:40:29.509265 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:40:29.519722 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:40:29.533935 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:40:29.544778 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:40:29.783058 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jrtests_learn_dbt.example.vars

2021-01-31 00:40:29.845074 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-31 00:40:29.845939 (MainThread): 
2021-01-31 00:40:29.846181 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:40:29.852626 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-31 00:40:29.864043 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-31 00:40:29.864124 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-31 00:40:29.864195 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-31 00:40:30.867387 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.00 seconds
2021-01-31 00:40:30.872252 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-31 00:40:31.059189 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-31 00:40:31.065937 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-31 00:40:31.066044 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-31 00:40:31.066136 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-31 00:40:31.907765 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.84 seconds
2021-01-31 00:40:31.914861 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-31 00:40:32.095916 (MainThread): Using snowflake connection "master".
2021-01-31 00:40:32.096107 (MainThread): On master: BEGIN
2021-01-31 00:40:32.096242 (MainThread): Opening a new connection, currently in state init
2021-01-31 00:40:32.658404 (MainThread): SQL status: SUCCESS 1 in 0.56 seconds
2021-01-31 00:40:32.658675 (MainThread): On master: COMMIT
2021-01-31 00:40:32.658933 (MainThread): Using snowflake connection "master".
2021-01-31 00:40:32.659083 (MainThread): On master: COMMIT
2021-01-31 00:40:32.891799 (MainThread): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-31 00:40:32.892071 (MainThread): On master: Close
2021-01-31 00:40:33.067478 (MainThread): 18:40:33 | Concurrency: 1 threads (target='dev')
2021-01-31 00:40:33.067707 (MainThread): 18:40:33 | 
2021-01-31 00:40:33.069513 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:40:33.070966 (Thread-1): 18:40:33 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-01-31 00:40:33.071268 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:40:33.071398 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:40:33.090920 (Thread-1): finished collecting timing info
2021-01-31 00:40:33.091298 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 270, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/compile.py", line 23, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/compilation.py", line 479, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/compilation.py", line 385, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 19, in top-level template code
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/context/base.py", line 148, in __call__
    return self.get_missing_var(var_name)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/context/base.py", line 129, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:40:33.092893 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e834d584-4fd8-471e-b34e-2ee55a28a04b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6a2910>]}
2021-01-31 00:40:33.093878 (Thread-1): 18:40:33 | 1 of 6 ERROR creating table model dbt.first_model.................... [ERROR in 0.02s]
2021-01-31 00:40:33.093997 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:40:33.094117 (Thread-1): Began running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:40:33.094996 (Thread-1): 18:40:33 | 2 of 6 START table model dbt.covid_us................................ [RUN]
2021-01-31 00:40:33.095233 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:40:33.095334 (Thread-1): Compiling model.jrtests_learn_dbt.covid_us
2021-01-31 00:40:33.103016 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:40:33.103632 (Thread-1): finished collecting timing info
2021-01-31 00:40:33.134475 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:40:33.135282 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:40:33.135378 (Thread-1): On model.jrtests_learn_dbt.covid_us: BEGIN
2021-01-31 00:40:33.135466 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:40:34.015067 (Thread-1): SQL status: SUCCESS 1 in 0.88 seconds
2021-01-31 00:40:34.015320 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:40:34.015472 (Thread-1): On model.jrtests_learn_dbt.covid_us: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.covid_us"} */


      create or replace transient table analytics.dbt.covid_us  as
      (


 select
   *
 from
  "COVID19_BY_STARSCHEMA"."PUBLIC"."JHU_COVID_19"
 where
    date <=current_date
  and
    country_region = 'United States'


      );
2021-01-31 00:40:38.952977 (Thread-1): SQL status: SUCCESS 1 in 4.94 seconds
2021-01-31 00:40:38.954371 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:40:38.954582 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:40:38.954703 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:40:39.314629 (Thread-1): SQL status: SUCCESS 1 in 0.36 seconds
2021-01-31 00:40:39.328539 (Thread-1): finished collecting timing info
2021-01-31 00:40:39.328778 (Thread-1): On model.jrtests_learn_dbt.covid_us: Close
2021-01-31 00:40:39.507709 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e834d584-4fd8-471e-b34e-2ee55a28a04b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6b64c0>]}
2021-01-31 00:40:39.509246 (Thread-1): 18:40:39 | 2 of 6 OK created table model dbt.covid_us........................... [SUCCESS 1 in 6.41s]
2021-01-31 00:40:39.509434 (Thread-1): Finished running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:40:39.509618 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:40:39.511008 (Thread-1): 18:40:39 | 3 of 6 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-31 00:40:39.511364 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:40:39.511546 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:40:39.519836 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:40:39.520180 (Thread-1): finished collecting timing info
2021-01-31 00:40:39.524694 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:40:39.525579 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:40:39.525666 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-31 00:40:39.525749 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:40:40.079301 (Thread-1): SQL status: SUCCESS 1 in 0.55 seconds
2021-01-31 00:40:40.079550 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:40:40.079697 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate
      );
2021-01-31 00:40:42.315740 (Thread-1): SQL status: SUCCESS 1 in 2.24 seconds
2021-01-31 00:40:42.317312 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:40:42.317586 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:40:42.317706 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:40:42.442166 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-31 00:40:42.445246 (Thread-1): finished collecting timing info
2021-01-31 00:40:42.445571 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-31 00:40:42.621490 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e834d584-4fd8-471e-b34e-2ee55a28a04b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7abb20>]}
2021-01-31 00:40:42.623036 (Thread-1): 18:40:42 | 3 of 6 OK created table model dbt.cumulative_orders_by_date.......... [SUCCESS 1 in 3.11s]
2021-01-31 00:40:42.623222 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:40:42.623403 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:40:42.624678 (Thread-1): 18:40:42 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-31 00:40:42.624962 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:40:42.625078 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:40:42.632477 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:40:42.632813 (Thread-1): finished collecting timing info
2021-01-31 00:40:42.636856 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:40:42.637777 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:40:42.637865 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-31 00:40:42.637948 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:40:43.635245 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-01-31 00:40:43.635490 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:40:43.635638 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-31 00:40:45.300463 (Thread-1): SQL status: SUCCESS 1 in 1.66 seconds
2021-01-31 00:40:45.301842 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:40:45.302049 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:40:45.302168 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:40:45.410442 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-31 00:40:45.413544 (Thread-1): finished collecting timing info
2021-01-31 00:40:45.413878 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-31 00:40:45.575991 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e834d584-4fd8-471e-b34e-2ee55a28a04b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5f7190>]}
2021-01-31 00:40:45.577563 (Thread-1): 18:40:45 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.95s]
2021-01-31 00:40:45.577749 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:40:45.577932 (Thread-1): Began running node model.jrtests_learn_dbt.time
2021-01-31 00:40:45.579086 (Thread-1): 18:40:45 | 5 of 6 START table model dbt.time.................................... [RUN]
2021-01-31 00:40:45.579471 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:40:45.579597 (Thread-1): Compiling model.jrtests_learn_dbt.time
2021-01-31 00:40:45.587665 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:40:45.588020 (Thread-1): finished collecting timing info
2021-01-31 00:40:45.592013 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:40:45.592917 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:40:45.593009 (Thread-1): On model.jrtests_learn_dbt.time: BEGIN
2021-01-31 00:40:45.593098 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:40:46.453083 (Thread-1): SQL status: SUCCESS 1 in 0.86 seconds
2021-01-31 00:40:46.453332 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:40:46.453479 (Thread-1): On model.jrtests_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.time"} */


      create or replace transient table analytics.dbt.time  as
      (


SELECT
  To_time(Concat(t_hour :: VARCHAR, ':', t_minute, ':', t_second)) TIME,
  current_date last_update_date,
  current_time last_update_time
FROM
  "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE
  TIME <= current_time
ORDER  BY TIME DESC


      );
2021-01-31 00:40:47.960612 (Thread-1): SQL status: SUCCESS 1 in 1.51 seconds
2021-01-31 00:40:47.962070 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:40:47.962277 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:40:47.962397 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:40:48.105446 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-01-31 00:40:48.108660 (Thread-1): finished collecting timing info
2021-01-31 00:40:48.109002 (Thread-1): On model.jrtests_learn_dbt.time: Close
2021-01-31 00:40:48.279206 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e834d584-4fd8-471e-b34e-2ee55a28a04b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6a2bb0>]}
2021-01-31 00:40:48.280743 (Thread-1): 18:40:48 | 5 of 6 OK created table model dbt.time............................... [SUCCESS 1 in 2.70s]
2021-01-31 00:40:48.280936 (Thread-1): Finished running node model.jrtests_learn_dbt.time
2021-01-31 00:40:48.281123 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:40:48.281300 (Thread-1): 18:40:48 | 6 of 6 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-01-31 00:40:48.281465 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:40:48.282705 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:40:48.282960 (MainThread): Using snowflake connection "master".
2021-01-31 00:40:48.283082 (MainThread): On master: BEGIN
2021-01-31 00:40:48.283203 (MainThread): Opening a new connection, currently in state closed
2021-01-31 00:40:49.154206 (MainThread): SQL status: SUCCESS 1 in 0.87 seconds
2021-01-31 00:40:49.154479 (MainThread): On master: COMMIT
2021-01-31 00:40:49.154729 (MainThread): Using snowflake connection "master".
2021-01-31 00:40:49.154877 (MainThread): On master: COMMIT
2021-01-31 00:40:49.389697 (MainThread): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-31 00:40:49.389978 (MainThread): On master: Close
2021-01-31 00:40:49.560066 (MainThread): 18:40:49 | 
2021-01-31 00:40:49.560297 (MainThread): 18:40:49 | Finished running 6 table models in 19.71s.
2021-01-31 00:40:49.560525 (MainThread): Connection 'master' was properly closed.
2021-01-31 00:40:49.560664 (MainThread): Connection 'model.jrtests_learn_dbt.time' was properly closed.
2021-01-31 00:40:49.578048 (MainThread): 
2021-01-31 00:40:49.578171 (MainThread): Completed with 1 error and 0 warnings:
2021-01-31 00:40:49.578276 (MainThread): 
2021-01-31 00:40:49.578376 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:40:49.578465 (MainThread):   Required var 'my_first_variable' not found in config:
2021-01-31 00:40:49.578548 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-01-31 00:40:49.578628 (MainThread):   
2021-01-31 00:40:49.578706 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:40:49.578784 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:40:49.578873 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
2021-01-31 00:40:49.579018 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4f8d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4649d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5f48e0>]}
2021-01-31 00:40:49.579187 (MainThread): Flushing usage events
2021-01-31 00:42:59.525678 (MainThread): Running with dbt=0.18.1
2021-01-31 00:42:59.586418 (MainThread): Loading KWallet
2021-01-31 00:42:59.587089 (MainThread): Loading SecretService
2021-01-31 00:42:59.587480 (MainThread): Loading Windows
2021-01-31 00:42:59.587985 (MainThread): Loading chainer
2021-01-31 00:42:59.588237 (MainThread): Loading macOS
2021-01-31 00:42:59.836491 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-31 00:42:59.837384 (MainThread): Tracking: tracking
2021-01-31 00:42:59.837665 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098de370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109acbc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109acb8e0>]}
2021-01-31 00:42:59.858929 (MainThread): Partial parsing not enabled
2021-01-31 00:42:59.859873 (MainThread): Parsing macros/catalog.sql
2021-01-31 00:42:59.862197 (MainThread): Parsing macros/adapters.sql
2021-01-31 00:42:59.888786 (MainThread): Parsing macros/materializations/merge.sql
2021-01-31 00:42:59.890616 (MainThread): Parsing macros/materializations/view.sql
2021-01-31 00:42:59.891963 (MainThread): Parsing macros/materializations/table.sql
2021-01-31 00:42:59.895695 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-31 00:42:59.905613 (MainThread): Parsing macros/core.sql
2021-01-31 00:42:59.909087 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-31 00:42:59.917068 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-31 00:42:59.918670 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-31 00:42:59.934617 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-31 00:42:59.962197 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-31 00:42:59.984890 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-31 00:42:59.986722 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-31 00:42:59.993289 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-31 00:43:00.007397 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-31 00:43:00.013976 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-31 00:43:00.020010 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-31 00:43:00.024772 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-31 00:43:00.025670 (MainThread): Parsing macros/etc/query.sql
2021-01-31 00:43:00.026687 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-31 00:43:00.028733 (MainThread): Parsing macros/etc/datetime.sql
2021-01-31 00:43:00.037102 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-31 00:43:00.038973 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-31 00:43:00.040572 (MainThread): Parsing macros/adapters/common.sql
2021-01-31 00:43:00.080850 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-31 00:43:00.082621 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-31 00:43:00.084061 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-31 00:43:00.085659 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-31 00:43:00.092798 (MainThread): Partial parsing not enabled
2021-01-31 00:43:00.127213 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:43:00.148412 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:43:00.158657 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:43:00.169081 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:43:00.183174 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:43:00.193973 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:43:00.431199 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jrtests_learn_dbt.example.vars

2021-01-31 00:43:00.497263 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-31 00:43:00.498159 (MainThread): 
2021-01-31 00:43:00.498411 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:43:00.504627 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-31 00:43:00.516531 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-31 00:43:00.516616 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-31 00:43:00.516692 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-31 00:43:01.608554 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.09 seconds
2021-01-31 00:43:01.613460 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-31 00:43:01.810303 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-31 00:43:01.816856 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-31 00:43:01.816957 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-31 00:43:01.817043 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-31 00:43:02.690271 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.87 seconds
2021-01-31 00:43:02.698596 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-31 00:43:02.879897 (MainThread): Using snowflake connection "master".
2021-01-31 00:43:02.880086 (MainThread): On master: BEGIN
2021-01-31 00:43:02.880218 (MainThread): Opening a new connection, currently in state init
2021-01-31 00:43:03.898285 (MainThread): SQL status: SUCCESS 1 in 1.02 seconds
2021-01-31 00:43:03.898558 (MainThread): On master: COMMIT
2021-01-31 00:43:03.898812 (MainThread): Using snowflake connection "master".
2021-01-31 00:43:03.898958 (MainThread): On master: COMMIT
2021-01-31 00:43:04.130092 (MainThread): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-31 00:43:04.130369 (MainThread): On master: Close
2021-01-31 00:43:04.328874 (MainThread): 18:43:04 | Concurrency: 1 threads (target='dev')
2021-01-31 00:43:04.329108 (MainThread): 18:43:04 | 
2021-01-31 00:43:04.330768 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:43:04.332060 (Thread-1): 18:43:04 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-01-31 00:43:04.332363 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:43:04.332492 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:43:04.352300 (Thread-1): finished collecting timing info
2021-01-31 00:43:04.352673 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 270, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/compile.py", line 23, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/compilation.py", line 479, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/compilation.py", line 385, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 19, in top-level template code
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/context/base.py", line 148, in __call__
    return self.get_missing_var(var_name)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/context/base.py", line 129, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:43:04.354264 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1236af7f-ff11-4d55-815c-e82bc8084fc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a85d2b0>]}
2021-01-31 00:43:04.355237 (Thread-1): 18:43:04 | 1 of 6 ERROR creating table model dbt.first_model.................... [ERROR in 0.02s]
2021-01-31 00:43:04.355355 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:43:04.355471 (Thread-1): Began running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:43:04.356353 (Thread-1): 18:43:04 | 2 of 6 START table model dbt.covid_us................................ [RUN]
2021-01-31 00:43:04.356590 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:43:04.356689 (Thread-1): Compiling model.jrtests_learn_dbt.covid_us
2021-01-31 00:43:04.364524 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:43:04.365118 (Thread-1): finished collecting timing info
2021-01-31 00:43:04.395697 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:43:04.396530 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:43:04.396617 (Thread-1): On model.jrtests_learn_dbt.covid_us: BEGIN
2021-01-31 00:43:04.396697 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:43:04.941821 (Thread-1): SQL status: SUCCESS 1 in 0.55 seconds
2021-01-31 00:43:04.942076 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:43:04.942223 (Thread-1): On model.jrtests_learn_dbt.covid_us: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.covid_us"} */


      create or replace transient table analytics.dbt.covid_us  as
      (


 select
   *
 from
  "COVID19_BY_STARSCHEMA"."PUBLIC"."JHU_COVID_19"
 where
    date <=current_date
  and
    country_region = 'United States'


      );
2021-01-31 00:43:09.481369 (Thread-1): SQL status: SUCCESS 1 in 4.54 seconds
2021-01-31 00:43:09.483103 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:43:09.483317 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:43:09.483440 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:43:09.597561 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-31 00:43:09.611472 (Thread-1): finished collecting timing info
2021-01-31 00:43:09.611711 (Thread-1): On model.jrtests_learn_dbt.covid_us: Close
2021-01-31 00:43:09.767820 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1236af7f-ff11-4d55-815c-e82bc8084fc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a741a90>]}
2021-01-31 00:43:09.769298 (Thread-1): 18:43:09 | 2 of 6 OK created table model dbt.covid_us........................... [SUCCESS 1 in 5.41s]
2021-01-31 00:43:09.769448 (Thread-1): Finished running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:43:09.769593 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:43:09.770744 (Thread-1): 18:43:09 | 3 of 6 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-31 00:43:09.771035 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:43:09.771157 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:43:09.778598 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:43:09.778953 (Thread-1): finished collecting timing info
2021-01-31 00:43:09.783454 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:43:09.784326 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:43:09.784417 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-31 00:43:09.784504 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:43:10.456901 (Thread-1): SQL status: SUCCESS 1 in 0.67 seconds
2021-01-31 00:43:10.457154 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:43:10.457305 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate
      );
2021-01-31 00:43:12.553970 (Thread-1): SQL status: SUCCESS 1 in 2.10 seconds
2021-01-31 00:43:12.555547 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:43:12.555819 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:43:12.555941 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:43:12.649976 (Thread-1): SQL status: SUCCESS 1 in 0.09 seconds
2021-01-31 00:43:12.653090 (Thread-1): finished collecting timing info
2021-01-31 00:43:12.653436 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-31 00:43:12.843593 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1236af7f-ff11-4d55-815c-e82bc8084fc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a612670>]}
2021-01-31 00:43:12.845174 (Thread-1): 18:43:12 | 3 of 6 OK created table model dbt.cumulative_orders_by_date.......... [SUCCESS 1 in 3.07s]
2021-01-31 00:43:12.845363 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:43:12.845547 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:43:12.846838 (Thread-1): 18:43:12 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-31 00:43:12.847123 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:43:12.847242 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:43:12.854900 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:43:12.855234 (Thread-1): finished collecting timing info
2021-01-31 00:43:12.859278 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:43:12.860198 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:43:12.860288 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-31 00:43:12.860374 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:43:13.726449 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-01-31 00:43:13.726706 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:43:13.726854 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-31 00:43:15.420638 (Thread-1): SQL status: SUCCESS 1 in 1.69 seconds
2021-01-31 00:43:15.422214 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:43:15.422501 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:43:15.422621 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:43:15.523028 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2021-01-31 00:43:15.526165 (Thread-1): finished collecting timing info
2021-01-31 00:43:15.526500 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-31 00:43:15.682569 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1236af7f-ff11-4d55-815c-e82bc8084fc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a638910>]}
2021-01-31 00:43:15.683865 (Thread-1): 18:43:15 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.84s]
2021-01-31 00:43:15.684029 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:43:15.684182 (Thread-1): Began running node model.jrtests_learn_dbt.time
2021-01-31 00:43:15.685263 (Thread-1): 18:43:15 | 5 of 6 START table model dbt.time.................................... [RUN]
2021-01-31 00:43:15.685641 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:43:15.685776 (Thread-1): Compiling model.jrtests_learn_dbt.time
2021-01-31 00:43:15.693796 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:43:15.694140 (Thread-1): finished collecting timing info
2021-01-31 00:43:15.698177 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:43:15.699036 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:43:15.699127 (Thread-1): On model.jrtests_learn_dbt.time: BEGIN
2021-01-31 00:43:15.699216 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:43:16.594769 (Thread-1): SQL status: SUCCESS 1 in 0.90 seconds
2021-01-31 00:43:16.595062 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:43:16.595232 (Thread-1): On model.jrtests_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.time"} */


      create or replace transient table analytics.dbt.time  as
      (


SELECT
  To_time(Concat(t_hour :: VARCHAR, ':', t_minute, ':', t_second)) TIME,
  current_date last_update_date,
  current_time last_update_time
FROM
  "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE
  TIME <= current_time
ORDER  BY TIME DESC


      );
2021-01-31 00:43:18.083794 (Thread-1): SQL status: SUCCESS 1 in 1.49 seconds
2021-01-31 00:43:18.085361 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:43:18.085633 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:43:18.085752 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:43:18.205976 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-31 00:43:18.209084 (Thread-1): finished collecting timing info
2021-01-31 00:43:18.209414 (Thread-1): On model.jrtests_learn_dbt.time: Close
2021-01-31 00:43:18.378326 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1236af7f-ff11-4d55-815c-e82bc8084fc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a726ac0>]}
2021-01-31 00:43:18.379879 (Thread-1): 18:43:18 | 5 of 6 OK created table model dbt.time............................... [SUCCESS 1 in 2.69s]
2021-01-31 00:43:18.380064 (Thread-1): Finished running node model.jrtests_learn_dbt.time
2021-01-31 00:43:18.380245 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:43:18.380417 (Thread-1): 18:43:18 | 6 of 6 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-01-31 00:43:18.380693 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:43:18.381776 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:43:18.381993 (MainThread): Using snowflake connection "master".
2021-01-31 00:43:18.382097 (MainThread): On master: BEGIN
2021-01-31 00:43:18.382201 (MainThread): Opening a new connection, currently in state closed
2021-01-31 00:43:19.253586 (MainThread): SQL status: SUCCESS 1 in 0.87 seconds
2021-01-31 00:43:19.253857 (MainThread): On master: COMMIT
2021-01-31 00:43:19.254106 (MainThread): Using snowflake connection "master".
2021-01-31 00:43:19.254251 (MainThread): On master: COMMIT
2021-01-31 00:43:19.721848 (MainThread): SQL status: SUCCESS 1 in 0.47 seconds
2021-01-31 00:43:19.722116 (MainThread): On master: Close
2021-01-31 00:43:19.904572 (MainThread): 18:43:19 | 
2021-01-31 00:43:19.904803 (MainThread): 18:43:19 | Finished running 6 table models in 19.41s.
2021-01-31 00:43:19.904956 (MainThread): Connection 'master' was properly closed.
2021-01-31 00:43:19.905067 (MainThread): Connection 'model.jrtests_learn_dbt.time' was properly closed.
2021-01-31 00:43:19.923609 (MainThread): 
2021-01-31 00:43:19.923730 (MainThread): Completed with 1 error and 0 warnings:
2021-01-31 00:43:19.923835 (MainThread): 
2021-01-31 00:43:19.923935 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:43:19.924029 (MainThread):   Required var 'my_first_variable' not found in config:
2021-01-31 00:43:19.924110 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-01-31 00:43:19.924191 (MainThread):   
2021-01-31 00:43:19.924271 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:43:19.924350 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:43:19.924438 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
2021-01-31 00:43:19.924598 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7177c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7173a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a717820>]}
2021-01-31 00:43:19.924765 (MainThread): Flushing usage events
2021-01-31 00:44:28.441967 (MainThread): Running with dbt=0.18.1
2021-01-31 00:44:28.502580 (MainThread): Loading KWallet
2021-01-31 00:44:28.503028 (MainThread): Loading SecretService
2021-01-31 00:44:28.503388 (MainThread): Loading Windows
2021-01-31 00:44:28.503868 (MainThread): Loading chainer
2021-01-31 00:44:28.504115 (MainThread): Loading macOS
2021-01-31 00:44:28.751907 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-31 00:44:28.752885 (MainThread): Tracking: tracking
2021-01-31 00:44:28.753148 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0753a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b262c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2628e0>]}
2021-01-31 00:44:28.772932 (MainThread): Partial parsing not enabled
2021-01-31 00:44:28.773823 (MainThread): Parsing macros/catalog.sql
2021-01-31 00:44:28.775944 (MainThread): Parsing macros/adapters.sql
2021-01-31 00:44:28.803174 (MainThread): Parsing macros/materializations/merge.sql
2021-01-31 00:44:28.805059 (MainThread): Parsing macros/materializations/view.sql
2021-01-31 00:44:28.806450 (MainThread): Parsing macros/materializations/table.sql
2021-01-31 00:44:28.810161 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-31 00:44:28.820554 (MainThread): Parsing macros/core.sql
2021-01-31 00:44:28.823915 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-31 00:44:28.832088 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-31 00:44:28.833656 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-31 00:44:28.849382 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-31 00:44:28.876671 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-31 00:44:28.896532 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-31 00:44:28.898203 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-31 00:44:28.903827 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-31 00:44:28.917064 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-31 00:44:28.923246 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-31 00:44:28.929437 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-31 00:44:28.933897 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-31 00:44:28.934745 (MainThread): Parsing macros/etc/query.sql
2021-01-31 00:44:28.935687 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-31 00:44:28.937199 (MainThread): Parsing macros/etc/datetime.sql
2021-01-31 00:44:28.945554 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-31 00:44:28.947678 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-31 00:44:28.949240 (MainThread): Parsing macros/adapters/common.sql
2021-01-31 00:44:28.988472 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-31 00:44:28.990169 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-31 00:44:28.991708 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-31 00:44:28.993283 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-31 00:44:29.000266 (MainThread): Partial parsing not enabled
2021-01-31 00:44:29.035358 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:44:29.056517 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:44:29.067894 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:44:29.079249 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:44:29.093535 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:44:29.104155 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:44:29.349512 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jrtests_learn_dbt.example.vars

2021-01-31 00:44:29.412103 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-31 00:44:29.413026 (MainThread): 
2021-01-31 00:44:29.413277 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:44:29.419521 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-31 00:44:29.430830 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-31 00:44:29.430912 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-31 00:44:29.430987 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-31 00:44:30.511176 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.08 seconds
2021-01-31 00:44:30.516041 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-31 00:44:30.703248 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-31 00:44:30.709793 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-31 00:44:30.709901 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-31 00:44:30.709989 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-31 00:44:31.535971 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.83 seconds
2021-01-31 00:44:31.544177 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-31 00:44:31.747578 (MainThread): Using snowflake connection "master".
2021-01-31 00:44:31.747765 (MainThread): On master: BEGIN
2021-01-31 00:44:31.747897 (MainThread): Opening a new connection, currently in state init
2021-01-31 00:44:32.288495 (MainThread): SQL status: SUCCESS 1 in 0.54 seconds
2021-01-31 00:44:32.288769 (MainThread): On master: COMMIT
2021-01-31 00:44:32.289028 (MainThread): Using snowflake connection "master".
2021-01-31 00:44:32.289181 (MainThread): On master: COMMIT
2021-01-31 00:44:32.530154 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-31 00:44:32.530438 (MainThread): On master: Close
2021-01-31 00:44:32.698934 (MainThread): 18:44:32 | Concurrency: 1 threads (target='dev')
2021-01-31 00:44:32.699165 (MainThread): 18:44:32 | 
2021-01-31 00:44:32.701234 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:44:32.702601 (Thread-1): 18:44:32 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-01-31 00:44:32.702900 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:44:32.703037 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:44:32.723076 (Thread-1): finished collecting timing info
2021-01-31 00:44:32.723462 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 270, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/compile.py", line 23, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/compilation.py", line 479, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/compilation.py", line 385, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 19, in top-level template code
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/context/base.py", line 148, in __call__
    return self.get_missing_var(var_name)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/context/base.py", line 129, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:44:32.725036 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71085985-5ea3-471b-8e9c-40ff445d3132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bde4e50>]}
2021-01-31 00:44:32.725993 (Thread-1): 18:44:32 | 1 of 6 ERROR creating table model dbt.first_model.................... [ERROR in 0.02s]
2021-01-31 00:44:32.726109 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:44:32.726228 (Thread-1): Began running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:44:32.727095 (Thread-1): 18:44:32 | 2 of 6 START table model dbt.covid_us................................ [RUN]
2021-01-31 00:44:32.727324 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:44:32.727422 (Thread-1): Compiling model.jrtests_learn_dbt.covid_us
2021-01-31 00:44:32.735225 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:44:32.735827 (Thread-1): finished collecting timing info
2021-01-31 00:44:32.766176 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:44:32.766891 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:44:32.766977 (Thread-1): On model.jrtests_learn_dbt.covid_us: BEGIN
2021-01-31 00:44:32.767057 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:44:33.614591 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-01-31 00:44:33.614844 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:44:33.615002 (Thread-1): On model.jrtests_learn_dbt.covid_us: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.covid_us"} */


      create or replace transient table analytics.dbt.covid_us  as
      (


 select
   *
 from
  "COVID19_BY_STARSCHEMA"."PUBLIC"."JHU_COVID_19"
 where
    date <=current_date
  and
    country_region = 'United States'


      );
2021-01-31 00:44:38.364343 (Thread-1): SQL status: SUCCESS 1 in 4.75 seconds
2021-01-31 00:44:38.366039 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:44:38.366292 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:44:38.366415 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:44:38.473766 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-31 00:44:38.489356 (Thread-1): finished collecting timing info
2021-01-31 00:44:38.489622 (Thread-1): On model.jrtests_learn_dbt.covid_us: Close
2021-01-31 00:44:38.676488 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71085985-5ea3-471b-8e9c-40ff445d3132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd357f0>]}
2021-01-31 00:44:38.678046 (Thread-1): 18:44:38 | 2 of 6 OK created table model dbt.covid_us........................... [SUCCESS 1 in 5.95s]
2021-01-31 00:44:38.678235 (Thread-1): Finished running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:44:38.678417 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:44:38.679635 (Thread-1): 18:44:38 | 3 of 6 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-31 00:44:38.680036 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:44:38.680175 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:44:38.688594 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:44:38.688938 (Thread-1): finished collecting timing info
2021-01-31 00:44:38.693942 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:44:38.694841 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:44:38.694934 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-31 00:44:38.695023 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:44:39.462974 (Thread-1): SQL status: SUCCESS 1 in 0.77 seconds
2021-01-31 00:44:39.463224 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:44:39.463373 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate
      );
2021-01-31 00:44:41.749247 (Thread-1): SQL status: SUCCESS 1 in 2.29 seconds
2021-01-31 00:44:41.750641 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:44:41.750849 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:44:41.750971 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:44:41.871758 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-31 00:44:41.874871 (Thread-1): finished collecting timing info
2021-01-31 00:44:41.875199 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-31 00:44:42.024518 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71085985-5ea3-471b-8e9c-40ff445d3132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c002f40>]}
2021-01-31 00:44:42.026100 (Thread-1): 18:44:42 | 3 of 6 OK created table model dbt.cumulative_orders_by_date.......... [SUCCESS 1 in 3.34s]
2021-01-31 00:44:42.026291 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:44:42.026478 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:44:42.027774 (Thread-1): 18:44:42 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-31 00:44:42.028057 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:44:42.028176 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:44:42.035594 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:44:42.035919 (Thread-1): finished collecting timing info
2021-01-31 00:44:42.039966 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:44:42.040854 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:44:42.040942 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-31 00:44:42.041026 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:44:43.025352 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2021-01-31 00:44:43.025611 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:44:43.025767 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-31 00:44:44.712878 (Thread-1): SQL status: SUCCESS 1 in 1.69 seconds
2021-01-31 00:44:44.714436 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:44:44.714714 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:44:44.714835 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:44:44.846009 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-01-31 00:44:44.849143 (Thread-1): finished collecting timing info
2021-01-31 00:44:44.849473 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-31 00:44:45.011314 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71085985-5ea3-471b-8e9c-40ff445d3132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfff2e0>]}
2021-01-31 00:44:45.012900 (Thread-1): 18:44:45 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.98s]
2021-01-31 00:44:45.013094 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:44:45.013281 (Thread-1): Began running node model.jrtests_learn_dbt.time
2021-01-31 00:44:45.014520 (Thread-1): 18:44:45 | 5 of 6 START table model dbt.time.................................... [RUN]
2021-01-31 00:44:45.014906 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:44:45.015036 (Thread-1): Compiling model.jrtests_learn_dbt.time
2021-01-31 00:44:45.022849 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:44:45.023208 (Thread-1): finished collecting timing info
2021-01-31 00:44:45.027222 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:44:45.028065 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:44:45.028156 (Thread-1): On model.jrtests_learn_dbt.time: BEGIN
2021-01-31 00:44:45.028242 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:44:45.881561 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-01-31 00:44:45.881825 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:44:45.881976 (Thread-1): On model.jrtests_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.time"} */


      create or replace transient table analytics.dbt.time  as
      (


SELECT
  To_time(Concat(t_hour :: VARCHAR, ':', t_minute, ':', t_second)) TIME,
  current_date last_update_date,
  current_time last_update_time
FROM
  "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE
  TIME <= current_time
ORDER  BY TIME DESC


      );
2021-01-31 00:44:46.993424 (Thread-1): SQL status: SUCCESS 1 in 1.11 seconds
2021-01-31 00:44:46.995010 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:44:46.995287 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:44:46.995408 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:44:47.109041 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-31 00:44:47.112178 (Thread-1): finished collecting timing info
2021-01-31 00:44:47.112514 (Thread-1): On model.jrtests_learn_dbt.time: Close
2021-01-31 00:44:47.281443 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71085985-5ea3-471b-8e9c-40ff445d3132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be93ee0>]}
2021-01-31 00:44:47.282922 (Thread-1): 18:44:47 | 5 of 6 OK created table model dbt.time............................... [SUCCESS 1 in 2.27s]
2021-01-31 00:44:47.283076 (Thread-1): Finished running node model.jrtests_learn_dbt.time
2021-01-31 00:44:47.283223 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:44:47.283364 (Thread-1): 18:44:47 | 6 of 6 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-01-31 00:44:47.283593 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:44:47.284510 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:44:47.284721 (MainThread): Using snowflake connection "master".
2021-01-31 00:44:47.284822 (MainThread): On master: BEGIN
2021-01-31 00:44:47.284924 (MainThread): Opening a new connection, currently in state closed
2021-01-31 00:44:48.164202 (MainThread): SQL status: SUCCESS 1 in 0.88 seconds
2021-01-31 00:44:48.164474 (MainThread): On master: COMMIT
2021-01-31 00:44:48.164718 (MainThread): Using snowflake connection "master".
2021-01-31 00:44:48.164864 (MainThread): On master: COMMIT
2021-01-31 00:44:48.604436 (MainThread): SQL status: SUCCESS 1 in 0.44 seconds
2021-01-31 00:44:48.604715 (MainThread): On master: Close
2021-01-31 00:44:48.781691 (MainThread): 18:44:48 | 
2021-01-31 00:44:48.781923 (MainThread): 18:44:48 | Finished running 6 table models in 19.37s.
2021-01-31 00:44:48.782079 (MainThread): Connection 'master' was properly closed.
2021-01-31 00:44:48.782198 (MainThread): Connection 'model.jrtests_learn_dbt.time' was properly closed.
2021-01-31 00:44:48.801242 (MainThread): 
2021-01-31 00:44:48.801365 (MainThread): Completed with 1 error and 0 warnings:
2021-01-31 00:44:48.801476 (MainThread): 
2021-01-31 00:44:48.801579 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:44:48.801673 (MainThread):   Required var 'my_first_variable' not found in config:
2021-01-31 00:44:48.801760 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-01-31 00:44:48.801843 (MainThread):   
2021-01-31 00:44:48.801924 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:44:48.802006 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:44:48.802099 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
2021-01-31 00:44:48.802250 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf83bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bec4970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bec4d60>]}
2021-01-31 00:44:48.802423 (MainThread): Flushing usage events
2021-01-31 00:46:56.877859 (MainThread): Running with dbt=0.18.1
2021-01-31 00:46:56.939926 (MainThread): Loading KWallet
2021-01-31 00:46:56.940385 (MainThread): Loading SecretService
2021-01-31 00:46:56.940756 (MainThread): Loading Windows
2021-01-31 00:46:56.941438 (MainThread): Loading chainer
2021-01-31 00:46:56.941704 (MainThread): Loading macOS
2021-01-31 00:46:57.192109 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-31 00:46:57.192945 (MainThread): Tracking: tracking
2021-01-31 00:46:57.193241 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106580190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10676dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10676d940>]}
2021-01-31 00:46:57.214192 (MainThread): Partial parsing not enabled
2021-01-31 00:46:57.215088 (MainThread): Parsing macros/catalog.sql
2021-01-31 00:46:57.217288 (MainThread): Parsing macros/adapters.sql
2021-01-31 00:46:57.246597 (MainThread): Parsing macros/materializations/merge.sql
2021-01-31 00:46:57.249074 (MainThread): Parsing macros/materializations/view.sql
2021-01-31 00:46:57.250584 (MainThread): Parsing macros/materializations/table.sql
2021-01-31 00:46:57.254624 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-31 00:46:57.265561 (MainThread): Parsing macros/core.sql
2021-01-31 00:46:57.269054 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-31 00:46:57.277369 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-31 00:46:57.278931 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-31 00:46:57.294575 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-31 00:46:57.323408 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-31 00:46:57.343395 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-31 00:46:57.345131 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-31 00:46:57.350989 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-31 00:46:57.364307 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-31 00:46:57.370807 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-31 00:46:57.376861 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-31 00:46:57.381608 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-31 00:46:57.382506 (MainThread): Parsing macros/etc/query.sql
2021-01-31 00:46:57.383515 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-31 00:46:57.385077 (MainThread): Parsing macros/etc/datetime.sql
2021-01-31 00:46:57.393934 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-31 00:46:57.395811 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-31 00:46:57.397459 (MainThread): Parsing macros/adapters/common.sql
2021-01-31 00:46:57.437761 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-31 00:46:57.439522 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-31 00:46:57.440944 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-31 00:46:57.442625 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-31 00:46:57.449752 (MainThread): Partial parsing not enabled
2021-01-31 00:46:57.485146 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:46:57.505627 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:46:57.515996 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:46:57.526498 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:46:57.541253 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:46:57.552110 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:46:57.793677 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jrtests_learn_dbt.example.vars

2021-01-31 00:46:57.862770 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-31 00:46:57.863809 (MainThread): 
2021-01-31 00:46:57.864097 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:46:57.871493 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-31 00:46:57.883439 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-31 00:46:57.883518 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-31 00:46:57.883591 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-31 00:46:58.971432 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.09 seconds
2021-01-31 00:46:58.976295 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-31 00:46:59.205867 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-31 00:46:59.212674 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-31 00:46:59.212777 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-31 00:46:59.212862 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-31 00:47:00.496816 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.28 seconds
2021-01-31 00:47:00.504762 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-31 00:47:00.668753 (MainThread): Using snowflake connection "master".
2021-01-31 00:47:00.668921 (MainThread): On master: BEGIN
2021-01-31 00:47:00.669036 (MainThread): Opening a new connection, currently in state init
2021-01-31 00:47:01.676911 (MainThread): SQL status: SUCCESS 1 in 1.01 seconds
2021-01-31 00:47:01.677169 (MainThread): On master: COMMIT
2021-01-31 00:47:01.677421 (MainThread): Using snowflake connection "master".
2021-01-31 00:47:01.677565 (MainThread): On master: COMMIT
2021-01-31 00:47:02.134872 (MainThread): SQL status: SUCCESS 1 in 0.46 seconds
2021-01-31 00:47:02.135141 (MainThread): On master: Close
2021-01-31 00:47:02.336045 (MainThread): 18:47:02 | Concurrency: 1 threads (target='dev')
2021-01-31 00:47:02.336271 (MainThread): 18:47:02 | 
2021-01-31 00:47:02.338035 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:47:02.339349 (Thread-1): 18:47:02 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-01-31 00:47:02.339636 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:47:02.339761 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:47:02.358839 (Thread-1): finished collecting timing info
2021-01-31 00:47:02.359219 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 270, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/compile.py", line 23, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/compilation.py", line 479, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/compilation.py", line 385, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 19, in top-level template code
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/context/base.py", line 148, in __call__
    return self.get_missing_var(var_name)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/context/base.py", line 129, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:47:02.360904 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c08f6ad-5d12-4f1b-a2e8-da3bf4ddcfeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075009a0>]}
2021-01-31 00:47:02.361881 (Thread-1): 18:47:02 | 1 of 6 ERROR creating table model dbt.first_model.................... [ERROR in 0.02s]
2021-01-31 00:47:02.361999 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:47:02.362114 (Thread-1): Began running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:47:02.363159 (Thread-1): 18:47:02 | 2 of 6 START table model dbt.covid_us................................ [RUN]
2021-01-31 00:47:02.363395 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:47:02.363489 (Thread-1): Compiling model.jrtests_learn_dbt.covid_us
2021-01-31 00:47:02.370818 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:47:02.371151 (Thread-1): finished collecting timing info
2021-01-31 00:47:02.401574 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:47:02.402301 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:47:02.402380 (Thread-1): On model.jrtests_learn_dbt.covid_us: BEGIN
2021-01-31 00:47:02.402455 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:47:02.973653 (Thread-1): SQL status: SUCCESS 1 in 0.57 seconds
2021-01-31 00:47:02.973898 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:47:02.974045 (Thread-1): On model.jrtests_learn_dbt.covid_us: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.covid_us"} */


      create or replace transient table analytics.dbt.covid_us  as
      (


 select
   *
 from
  "COVID19_BY_STARSCHEMA"."PUBLIC"."JHU_COVID_19"
 where
    date <=current_date
  and
    country_region = 'United States'


      );
2021-01-31 00:47:07.459310 (Thread-1): SQL status: SUCCESS 1 in 4.49 seconds
2021-01-31 00:47:07.461041 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:47:07.461293 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:47:07.461412 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:47:07.561874 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2021-01-31 00:47:07.576485 (Thread-1): finished collecting timing info
2021-01-31 00:47:07.576716 (Thread-1): On model.jrtests_learn_dbt.covid_us: Close
2021-01-31 00:47:07.736720 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c08f6ad-5d12-4f1b-a2e8-da3bf4ddcfeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b9ca0>]}
2021-01-31 00:47:07.738255 (Thread-1): 18:47:07 | 2 of 6 OK created table model dbt.covid_us........................... [SUCCESS 1 in 5.37s]
2021-01-31 00:47:07.738438 (Thread-1): Finished running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:47:07.738614 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:47:07.739855 (Thread-1): 18:47:07 | 3 of 6 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-31 00:47:07.740231 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:47:07.740362 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:47:07.748053 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:47:07.748414 (Thread-1): finished collecting timing info
2021-01-31 00:47:07.752995 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:47:07.753882 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:47:07.753970 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-31 00:47:07.754054 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:47:08.265549 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2021-01-31 00:47:08.265799 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:47:08.265949 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate
      );
2021-01-31 00:47:10.326556 (Thread-1): SQL status: SUCCESS 1 in 2.06 seconds
2021-01-31 00:47:10.328146 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:47:10.328397 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:47:10.328516 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:47:10.437508 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-31 00:47:10.440621 (Thread-1): finished collecting timing info
2021-01-31 00:47:10.440947 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-31 00:47:10.619225 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c08f6ad-5d12-4f1b-a2e8-da3bf4ddcfeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107411940>]}
2021-01-31 00:47:10.620799 (Thread-1): 18:47:10 | 3 of 6 OK created table model dbt.cumulative_orders_by_date.......... [SUCCESS 1 in 2.88s]
2021-01-31 00:47:10.620985 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:47:10.621163 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:47:10.622369 (Thread-1): 18:47:10 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-31 00:47:10.622671 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:47:10.622798 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:47:10.630806 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:47:10.631216 (Thread-1): finished collecting timing info
2021-01-31 00:47:10.635380 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:47:10.636307 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:47:10.636394 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-31 00:47:10.636477 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:47:11.185336 (Thread-1): SQL status: SUCCESS 1 in 0.55 seconds
2021-01-31 00:47:11.185584 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:47:11.185730 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-31 00:47:12.989563 (Thread-1): SQL status: SUCCESS 1 in 1.80 seconds
2021-01-31 00:47:12.991142 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:47:12.991407 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:47:12.991525 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:47:13.135564 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-01-31 00:47:13.138662 (Thread-1): finished collecting timing info
2021-01-31 00:47:13.138993 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-31 00:47:13.365825 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c08f6ad-5d12-4f1b-a2e8-da3bf4ddcfeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072d0190>]}
2021-01-31 00:47:13.367359 (Thread-1): 18:47:13 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.74s]
2021-01-31 00:47:13.367536 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:47:13.367680 (Thread-1): Began running node model.jrtests_learn_dbt.time
2021-01-31 00:47:13.368717 (Thread-1): 18:47:13 | 5 of 6 START table model dbt.time.................................... [RUN]
2021-01-31 00:47:13.369097 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:47:13.369222 (Thread-1): Compiling model.jrtests_learn_dbt.time
2021-01-31 00:47:13.377295 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:47:13.377631 (Thread-1): finished collecting timing info
2021-01-31 00:47:13.381642 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:47:13.382494 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:47:13.382582 (Thread-1): On model.jrtests_learn_dbt.time: BEGIN
2021-01-31 00:47:13.382667 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:47:14.389901 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2021-01-31 00:47:14.390138 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:47:14.390283 (Thread-1): On model.jrtests_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.time"} */


      create or replace transient table analytics.dbt.time  as
      (


SELECT
  To_time(Concat(t_hour :: VARCHAR, ':', t_minute, ':', t_second)) TIME,
  current_date last_update_date,
  current_time last_update_time
FROM
  "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE
  TIME <= current_time
ORDER  BY TIME DESC


      );
2021-01-31 00:47:15.857904 (Thread-1): SQL status: SUCCESS 1 in 1.47 seconds
2021-01-31 00:47:15.859461 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:47:15.859720 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:47:15.859864 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:47:15.963782 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2021-01-31 00:47:15.966723 (Thread-1): finished collecting timing info
2021-01-31 00:47:15.967056 (Thread-1): On model.jrtests_learn_dbt.time: Close
2021-01-31 00:47:16.135564 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c08f6ad-5d12-4f1b-a2e8-da3bf4ddcfeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073b2c70>]}
2021-01-31 00:47:16.137148 (Thread-1): 18:47:16 | 5 of 6 OK created table model dbt.time............................... [SUCCESS 1 in 2.77s]
2021-01-31 00:47:16.137335 (Thread-1): Finished running node model.jrtests_learn_dbt.time
2021-01-31 00:47:16.137519 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:47:16.137692 (Thread-1): 18:47:16 | 6 of 6 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-01-31 00:47:16.137864 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:47:16.138940 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:47:16.139153 (MainThread): Using snowflake connection "master".
2021-01-31 00:47:16.139252 (MainThread): On master: BEGIN
2021-01-31 00:47:16.139350 (MainThread): Opening a new connection, currently in state closed
2021-01-31 00:47:17.060474 (MainThread): SQL status: SUCCESS 1 in 0.92 seconds
2021-01-31 00:47:17.060759 (MainThread): On master: COMMIT
2021-01-31 00:47:17.061020 (MainThread): Using snowflake connection "master".
2021-01-31 00:47:17.061774 (MainThread): On master: COMMIT
2021-01-31 00:47:17.492104 (MainThread): SQL status: SUCCESS 1 in 0.43 seconds
2021-01-31 00:47:17.492388 (MainThread): On master: Close
2021-01-31 00:47:17.662093 (MainThread): 18:47:17 | 
2021-01-31 00:47:17.662343 (MainThread): 18:47:17 | Finished running 6 table models in 19.80s.
2021-01-31 00:47:17.662498 (MainThread): Connection 'master' was properly closed.
2021-01-31 00:47:17.662611 (MainThread): Connection 'model.jrtests_learn_dbt.time' was properly closed.
2021-01-31 00:47:17.681305 (MainThread): 
2021-01-31 00:47:17.681431 (MainThread): Completed with 1 error and 0 warnings:
2021-01-31 00:47:17.681544 (MainThread): 
2021-01-31 00:47:17.681647 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:47:17.681741 (MainThread):   Required var 'my_first_variable' not found in config:
2021-01-31 00:47:17.681827 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-01-31 00:47:17.681911 (MainThread):   
2021-01-31 00:47:17.681993 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:47:17.682076 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:47:17.682168 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
2021-01-31 00:47:17.682316 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073b2940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a69a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a6220>]}
2021-01-31 00:47:17.682491 (MainThread): Flushing usage events
2021-01-31 00:48:15.513066 (MainThread): Running with dbt=0.18.1
2021-01-31 00:48:15.573473 (MainThread): Loading KWallet
2021-01-31 00:48:15.574311 (MainThread): Loading SecretService
2021-01-31 00:48:15.574718 (MainThread): Loading Windows
2021-01-31 00:48:15.575214 (MainThread): Loading chainer
2021-01-31 00:48:15.575467 (MainThread): Loading macOS
2021-01-31 00:48:15.829039 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-31 00:48:15.829907 (MainThread): Tracking: tracking
2021-01-31 00:48:15.830184 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa36040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac23ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac23940>]}
2021-01-31 00:48:15.849812 (MainThread): Partial parsing not enabled
2021-01-31 00:48:15.850697 (MainThread): Parsing macros/catalog.sql
2021-01-31 00:48:15.852750 (MainThread): Parsing macros/adapters.sql
2021-01-31 00:48:15.884813 (MainThread): Parsing macros/materializations/merge.sql
2021-01-31 00:48:15.886687 (MainThread): Parsing macros/materializations/view.sql
2021-01-31 00:48:15.888060 (MainThread): Parsing macros/materializations/table.sql
2021-01-31 00:48:15.891732 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-31 00:48:15.902255 (MainThread): Parsing macros/core.sql
2021-01-31 00:48:15.905877 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-31 00:48:15.914371 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-31 00:48:15.916051 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-31 00:48:15.932089 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-31 00:48:15.960155 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-31 00:48:15.980588 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-31 00:48:15.982383 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-31 00:48:15.988243 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-31 00:48:16.001401 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-31 00:48:16.007854 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-31 00:48:16.014009 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-31 00:48:16.018582 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-31 00:48:16.019454 (MainThread): Parsing macros/etc/query.sql
2021-01-31 00:48:16.020482 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-31 00:48:16.021993 (MainThread): Parsing macros/etc/datetime.sql
2021-01-31 00:48:16.030401 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-31 00:48:16.032184 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-31 00:48:16.033707 (MainThread): Parsing macros/adapters/common.sql
2021-01-31 00:48:16.073023 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-31 00:48:16.074772 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-31 00:48:16.076148 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-31 00:48:16.077795 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-31 00:48:16.084988 (MainThread): Partial parsing not enabled
2021-01-31 00:48:16.119991 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:48:16.141541 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:48:16.151889 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:48:16.162204 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:48:16.176160 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:48:16.187105 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:48:16.427765 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jrtests_learn_dbt.example.vars

2021-01-31 00:48:16.491053 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-31 00:48:16.491962 (MainThread): 
2021-01-31 00:48:16.492215 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:48:16.498647 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-31 00:48:16.510220 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-31 00:48:16.510305 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-31 00:48:16.510383 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-31 00:48:17.406472 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.90 seconds
2021-01-31 00:48:17.411287 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-31 00:48:17.655704 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-31 00:48:17.662406 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-31 00:48:17.662516 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-31 00:48:17.662607 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-31 00:48:18.491027 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.83 seconds
2021-01-31 00:48:18.499170 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-31 00:48:18.675009 (MainThread): Using snowflake connection "master".
2021-01-31 00:48:18.675199 (MainThread): On master: BEGIN
2021-01-31 00:48:18.675333 (MainThread): Opening a new connection, currently in state init
2021-01-31 00:48:19.236472 (MainThread): SQL status: SUCCESS 1 in 0.56 seconds
2021-01-31 00:48:19.236736 (MainThread): On master: COMMIT
2021-01-31 00:48:19.236995 (MainThread): Using snowflake connection "master".
2021-01-31 00:48:19.237147 (MainThread): On master: COMMIT
2021-01-31 00:48:19.548608 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2021-01-31 00:48:19.548884 (MainThread): On master: Close
2021-01-31 00:48:19.721495 (MainThread): 18:48:19 | Concurrency: 1 threads (target='dev')
2021-01-31 00:48:19.721692 (MainThread): 18:48:19 | 
2021-01-31 00:48:19.723154 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:48:19.724379 (Thread-1): 18:48:19 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-01-31 00:48:19.724673 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:48:19.724802 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:48:19.743711 (Thread-1): finished collecting timing info
2021-01-31 00:48:19.744088 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 270, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/compile.py", line 23, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/compilation.py", line 479, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/compilation.py", line 385, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 19, in top-level template code
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/context/base.py", line 148, in __call__
    return self.get_missing_var(var_name)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/context/base.py", line 129, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:48:19.745642 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87895224-a264-403a-9755-d474b14dd239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b92cdc0>]}
2021-01-31 00:48:19.746600 (Thread-1): 18:48:19 | 1 of 6 ERROR creating table model dbt.first_model.................... [ERROR in 0.02s]
2021-01-31 00:48:19.746718 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:48:19.746837 (Thread-1): Began running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:48:19.747699 (Thread-1): 18:48:19 | 2 of 6 START table model dbt.covid_us................................ [RUN]
2021-01-31 00:48:19.747935 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:48:19.748034 (Thread-1): Compiling model.jrtests_learn_dbt.covid_us
2021-01-31 00:48:19.755547 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:48:19.755940 (Thread-1): finished collecting timing info
2021-01-31 00:48:19.786407 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:48:19.787125 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:48:19.787210 (Thread-1): On model.jrtests_learn_dbt.covid_us: BEGIN
2021-01-31 00:48:19.787288 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:48:20.711228 (Thread-1): SQL status: SUCCESS 1 in 0.92 seconds
2021-01-31 00:48:20.711431 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:48:20.711544 (Thread-1): On model.jrtests_learn_dbt.covid_us: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.covid_us"} */


      create or replace transient table analytics.dbt.covid_us  as
      (


 select
   *
 from
  "COVID19_BY_STARSCHEMA"."PUBLIC"."JHU_COVID_19"
 where
    date <=current_date
  and
    country_region = 'United States'


      );
2021-01-31 00:48:24.873226 (Thread-1): SQL status: SUCCESS 1 in 4.16 seconds
2021-01-31 00:48:24.874613 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:48:24.874826 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:48:24.874949 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:48:25.016125 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-01-31 00:48:25.030139 (Thread-1): finished collecting timing info
2021-01-31 00:48:25.030381 (Thread-1): On model.jrtests_learn_dbt.covid_us: Close
2021-01-31 00:48:25.197193 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87895224-a264-403a-9755-d474b14dd239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6df610>]}
2021-01-31 00:48:25.198739 (Thread-1): 18:48:25 | 2 of 6 OK created table model dbt.covid_us........................... [SUCCESS 1 in 5.45s]
2021-01-31 00:48:25.198926 (Thread-1): Finished running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:48:25.199112 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:48:25.200298 (Thread-1): 18:48:25 | 3 of 6 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-31 00:48:25.200689 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:48:25.200837 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:48:25.208520 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:48:25.208863 (Thread-1): finished collecting timing info
2021-01-31 00:48:25.213352 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:48:25.214250 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:48:25.214341 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-31 00:48:25.214426 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:48:26.074635 (Thread-1): SQL status: SUCCESS 1 in 0.86 seconds
2021-01-31 00:48:26.074842 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:48:26.074967 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate
      );
2021-01-31 00:48:28.150780 (Thread-1): SQL status: SUCCESS 1 in 2.08 seconds
2021-01-31 00:48:28.152374 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:48:28.152655 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:48:28.152777 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:48:28.250989 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2021-01-31 00:48:28.254115 (Thread-1): finished collecting timing info
2021-01-31 00:48:28.254449 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-31 00:48:28.420090 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87895224-a264-403a-9755-d474b14dd239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b88f1c0>]}
2021-01-31 00:48:28.421642 (Thread-1): 18:48:28 | 3 of 6 OK created table model dbt.cumulative_orders_by_date.......... [SUCCESS 1 in 3.22s]
2021-01-31 00:48:28.421838 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:48:28.422029 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:48:28.423207 (Thread-1): 18:48:28 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-31 00:48:28.423501 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:48:28.423633 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:48:28.431350 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:48:28.431703 (Thread-1): finished collecting timing info
2021-01-31 00:48:28.435898 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:48:28.436855 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:48:28.436949 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-31 00:48:28.437037 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:48:29.013709 (Thread-1): SQL status: SUCCESS 1 in 0.58 seconds
2021-01-31 00:48:29.013917 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:48:29.014043 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-31 00:48:30.730569 (Thread-1): SQL status: SUCCESS 1 in 1.72 seconds
2021-01-31 00:48:30.732137 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:48:30.732405 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:48:30.732555 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:48:30.847439 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-31 00:48:30.850425 (Thread-1): finished collecting timing info
2021-01-31 00:48:30.850763 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-31 00:48:31.056781 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87895224-a264-403a-9755-d474b14dd239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba326d0>]}
2021-01-31 00:48:31.058047 (Thread-1): 18:48:31 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.63s]
2021-01-31 00:48:31.058185 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:48:31.058383 (Thread-1): Began running node model.jrtests_learn_dbt.time
2021-01-31 00:48:31.059314 (Thread-1): 18:48:31 | 5 of 6 START table model dbt.time.................................... [RUN]
2021-01-31 00:48:31.059581 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:48:31.059718 (Thread-1): Compiling model.jrtests_learn_dbt.time
2021-01-31 00:48:31.067162 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:48:31.067534 (Thread-1): finished collecting timing info
2021-01-31 00:48:31.071501 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:48:31.072380 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:48:31.072471 (Thread-1): On model.jrtests_learn_dbt.time: BEGIN
2021-01-31 00:48:31.072556 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:48:31.639291 (Thread-1): SQL status: SUCCESS 1 in 0.57 seconds
2021-01-31 00:48:31.639546 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:48:31.639704 (Thread-1): On model.jrtests_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.time"} */


      create or replace transient table analytics.dbt.time  as
      (


SELECT
  To_time(Concat(t_hour :: VARCHAR, ':', t_minute, ':', t_second)) TIME,
  current_date last_update_date,
  current_time last_update_time
FROM
  "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE
  TIME <= current_time
ORDER  BY TIME DESC


      );
2021-01-31 00:48:32.862534 (Thread-1): SQL status: SUCCESS 1 in 1.22 seconds
2021-01-31 00:48:32.864118 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:48:32.864370 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:48:32.864496 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:48:32.999972 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-01-31 00:48:33.003092 (Thread-1): finished collecting timing info
2021-01-31 00:48:33.003435 (Thread-1): On model.jrtests_learn_dbt.time: Close
2021-01-31 00:48:33.172372 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87895224-a264-403a-9755-d474b14dd239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7c9580>]}
2021-01-31 00:48:33.173899 (Thread-1): 18:48:33 | 5 of 6 OK created table model dbt.time............................... [SUCCESS 1 in 2.11s]
2021-01-31 00:48:33.174087 (Thread-1): Finished running node model.jrtests_learn_dbt.time
2021-01-31 00:48:33.174273 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:48:33.174452 (Thread-1): 18:48:33 | 6 of 6 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-01-31 00:48:33.174729 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:48:33.175847 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:48:33.176072 (MainThread): Using snowflake connection "master".
2021-01-31 00:48:33.176176 (MainThread): On master: BEGIN
2021-01-31 00:48:33.176281 (MainThread): Opening a new connection, currently in state closed
2021-01-31 00:48:34.034028 (MainThread): SQL status: SUCCESS 1 in 0.86 seconds
2021-01-31 00:48:34.034307 (MainThread): On master: COMMIT
2021-01-31 00:48:34.034561 (MainThread): Using snowflake connection "master".
2021-01-31 00:48:34.034728 (MainThread): On master: COMMIT
2021-01-31 00:48:34.291237 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-31 00:48:34.291467 (MainThread): On master: Close
2021-01-31 00:48:34.707504 (MainThread): 18:48:34 | 
2021-01-31 00:48:34.707691 (MainThread): 18:48:34 | Finished running 6 table models in 18.22s.
2021-01-31 00:48:34.707821 (MainThread): Connection 'master' was properly closed.
2021-01-31 00:48:34.707915 (MainThread): Connection 'model.jrtests_learn_dbt.time' was properly closed.
2021-01-31 00:48:34.725836 (MainThread): 
2021-01-31 00:48:34.725962 (MainThread): Completed with 1 error and 0 warnings:
2021-01-31 00:48:34.726072 (MainThread): 
2021-01-31 00:48:34.726252 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:48:34.726361 (MainThread):   Required var 'my_first_variable' not found in config:
2021-01-31 00:48:34.726452 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-01-31 00:48:34.726537 (MainThread):   
2021-01-31 00:48:34.726619 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:48:34.726701 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:48:34.726790 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
2021-01-31 00:48:34.726936 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b86f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9a2fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9a2250>]}
2021-01-31 00:48:34.727108 (MainThread): Flushing usage events
2021-01-31 00:49:11.787242 (MainThread): Running with dbt=0.18.1
2021-01-31 00:49:11.848543 (MainThread): Loading KWallet
2021-01-31 00:49:11.848996 (MainThread): Loading SecretService
2021-01-31 00:49:11.849368 (MainThread): Loading Windows
2021-01-31 00:49:11.849862 (MainThread): Loading chainer
2021-01-31 00:49:11.850112 (MainThread): Loading macOS
2021-01-31 00:49:12.099935 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-31 00:49:12.100838 (MainThread): Tracking: tracking
2021-01-31 00:49:12.101104 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c5cd0>]}
2021-01-31 00:49:12.121569 (MainThread): Partial parsing not enabled
2021-01-31 00:49:12.122443 (MainThread): Parsing macros/catalog.sql
2021-01-31 00:49:12.124549 (MainThread): Parsing macros/adapters.sql
2021-01-31 00:49:12.152534 (MainThread): Parsing macros/materializations/merge.sql
2021-01-31 00:49:12.154372 (MainThread): Parsing macros/materializations/view.sql
2021-01-31 00:49:12.155718 (MainThread): Parsing macros/materializations/table.sql
2021-01-31 00:49:12.159417 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-31 00:49:12.169656 (MainThread): Parsing macros/core.sql
2021-01-31 00:49:12.173141 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-31 00:49:12.181348 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-31 00:49:12.182936 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-31 00:49:12.198787 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-31 00:49:12.226616 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-31 00:49:12.247399 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-31 00:49:12.249250 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-31 00:49:12.257544 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-31 00:49:12.271361 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-31 00:49:12.277927 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-31 00:49:12.283923 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-31 00:49:12.288638 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-31 00:49:12.289504 (MainThread): Parsing macros/etc/query.sql
2021-01-31 00:49:12.290469 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-31 00:49:12.292071 (MainThread): Parsing macros/etc/datetime.sql
2021-01-31 00:49:12.300291 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-31 00:49:12.302093 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-31 00:49:12.303632 (MainThread): Parsing macros/adapters/common.sql
2021-01-31 00:49:12.344004 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-31 00:49:12.345778 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-31 00:49:12.347279 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-31 00:49:12.348900 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-31 00:49:12.356169 (MainThread): Partial parsing not enabled
2021-01-31 00:49:12.391596 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:49:12.413340 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:49:12.423789 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:49:12.434298 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:49:12.448864 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:49:12.460644 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:49:12.695906 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jrtests_learn_dbt.example.vars

2021-01-31 00:49:12.761214 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-31 00:49:12.763121 (MainThread): 
2021-01-31 00:49:12.763410 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:49:12.770175 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-31 00:49:12.782463 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-31 00:49:12.782547 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-31 00:49:12.782697 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-31 00:49:13.733545 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.95 seconds
2021-01-31 00:49:13.738185 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-31 00:49:13.927001 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-31 00:49:13.933758 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-31 00:49:13.933861 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-31 00:49:13.933948 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-31 00:49:14.491730 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.56 seconds
2021-01-31 00:49:14.499942 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-31 00:49:14.696277 (MainThread): Using snowflake connection "master".
2021-01-31 00:49:14.696470 (MainThread): On master: BEGIN
2021-01-31 00:49:14.696599 (MainThread): Opening a new connection, currently in state init
2021-01-31 00:49:15.613229 (MainThread): SQL status: SUCCESS 1 in 0.92 seconds
2021-01-31 00:49:15.613504 (MainThread): On master: COMMIT
2021-01-31 00:49:15.613761 (MainThread): Using snowflake connection "master".
2021-01-31 00:49:15.613910 (MainThread): On master: COMMIT
2021-01-31 00:49:15.859181 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-31 00:49:15.859456 (MainThread): On master: Close
2021-01-31 00:49:16.046985 (MainThread): 18:49:16 | Concurrency: 1 threads (target='dev')
2021-01-31 00:49:16.047223 (MainThread): 18:49:16 | 
2021-01-31 00:49:16.048994 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:49:16.050434 (Thread-1): 18:49:16 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-01-31 00:49:16.050739 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:49:16.050873 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:49:16.070915 (Thread-1): finished collecting timing info
2021-01-31 00:49:16.071313 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 270, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/compile.py", line 23, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/compilation.py", line 479, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/compilation.py", line 385, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 19, in top-level template code
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/context/base.py", line 148, in __call__
    return self.get_missing_var(var_name)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/context/base.py", line 129, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:49:16.073200 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43d1061-bcc4-4b83-9862-cd736f7b3d9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10723bf40>]}
2021-01-31 00:49:16.074202 (Thread-1): 18:49:16 | 1 of 6 ERROR creating table model dbt.first_model.................... [ERROR in 0.02s]
2021-01-31 00:49:16.074322 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:49:16.074443 (Thread-1): Began running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:49:16.075317 (Thread-1): 18:49:16 | 2 of 6 START table model dbt.covid_us................................ [RUN]
2021-01-31 00:49:16.075680 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:49:16.075789 (Thread-1): Compiling model.jrtests_learn_dbt.covid_us
2021-01-31 00:49:16.083394 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:49:16.083983 (Thread-1): finished collecting timing info
2021-01-31 00:49:16.114920 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:49:16.115642 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:49:16.115725 (Thread-1): On model.jrtests_learn_dbt.covid_us: BEGIN
2021-01-31 00:49:16.115804 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:49:17.027915 (Thread-1): SQL status: SUCCESS 1 in 0.91 seconds
2021-01-31 00:49:17.028172 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:49:17.028322 (Thread-1): On model.jrtests_learn_dbt.covid_us: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.covid_us"} */


      create or replace transient table analytics.dbt.covid_us  as
      (


 select
   *
 from
  "COVID19_BY_STARSCHEMA"."PUBLIC"."JHU_COVID_19"
 where
    date <=current_date
  and
    country_region = 'United States'


      );
2021-01-31 00:49:21.398959 (Thread-1): SQL status: SUCCESS 1 in 4.37 seconds
2021-01-31 00:49:21.400642 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:49:21.400900 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:49:21.401021 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:49:21.565469 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-31 00:49:21.580563 (Thread-1): finished collecting timing info
2021-01-31 00:49:21.580828 (Thread-1): On model.jrtests_learn_dbt.covid_us: Close
2021-01-31 00:49:21.930015 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43d1061-bcc4-4b83-9862-cd736f7b3d9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10714a6a0>]}
2021-01-31 00:49:21.931556 (Thread-1): 18:49:21 | 2 of 6 OK created table model dbt.covid_us........................... [SUCCESS 1 in 5.85s]
2021-01-31 00:49:21.931742 (Thread-1): Finished running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:49:21.931928 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:49:21.933178 (Thread-1): 18:49:21 | 3 of 6 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-31 00:49:21.933481 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:49:21.933612 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:49:21.942240 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:49:21.942653 (Thread-1): finished collecting timing info
2021-01-31 00:49:21.947486 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:49:21.948366 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:49:21.948458 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-31 00:49:21.948545 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:49:22.533552 (Thread-1): SQL status: SUCCESS 1 in 0.58 seconds
2021-01-31 00:49:22.533809 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:49:22.533959 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate
      );
2021-01-31 00:49:24.675815 (Thread-1): SQL status: SUCCESS 1 in 2.14 seconds
2021-01-31 00:49:24.677400 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:49:24.677685 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:49:24.677808 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:49:24.795197 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-31 00:49:24.798375 (Thread-1): finished collecting timing info
2021-01-31 00:49:24.798704 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-31 00:49:24.987777 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43d1061-bcc4-4b83-9862-cd736f7b3d9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b5970>]}
2021-01-31 00:49:24.989318 (Thread-1): 18:49:24 | 3 of 6 OK created table model dbt.cumulative_orders_by_date.......... [SUCCESS 1 in 3.05s]
2021-01-31 00:49:24.989504 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:49:24.989712 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:49:24.990816 (Thread-1): 18:49:24 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-31 00:49:24.991215 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:49:24.991345 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:49:24.999516 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:49:24.999867 (Thread-1): finished collecting timing info
2021-01-31 00:49:25.004185 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:49:25.005112 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:49:25.005201 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-31 00:49:25.005285 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:49:25.876369 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-01-31 00:49:25.876539 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:49:25.876632 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-31 00:49:27.543768 (Thread-1): SQL status: SUCCESS 1 in 1.67 seconds
2021-01-31 00:49:27.545329 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:49:27.545582 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:49:27.545724 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:49:27.659499 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-31 00:49:27.662429 (Thread-1): finished collecting timing info
2021-01-31 00:49:27.662764 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-31 00:49:27.828557 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43d1061-bcc4-4b83-9862-cd736f7b3d9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10721d4c0>]}
2021-01-31 00:49:27.830133 (Thread-1): 18:49:27 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.84s]
2021-01-31 00:49:27.830317 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:49:27.830496 (Thread-1): Began running node model.jrtests_learn_dbt.time
2021-01-31 00:49:27.831712 (Thread-1): 18:49:27 | 5 of 6 START table model dbt.time.................................... [RUN]
2021-01-31 00:49:27.832111 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:49:27.832241 (Thread-1): Compiling model.jrtests_learn_dbt.time
2021-01-31 00:49:27.840591 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:49:27.840951 (Thread-1): finished collecting timing info
2021-01-31 00:49:27.845161 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:49:27.846009 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:49:27.846095 (Thread-1): On model.jrtests_learn_dbt.time: BEGIN
2021-01-31 00:49:27.846178 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:49:28.472238 (Thread-1): SQL status: SUCCESS 1 in 0.63 seconds
2021-01-31 00:49:28.472485 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:49:28.472629 (Thread-1): On model.jrtests_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.time"} */


      create or replace transient table analytics.dbt.time  as
      (


SELECT
  To_time(Concat(t_hour :: VARCHAR, ':', t_minute, ':', t_second)) TIME,
  current_date last_update_date,
  current_time last_update_time
FROM
  "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE
  TIME <= current_time
ORDER  BY TIME DESC


      );
2021-01-31 00:49:29.795832 (Thread-1): SQL status: SUCCESS 1 in 1.32 seconds
2021-01-31 00:49:29.797386 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:49:29.797644 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:49:29.797778 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:49:29.941311 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-01-31 00:49:29.944400 (Thread-1): finished collecting timing info
2021-01-31 00:49:29.944724 (Thread-1): On model.jrtests_learn_dbt.time: Close
2021-01-31 00:49:30.129576 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43d1061-bcc4-4b83-9862-cd736f7b3d9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c2220>]}
2021-01-31 00:49:30.131101 (Thread-1): 18:49:30 | 5 of 6 OK created table model dbt.time............................... [SUCCESS 1 in 2.30s]
2021-01-31 00:49:30.131283 (Thread-1): Finished running node model.jrtests_learn_dbt.time
2021-01-31 00:49:30.131463 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:49:30.131635 (Thread-1): 18:49:30 | 6 of 6 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-01-31 00:49:30.131846 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:49:30.133097 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:49:30.133306 (MainThread): Using snowflake connection "master".
2021-01-31 00:49:30.133415 (MainThread): On master: BEGIN
2021-01-31 00:49:30.133509 (MainThread): Opening a new connection, currently in state closed
2021-01-31 00:49:30.862095 (MainThread): SQL status: SUCCESS 1 in 0.73 seconds
2021-01-31 00:49:30.862355 (MainThread): On master: COMMIT
2021-01-31 00:49:30.862592 (MainThread): Using snowflake connection "master".
2021-01-31 00:49:30.862732 (MainThread): On master: COMMIT
2021-01-31 00:49:31.229951 (MainThread): SQL status: SUCCESS 1 in 0.37 seconds
2021-01-31 00:49:31.230221 (MainThread): On master: Close
2021-01-31 00:49:31.416443 (MainThread): 18:49:31 | 
2021-01-31 00:49:31.416619 (MainThread): 18:49:31 | Finished running 6 table models in 18.65s.
2021-01-31 00:49:31.416736 (MainThread): Connection 'master' was properly closed.
2021-01-31 00:49:31.416819 (MainThread): Connection 'model.jrtests_learn_dbt.time' was properly closed.
2021-01-31 00:49:31.433808 (MainThread): 
2021-01-31 00:49:31.433929 (MainThread): Completed with 1 error and 0 warnings:
2021-01-31 00:49:31.434032 (MainThread): 
2021-01-31 00:49:31.434137 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:49:31.434227 (MainThread):   Required var 'my_first_variable' not found in config:
2021-01-31 00:49:31.434308 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-01-31 00:49:31.434389 (MainThread):   
2021-01-31 00:49:31.434465 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:49:31.434541 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:49:31.434628 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
2021-01-31 00:49:31.434769 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e9a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e9c10>]}
2021-01-31 00:49:31.434936 (MainThread): Flushing usage events
2021-01-31 00:50:47.860750 (MainThread): Running with dbt=0.18.1
2021-01-31 00:50:47.921352 (MainThread): Loading KWallet
2021-01-31 00:50:47.921827 (MainThread): Loading SecretService
2021-01-31 00:50:47.922206 (MainThread): Loading Windows
2021-01-31 00:50:47.922703 (MainThread): Loading chainer
2021-01-31 00:50:47.922958 (MainThread): Loading macOS
2021-01-31 00:50:48.175676 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-31 00:50:48.176535 (MainThread): Tracking: tracking
2021-01-31 00:50:48.176816 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffa2b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110192c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110192e20>]}
2021-01-31 00:50:48.196801 (MainThread): Partial parsing not enabled
2021-01-31 00:50:48.197675 (MainThread): Parsing macros/catalog.sql
2021-01-31 00:50:48.199716 (MainThread): Parsing macros/adapters.sql
2021-01-31 00:50:48.227064 (MainThread): Parsing macros/materializations/merge.sql
2021-01-31 00:50:48.229151 (MainThread): Parsing macros/materializations/view.sql
2021-01-31 00:50:48.230532 (MainThread): Parsing macros/materializations/table.sql
2021-01-31 00:50:48.234460 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-31 00:50:48.245143 (MainThread): Parsing macros/core.sql
2021-01-31 00:50:48.248676 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-31 00:50:48.256760 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-31 00:50:48.258698 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-31 00:50:48.274210 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-31 00:50:48.302723 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-31 00:50:48.322597 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-31 00:50:48.324347 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-31 00:50:48.330219 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-31 00:50:48.343595 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-31 00:50:48.350049 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-31 00:50:48.355868 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-31 00:50:48.360461 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-31 00:50:48.361500 (MainThread): Parsing macros/etc/query.sql
2021-01-31 00:50:48.362521 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-31 00:50:48.364011 (MainThread): Parsing macros/etc/datetime.sql
2021-01-31 00:50:48.372000 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-31 00:50:48.373745 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-31 00:50:48.375253 (MainThread): Parsing macros/adapters/common.sql
2021-01-31 00:50:48.415445 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-31 00:50:48.417146 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-31 00:50:48.418524 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-31 00:50:48.420066 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-31 00:50:48.426994 (MainThread): Partial parsing not enabled
2021-01-31 00:50:48.465315 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:50:48.486142 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:50:48.496683 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:50:48.507005 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:50:48.521413 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:50:48.532396 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:50:48.833128 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-31 00:50:48.834006 (MainThread): 
2021-01-31 00:50:48.834252 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:50:48.840537 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-31 00:50:48.852243 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-31 00:50:48.852328 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-31 00:50:48.852403 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-31 00:50:49.814481 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 0.96 seconds
2021-01-31 00:50:49.819301 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-31 00:50:50.025414 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-31 00:50:50.032102 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-31 00:50:50.032205 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-31 00:50:50.032294 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-31 00:50:50.590098 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.56 seconds
2021-01-31 00:50:50.598246 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-31 00:50:50.764262 (MainThread): Using snowflake connection "master".
2021-01-31 00:50:50.764454 (MainThread): On master: BEGIN
2021-01-31 00:50:50.764585 (MainThread): Opening a new connection, currently in state init
2021-01-31 00:50:51.641843 (MainThread): SQL status: SUCCESS 1 in 0.88 seconds
2021-01-31 00:50:51.642123 (MainThread): On master: COMMIT
2021-01-31 00:50:51.642380 (MainThread): Using snowflake connection "master".
2021-01-31 00:50:51.642530 (MainThread): On master: COMMIT
2021-01-31 00:50:52.331331 (MainThread): SQL status: SUCCESS 1 in 0.69 seconds
2021-01-31 00:50:52.331615 (MainThread): On master: Close
2021-01-31 00:50:52.595133 (MainThread): 18:50:52 | Concurrency: 1 threads (target='dev')
2021-01-31 00:50:52.595374 (MainThread): 18:50:52 | 
2021-01-31 00:50:52.597122 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:50:52.598617 (Thread-1): 18:50:52 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-01-31 00:50:52.598914 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:50:52.599046 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:50:52.618810 (Thread-1): finished collecting timing info
2021-01-31 00:50:52.619190 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 270, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/compile.py", line 23, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/compilation.py", line 479, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/compilation.py", line 385, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 19, in top-level template code
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/context/base.py", line 148, in __call__
    return self.get_missing_var(var_name)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/context/base.py", line 129, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:50:52.620771 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f18e92cb-ca4e-408a-8ce0-c8474a8e23a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e82190>]}
2021-01-31 00:50:52.621740 (Thread-1): 18:50:52 | 1 of 6 ERROR creating table model dbt.first_model.................... [ERROR in 0.02s]
2021-01-31 00:50:52.621862 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:50:52.621984 (Thread-1): Began running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:50:52.623029 (Thread-1): 18:50:52 | 2 of 6 START table model dbt.covid_us................................ [RUN]
2021-01-31 00:50:52.623312 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:50:52.623423 (Thread-1): Compiling model.jrtests_learn_dbt.covid_us
2021-01-31 00:50:52.631008 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:50:52.631630 (Thread-1): finished collecting timing info
2021-01-31 00:50:52.662274 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:50:52.663092 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:50:52.663192 (Thread-1): On model.jrtests_learn_dbt.covid_us: BEGIN
2021-01-31 00:50:52.663283 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:50:53.899641 (Thread-1): SQL status: SUCCESS 1 in 1.24 seconds
2021-01-31 00:50:53.899892 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:50:53.900044 (Thread-1): On model.jrtests_learn_dbt.covid_us: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.covid_us"} */


      create or replace transient table analytics.dbt.covid_us  as
      (


 select
   *
 from
  "COVID19_BY_STARSCHEMA"."PUBLIC"."JHU_COVID_19"
 where
    date <=current_date
  and
    country_region = 'United States'


      );
2021-01-31 00:50:57.942977 (Thread-1): SQL status: SUCCESS 1 in 4.04 seconds
2021-01-31 00:50:57.944669 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:50:57.944909 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:50:57.945032 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:50:58.043797 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2021-01-31 00:50:58.056906 (Thread-1): finished collecting timing info
2021-01-31 00:50:58.057147 (Thread-1): On model.jrtests_learn_dbt.covid_us: Close
2021-01-31 00:50:58.236690 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f18e92cb-ca4e-408a-8ce0-c8474a8e23a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e82520>]}
2021-01-31 00:50:58.238226 (Thread-1): 18:50:58 | 2 of 6 OK created table model dbt.covid_us........................... [SUCCESS 1 in 5.61s]
2021-01-31 00:50:58.238415 (Thread-1): Finished running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:50:58.238596 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:50:58.239816 (Thread-1): 18:50:58 | 3 of 6 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-31 00:50:58.240098 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:50:58.240221 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:50:58.247935 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:50:58.248285 (Thread-1): finished collecting timing info
2021-01-31 00:50:58.252813 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:50:58.253678 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:50:58.253767 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-31 00:50:58.253852 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:50:58.983610 (Thread-1): SQL status: SUCCESS 1 in 0.73 seconds
2021-01-31 00:50:58.983868 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:50:58.984025 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate
      );
2021-01-31 00:51:00.934809 (Thread-1): SQL status: SUCCESS 1 in 1.95 seconds
2021-01-31 00:51:00.936416 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:51:00.936702 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:51:00.936827 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:51:01.046975 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-31 00:51:01.050176 (Thread-1): finished collecting timing info
2021-01-31 00:51:01.050514 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-31 00:51:01.216440 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f18e92cb-ca4e-408a-8ce0-c8474a8e23a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d2c550>]}
2021-01-31 00:51:01.217954 (Thread-1): 18:51:01 | 3 of 6 OK created table model dbt.cumulative_orders_by_date.......... [SUCCESS 1 in 2.98s]
2021-01-31 00:51:01.218141 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:51:01.218325 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:51:01.219479 (Thread-1): 18:51:01 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-31 00:51:01.219888 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:51:01.220029 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:51:01.228194 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:51:01.228575 (Thread-1): finished collecting timing info
2021-01-31 00:51:01.232919 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:51:01.233845 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:51:01.233937 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-31 00:51:01.234024 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:51:01.801023 (Thread-1): SQL status: SUCCESS 1 in 0.57 seconds
2021-01-31 00:51:01.801276 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:51:01.801427 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-31 00:51:03.595408 (Thread-1): SQL status: SUCCESS 1 in 1.79 seconds
2021-01-31 00:51:03.596963 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:51:03.597216 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:51:03.597340 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:51:03.728213 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-01-31 00:51:03.731355 (Thread-1): finished collecting timing info
2021-01-31 00:51:03.731691 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-31 00:51:03.902341 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f18e92cb-ca4e-408a-8ce0-c8474a8e23a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dea610>]}
2021-01-31 00:51:03.903938 (Thread-1): 18:51:03 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.68s]
2021-01-31 00:51:03.904128 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:51:03.904317 (Thread-1): Began running node model.jrtests_learn_dbt.time
2021-01-31 00:51:03.905435 (Thread-1): 18:51:03 | 5 of 6 START table model dbt.time.................................... [RUN]
2021-01-31 00:51:03.905836 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:51:03.905973 (Thread-1): Compiling model.jrtests_learn_dbt.time
2021-01-31 00:51:03.914360 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:51:03.914738 (Thread-1): finished collecting timing info
2021-01-31 00:51:03.918864 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:51:03.919726 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:51:03.919818 (Thread-1): On model.jrtests_learn_dbt.time: BEGIN
2021-01-31 00:51:03.919905 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:51:04.768609 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-01-31 00:51:04.768860 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:51:04.769014 (Thread-1): On model.jrtests_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.time"} */


      create or replace transient table analytics.dbt.time  as
      (


SELECT
  To_time(Concat(t_hour :: VARCHAR, ':', t_minute, ':', t_second)) TIME,
  current_date last_update_date,
  current_time last_update_time
FROM
  "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE
  TIME <= current_time
ORDER  BY TIME DESC


      );
2021-01-31 00:51:06.053195 (Thread-1): SQL status: SUCCESS 1 in 1.28 seconds
2021-01-31 00:51:06.054783 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:51:06.054997 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:51:06.055121 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:51:06.155814 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2021-01-31 00:51:06.158917 (Thread-1): finished collecting timing info
2021-01-31 00:51:06.159250 (Thread-1): On model.jrtests_learn_dbt.time: Close
2021-01-31 00:51:06.334896 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f18e92cb-ca4e-408a-8ce0-c8474a8e23a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110a52e0>]}
2021-01-31 00:51:06.336412 (Thread-1): 18:51:06 | 5 of 6 OK created table model dbt.time............................... [SUCCESS 1 in 2.43s]
2021-01-31 00:51:06.336597 (Thread-1): Finished running node model.jrtests_learn_dbt.time
2021-01-31 00:51:06.336780 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:51:06.337057 (Thread-1): 18:51:06 | 6 of 6 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-01-31 00:51:06.337239 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:51:06.338341 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:51:06.338558 (MainThread): Using snowflake connection "master".
2021-01-31 00:51:06.338658 (MainThread): On master: BEGIN
2021-01-31 00:51:06.338758 (MainThread): Opening a new connection, currently in state closed
2021-01-31 00:51:06.933034 (MainThread): SQL status: SUCCESS 1 in 0.59 seconds
2021-01-31 00:51:06.933308 (MainThread): On master: COMMIT
2021-01-31 00:51:06.933554 (MainThread): Using snowflake connection "master".
2021-01-31 00:51:06.933703 (MainThread): On master: COMMIT
2021-01-31 00:51:07.278844 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2021-01-31 00:51:07.279128 (MainThread): On master: Close
2021-01-31 00:51:07.449030 (MainThread): 18:51:07 | 
2021-01-31 00:51:07.449258 (MainThread): 18:51:07 | Finished running 6 table models in 18.61s.
2021-01-31 00:51:07.449410 (MainThread): Connection 'master' was properly closed.
2021-01-31 00:51:07.449521 (MainThread): Connection 'model.jrtests_learn_dbt.time' was properly closed.
2021-01-31 00:51:07.468365 (MainThread): 
2021-01-31 00:51:07.468491 (MainThread): Completed with 1 error and 0 warnings:
2021-01-31 00:51:07.468599 (MainThread): 
2021-01-31 00:51:07.468704 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:51:07.468798 (MainThread):   Required var 'my_first_variable' not found in config:
2021-01-31 00:51:07.468884 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-01-31 00:51:07.468967 (MainThread):   
2021-01-31 00:51:07.469049 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:51:07.469133 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:51:07.469226 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
2021-01-31 00:51:07.469374 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d31c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d318e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110db5310>]}
2021-01-31 00:51:07.469548 (MainThread): Flushing usage events
2021-01-31 00:52:53.266404 (MainThread): Running with dbt=0.18.1
2021-01-31 00:52:53.326876 (MainThread): Loading KWallet
2021-01-31 00:52:53.327324 (MainThread): Loading SecretService
2021-01-31 00:52:53.327690 (MainThread): Loading Windows
2021-01-31 00:52:53.328173 (MainThread): Loading chainer
2021-01-31 00:52:53.328520 (MainThread): Loading macOS
2021-01-31 00:52:53.581934 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-31 00:52:53.582807 (MainThread): Tracking: tracking
2021-01-31 00:52:53.583057 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbd1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdc2c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdc2e20>]}
2021-01-31 00:52:53.602430 (MainThread): Partial parsing not enabled
2021-01-31 00:52:53.603325 (MainThread): Parsing macros/catalog.sql
2021-01-31 00:52:53.605437 (MainThread): Parsing macros/adapters.sql
2021-01-31 00:52:53.633052 (MainThread): Parsing macros/materializations/merge.sql
2021-01-31 00:52:53.634903 (MainThread): Parsing macros/materializations/view.sql
2021-01-31 00:52:53.636267 (MainThread): Parsing macros/materializations/table.sql
2021-01-31 00:52:53.639962 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-31 00:52:53.650167 (MainThread): Parsing macros/core.sql
2021-01-31 00:52:53.653814 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-31 00:52:53.661974 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-31 00:52:53.663700 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-31 00:52:53.679277 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-31 00:52:53.707583 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-31 00:52:53.727139 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-31 00:52:53.728949 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-31 00:52:53.735235 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-31 00:52:53.748027 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-31 00:52:53.754408 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-31 00:52:53.760500 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-31 00:52:53.765352 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-31 00:52:53.766210 (MainThread): Parsing macros/etc/query.sql
2021-01-31 00:52:53.767169 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-31 00:52:53.768716 (MainThread): Parsing macros/etc/datetime.sql
2021-01-31 00:52:53.776830 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-31 00:52:53.778735 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-31 00:52:53.780280 (MainThread): Parsing macros/adapters/common.sql
2021-01-31 00:52:53.819522 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-31 00:52:53.821205 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-31 00:52:53.822571 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-31 00:52:53.824100 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-31 00:52:53.832193 (MainThread): Partial parsing not enabled
2021-01-31 00:52:53.870077 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:52:53.890686 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:52:53.901027 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:52:53.911535 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:52:53.925817 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:52:53.936773 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:52:54.176639 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jrtests_learn_dbt.example.vars

2021-01-31 00:52:54.241127 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-31 00:52:54.241998 (MainThread): 
2021-01-31 00:52:54.242244 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:52:54.248949 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-31 00:52:54.260384 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-31 00:52:54.260469 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-31 00:52:54.260544 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-31 00:52:55.350586 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.09 seconds
2021-01-31 00:52:55.355475 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-31 00:52:55.534668 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-31 00:52:55.541192 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-31 00:52:55.541297 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-31 00:52:55.541384 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-31 00:52:56.156283 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.61 seconds
2021-01-31 00:52:56.164454 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-31 00:52:56.329100 (MainThread): Using snowflake connection "master".
2021-01-31 00:52:56.329288 (MainThread): On master: BEGIN
2021-01-31 00:52:56.329420 (MainThread): Opening a new connection, currently in state init
2021-01-31 00:52:57.190394 (MainThread): SQL status: SUCCESS 1 in 0.86 seconds
2021-01-31 00:52:57.190666 (MainThread): On master: COMMIT
2021-01-31 00:52:57.190923 (MainThread): Using snowflake connection "master".
2021-01-31 00:52:57.191087 (MainThread): On master: COMMIT
2021-01-31 00:52:57.426447 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-31 00:52:57.426732 (MainThread): On master: Close
2021-01-31 00:52:57.613428 (MainThread): 18:52:57 | Concurrency: 1 threads (target='dev')
2021-01-31 00:52:57.613664 (MainThread): 18:52:57 | 
2021-01-31 00:52:57.615461 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:52:57.616892 (Thread-1): 18:52:57 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-01-31 00:52:57.617201 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:52:57.617335 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:52:57.637537 (Thread-1): finished collecting timing info
2021-01-31 00:52:57.637918 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 270, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/compile.py", line 23, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/compilation.py", line 479, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/compilation.py", line 385, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 19, in top-level template code
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/context/base.py", line 148, in __call__
    return self.get_missing_var(var_name)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/context/base.py", line 129, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:52:57.639512 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f957db87-cf3d-4bad-98da-cd238c32ee52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a3f580>]}
2021-01-31 00:52:57.640476 (Thread-1): 18:52:57 | 1 of 6 ERROR creating table model dbt.first_model.................... [ERROR in 0.02s]
2021-01-31 00:52:57.640595 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:52:57.640712 (Thread-1): Began running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:52:57.641578 (Thread-1): 18:52:57 | 2 of 6 START table model dbt.covid_us................................ [RUN]
2021-01-31 00:52:57.641808 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:52:57.641907 (Thread-1): Compiling model.jrtests_learn_dbt.covid_us
2021-01-31 00:52:57.649614 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:52:57.650227 (Thread-1): finished collecting timing info
2021-01-31 00:52:57.680510 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:52:57.681206 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:52:57.681287 (Thread-1): On model.jrtests_learn_dbt.covid_us: BEGIN
2021-01-31 00:52:57.681378 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:52:58.664936 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2021-01-31 00:52:58.665187 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:52:58.665340 (Thread-1): On model.jrtests_learn_dbt.covid_us: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.covid_us"} */


      create or replace transient table analytics.dbt.covid_us  as
      (


 select
   *
 from
  "COVID19_BY_STARSCHEMA"."PUBLIC"."JHU_COVID_19"
 where
    date <=current_date
  and
    country_region = 'United States'


      );
2021-01-31 00:53:03.608596 (Thread-1): SQL status: SUCCESS 1 in 4.94 seconds
2021-01-31 00:53:03.610307 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:53:03.610520 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:53:03.610644 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:53:03.716024 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-31 00:53:03.731556 (Thread-1): finished collecting timing info
2021-01-31 00:53:03.731841 (Thread-1): On model.jrtests_learn_dbt.covid_us: Close
2021-01-31 00:53:03.908428 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f957db87-cf3d-4bad-98da-cd238c32ee52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108d94c0>]}
2021-01-31 00:53:03.909999 (Thread-1): 18:53:03 | 2 of 6 OK created table model dbt.covid_us........................... [SUCCESS 1 in 6.27s]
2021-01-31 00:53:03.910192 (Thread-1): Finished running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:53:03.910384 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:53:03.911661 (Thread-1): 18:53:03 | 3 of 6 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-31 00:53:03.911976 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:53:03.912114 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:53:03.920921 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:53:03.921321 (Thread-1): finished collecting timing info
2021-01-31 00:53:03.926462 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:53:03.927408 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:53:03.927508 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-31 00:53:03.927600 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:53:04.511269 (Thread-1): SQL status: SUCCESS 1 in 0.58 seconds
2021-01-31 00:53:04.511524 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:53:04.511677 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate
      );
2021-01-31 00:53:06.885182 (Thread-1): SQL status: SUCCESS 1 in 2.37 seconds
2021-01-31 00:53:06.886735 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:53:06.886994 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:53:06.887145 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:53:07.070098 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-31 00:53:07.073327 (Thread-1): finished collecting timing info
2021-01-31 00:53:07.073667 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-31 00:53:07.298217 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f957db87-cf3d-4bad-98da-cd238c32ee52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b262b0>]}
2021-01-31 00:53:07.299746 (Thread-1): 18:53:07 | 3 of 6 OK created table model dbt.cumulative_orders_by_date.......... [SUCCESS 1 in 3.39s]
2021-01-31 00:53:07.299935 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:53:07.300118 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:53:07.301339 (Thread-1): 18:53:07 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-31 00:53:07.301769 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:53:07.301906 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:53:07.310078 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:53:07.310447 (Thread-1): finished collecting timing info
2021-01-31 00:53:07.314853 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:53:07.315795 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:53:07.315889 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-31 00:53:07.315979 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:53:08.070597 (Thread-1): SQL status: SUCCESS 1 in 0.75 seconds
2021-01-31 00:53:08.070852 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:53:08.071009 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-31 00:53:09.957194 (Thread-1): SQL status: SUCCESS 1 in 1.89 seconds
2021-01-31 00:53:09.958838 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:53:09.959082 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:53:09.959206 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:53:10.058056 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2021-01-31 00:53:10.061197 (Thread-1): finished collecting timing info
2021-01-31 00:53:10.061536 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-31 00:53:10.289509 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f957db87-cf3d-4bad-98da-cd238c32ee52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109361f0>]}
2021-01-31 00:53:10.291107 (Thread-1): 18:53:10 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.99s]
2021-01-31 00:53:10.291280 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:53:10.291430 (Thread-1): Began running node model.jrtests_learn_dbt.time
2021-01-31 00:53:10.292479 (Thread-1): 18:53:10 | 5 of 6 START table model dbt.time.................................... [RUN]
2021-01-31 00:53:10.292763 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:53:10.292888 (Thread-1): Compiling model.jrtests_learn_dbt.time
2021-01-31 00:53:10.300718 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:53:10.301136 (Thread-1): finished collecting timing info
2021-01-31 00:53:10.305134 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:53:10.305994 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:53:10.306086 (Thread-1): On model.jrtests_learn_dbt.time: BEGIN
2021-01-31 00:53:10.306172 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:53:10.991204 (Thread-1): SQL status: SUCCESS 1 in 0.69 seconds
2021-01-31 00:53:10.991463 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:53:10.991618 (Thread-1): On model.jrtests_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.time"} */


      create or replace transient table analytics.dbt.time  as
      (


SELECT
  To_time(Concat(t_hour :: VARCHAR, ':', t_minute, ':', t_second)) TIME,
  current_date last_update_date,
  current_time last_update_time
FROM
  "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE
  TIME <= current_time
ORDER  BY TIME DESC


      );
2021-01-31 00:53:12.172171 (Thread-1): SQL status: SUCCESS 1 in 1.18 seconds
2021-01-31 00:53:12.173736 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:53:12.173998 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:53:12.174118 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:53:12.277263 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2021-01-31 00:53:12.280406 (Thread-1): finished collecting timing info
2021-01-31 00:53:12.280748 (Thread-1): On model.jrtests_learn_dbt.time: Close
2021-01-31 00:53:12.466027 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f957db87-cf3d-4bad-98da-cd238c32ee52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b3a370>]}
2021-01-31 00:53:12.467553 (Thread-1): 18:53:12 | 5 of 6 OK created table model dbt.time............................... [SUCCESS 1 in 2.17s]
2021-01-31 00:53:12.467751 (Thread-1): Finished running node model.jrtests_learn_dbt.time
2021-01-31 00:53:12.467933 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:53:12.468197 (Thread-1): 18:53:12 | 6 of 6 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-01-31 00:53:12.468349 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:53:12.469322 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:53:12.469536 (MainThread): Using snowflake connection "master".
2021-01-31 00:53:12.469635 (MainThread): On master: BEGIN
2021-01-31 00:53:12.469734 (MainThread): Opening a new connection, currently in state closed
2021-01-31 00:53:13.019383 (MainThread): SQL status: SUCCESS 1 in 0.55 seconds
2021-01-31 00:53:13.019609 (MainThread): On master: COMMIT
2021-01-31 00:53:13.019816 (MainThread): Using snowflake connection "master".
2021-01-31 00:53:13.019936 (MainThread): On master: COMMIT
2021-01-31 00:53:13.435224 (MainThread): SQL status: SUCCESS 1 in 0.42 seconds
2021-01-31 00:53:13.435505 (MainThread): On master: Close
2021-01-31 00:53:13.656192 (MainThread): 18:53:13 | 
2021-01-31 00:53:13.656421 (MainThread): 18:53:13 | Finished running 6 table models in 19.41s.
2021-01-31 00:53:13.656577 (MainThread): Connection 'master' was properly closed.
2021-01-31 00:53:13.656690 (MainThread): Connection 'model.jrtests_learn_dbt.time' was properly closed.
2021-01-31 00:53:13.674803 (MainThread): 
2021-01-31 00:53:13.674926 (MainThread): Completed with 1 error and 0 warnings:
2021-01-31 00:53:13.675038 (MainThread): 
2021-01-31 00:53:13.675139 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:53:13.675229 (MainThread):   Required var 'my_first_variable' not found in config:
2021-01-31 00:53:13.675313 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-01-31 00:53:13.675394 (MainThread):   
2021-01-31 00:53:13.675473 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:53:13.675557 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:53:13.675647 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
2021-01-31 00:53:13.675791 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a03910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c0d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a3f460>]}
2021-01-31 00:53:13.675958 (MainThread): Flushing usage events
2021-01-31 00:54:05.480935 (MainThread): Running with dbt=0.18.1
2021-01-31 00:54:05.542382 (MainThread): Loading KWallet
2021-01-31 00:54:05.542845 (MainThread): Loading SecretService
2021-01-31 00:54:05.543218 (MainThread): Loading Windows
2021-01-31 00:54:05.543908 (MainThread): Loading chainer
2021-01-31 00:54:05.544180 (MainThread): Loading macOS
2021-01-31 00:54:05.793838 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-31 00:54:05.794782 (MainThread): Tracking: tracking
2021-01-31 00:54:05.795017 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1ea190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3d7ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3d7940>]}
2021-01-31 00:54:05.814999 (MainThread): Partial parsing not enabled
2021-01-31 00:54:05.816062 (MainThread): Parsing macros/catalog.sql
2021-01-31 00:54:05.818159 (MainThread): Parsing macros/adapters.sql
2021-01-31 00:54:05.845716 (MainThread): Parsing macros/materializations/merge.sql
2021-01-31 00:54:05.847715 (MainThread): Parsing macros/materializations/view.sql
2021-01-31 00:54:05.849154 (MainThread): Parsing macros/materializations/table.sql
2021-01-31 00:54:05.852846 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-31 00:54:05.863336 (MainThread): Parsing macros/core.sql
2021-01-31 00:54:05.866702 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-31 00:54:05.874805 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-31 00:54:05.876575 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-31 00:54:05.891943 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-31 00:54:05.923436 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-31 00:54:05.943801 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-31 00:54:05.945644 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-31 00:54:05.951732 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-31 00:54:05.964551 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-31 00:54:05.970857 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-31 00:54:05.976797 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-31 00:54:05.982045 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-31 00:54:05.982987 (MainThread): Parsing macros/etc/query.sql
2021-01-31 00:54:05.983955 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-31 00:54:05.985462 (MainThread): Parsing macros/etc/datetime.sql
2021-01-31 00:54:05.993610 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-31 00:54:05.995478 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-31 00:54:05.997139 (MainThread): Parsing macros/adapters/common.sql
2021-01-31 00:54:06.037441 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-31 00:54:06.039242 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-31 00:54:06.040686 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-31 00:54:06.042297 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-31 00:54:06.049539 (MainThread): Partial parsing not enabled
2021-01-31 00:54:06.085661 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:54:06.106522 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:54:06.117082 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:54:06.127564 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:54:06.141472 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:54:06.152419 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:54:06.389449 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jrtests_learn_dbt.example.vars

2021-01-31 00:54:06.455177 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-31 00:54:06.456044 (MainThread): 
2021-01-31 00:54:06.456292 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:54:06.462816 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-31 00:54:06.474134 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-31 00:54:06.474213 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-31 00:54:06.474284 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-31 00:54:07.634841 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.16 seconds
2021-01-31 00:54:07.639636 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-31 00:54:07.823866 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-31 00:54:07.830664 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-31 00:54:07.830764 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-31 00:54:07.830848 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-31 00:54:08.678184 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.85 seconds
2021-01-31 00:54:08.686524 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-31 00:54:08.898295 (MainThread): Using snowflake connection "master".
2021-01-31 00:54:08.898476 (MainThread): On master: BEGIN
2021-01-31 00:54:08.898602 (MainThread): Opening a new connection, currently in state init
2021-01-31 00:54:09.484873 (MainThread): SQL status: SUCCESS 1 in 0.59 seconds
2021-01-31 00:54:09.485140 (MainThread): On master: COMMIT
2021-01-31 00:54:09.485387 (MainThread): Using snowflake connection "master".
2021-01-31 00:54:09.485526 (MainThread): On master: COMMIT
2021-01-31 00:54:09.759376 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-31 00:54:09.759651 (MainThread): On master: Close
2021-01-31 00:54:09.977018 (MainThread): 18:54:09 | Concurrency: 1 threads (target='dev')
2021-01-31 00:54:09.977240 (MainThread): 18:54:09 | 
2021-01-31 00:54:09.979032 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:54:09.980290 (Thread-1): 18:54:09 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-01-31 00:54:09.980578 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:54:09.980701 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:54:09.999498 (Thread-1): finished collecting timing info
2021-01-31 00:54:09.999865 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 270, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/compile.py", line 23, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/compilation.py", line 479, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/compilation.py", line 385, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 19, in top-level template code
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/context/base.py", line 148, in __call__
    return self.get_missing_var(var_name)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/context/base.py", line 129, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_first_variable' not found in config:
  Vars supplied to my_first_dbt_model = {}
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:54:10.001429 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a336693-d481-4d04-b517-0ce843d4dd12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e14feb0>]}
2021-01-31 00:54:10.002397 (Thread-1): 18:54:10 | 1 of 6 ERROR creating table model dbt.first_model.................... [ERROR in 0.02s]
2021-01-31 00:54:10.002514 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:54:10.002629 (Thread-1): Began running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:54:10.003496 (Thread-1): 18:54:10 | 2 of 6 START table model dbt.covid_us................................ [RUN]
2021-01-31 00:54:10.003724 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:54:10.003823 (Thread-1): Compiling model.jrtests_learn_dbt.covid_us
2021-01-31 00:54:10.011355 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:54:10.011702 (Thread-1): finished collecting timing info
2021-01-31 00:54:10.041611 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:54:10.042286 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:54:10.042364 (Thread-1): On model.jrtests_learn_dbt.covid_us: BEGIN
2021-01-31 00:54:10.042433 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:54:10.998897 (Thread-1): SQL status: SUCCESS 1 in 0.96 seconds
2021-01-31 00:54:10.999142 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:54:10.999284 (Thread-1): On model.jrtests_learn_dbt.covid_us: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.covid_us"} */


      create or replace transient table analytics.dbt.covid_us  as
      (


 select
   *
 from
  "COVID19_BY_STARSCHEMA"."PUBLIC"."JHU_COVID_19"
 where
    date <=current_date
  and
    country_region = 'United States'


      );
2021-01-31 00:54:15.744899 (Thread-1): SQL status: SUCCESS 1 in 4.75 seconds
2021-01-31 00:54:15.746588 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:54:15.746849 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:54:15.746964 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:54:15.856081 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-31 00:54:15.870500 (Thread-1): finished collecting timing info
2021-01-31 00:54:15.870742 (Thread-1): On model.jrtests_learn_dbt.covid_us: Close
2021-01-31 00:54:16.037463 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a336693-d481-4d04-b517-0ce843d4dd12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de8bfd0>]}
2021-01-31 00:54:16.039038 (Thread-1): 18:54:16 | 2 of 6 OK created table model dbt.covid_us........................... [SUCCESS 1 in 6.03s]
2021-01-31 00:54:16.039225 (Thread-1): Finished running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:54:16.039404 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:54:16.040600 (Thread-1): 18:54:16 | 3 of 6 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-31 00:54:16.040978 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:54:16.041101 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:54:16.048759 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:54:16.049102 (Thread-1): finished collecting timing info
2021-01-31 00:54:16.053632 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:54:16.054495 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:54:16.054583 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-31 00:54:16.054665 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:54:16.673615 (Thread-1): SQL status: SUCCESS 1 in 0.62 seconds
2021-01-31 00:54:16.673895 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:54:16.674051 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate
      );
2021-01-31 00:54:18.771475 (Thread-1): SQL status: SUCCESS 1 in 2.10 seconds
2021-01-31 00:54:18.773079 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:54:18.773330 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:54:18.773453 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:54:18.880690 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-31 00:54:18.883814 (Thread-1): finished collecting timing info
2021-01-31 00:54:18.884146 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-31 00:54:19.093003 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a336693-d481-4d04-b517-0ce843d4dd12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e078100>]}
2021-01-31 00:54:19.094526 (Thread-1): 18:54:19 | 3 of 6 OK created table model dbt.cumulative_orders_by_date.......... [SUCCESS 1 in 3.05s]
2021-01-31 00:54:19.094718 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:54:19.094902 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:54:19.096094 (Thread-1): 18:54:19 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-31 00:54:19.096515 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:54:19.096656 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:54:19.104132 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:54:19.104490 (Thread-1): finished collecting timing info
2021-01-31 00:54:19.108563 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:54:19.109461 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:54:19.109551 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-31 00:54:19.109634 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:54:19.992620 (Thread-1): SQL status: SUCCESS 1 in 0.88 seconds
2021-01-31 00:54:19.992881 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:54:19.993035 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-31 00:54:21.839510 (Thread-1): SQL status: SUCCESS 1 in 1.85 seconds
2021-01-31 00:54:21.841087 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:54:21.841368 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:54:21.841491 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:54:21.948608 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-31 00:54:21.951693 (Thread-1): finished collecting timing info
2021-01-31 00:54:21.952019 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-31 00:54:22.150518 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a336693-d481-4d04-b517-0ce843d4dd12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df2e550>]}
2021-01-31 00:54:22.152095 (Thread-1): 18:54:22 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.05s]
2021-01-31 00:54:22.152284 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:54:22.152467 (Thread-1): Began running node model.jrtests_learn_dbt.time
2021-01-31 00:54:22.153681 (Thread-1): 18:54:22 | 5 of 6 START table model dbt.time.................................... [RUN]
2021-01-31 00:54:22.154068 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:54:22.154200 (Thread-1): Compiling model.jrtests_learn_dbt.time
2021-01-31 00:54:22.161912 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:54:22.162263 (Thread-1): finished collecting timing info
2021-01-31 00:54:22.166242 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:54:22.167105 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:54:22.167195 (Thread-1): On model.jrtests_learn_dbt.time: BEGIN
2021-01-31 00:54:22.167280 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:54:23.039958 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-01-31 00:54:23.040220 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:54:23.040375 (Thread-1): On model.jrtests_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.time"} */


      create or replace transient table analytics.dbt.time  as
      (


SELECT
  To_time(Concat(t_hour :: VARCHAR, ':', t_minute, ':', t_second)) TIME,
  current_date last_update_date,
  current_time last_update_time
FROM
  "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE
  TIME <= current_time
ORDER  BY TIME DESC


      );
2021-01-31 00:54:24.504846 (Thread-1): SQL status: SUCCESS 1 in 1.46 seconds
2021-01-31 00:54:24.506403 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:54:24.506688 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:54:24.506809 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:54:24.655840 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-01-31 00:54:24.658923 (Thread-1): finished collecting timing info
2021-01-31 00:54:24.659257 (Thread-1): On model.jrtests_learn_dbt.time: Close
2021-01-31 00:54:24.832368 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a336693-d481-4d04-b517-0ce843d4dd12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0c7a60>]}
2021-01-31 00:54:24.833881 (Thread-1): 18:54:24 | 5 of 6 OK created table model dbt.time............................... [SUCCESS 1 in 2.68s]
2021-01-31 00:54:24.834068 (Thread-1): Finished running node model.jrtests_learn_dbt.time
2021-01-31 00:54:24.834250 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:54:24.834540 (Thread-1): 18:54:24 | 6 of 6 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-01-31 00:54:24.834736 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:54:24.835844 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:54:24.836059 (MainThread): Using snowflake connection "master".
2021-01-31 00:54:24.836161 (MainThread): On master: BEGIN
2021-01-31 00:54:24.836261 (MainThread): Opening a new connection, currently in state closed
2021-01-31 00:54:25.391594 (MainThread): SQL status: SUCCESS 1 in 0.56 seconds
2021-01-31 00:54:25.391867 (MainThread): On master: COMMIT
2021-01-31 00:54:25.392114 (MainThread): Using snowflake connection "master".
2021-01-31 00:54:25.392262 (MainThread): On master: COMMIT
2021-01-31 00:54:25.629919 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-31 00:54:25.630194 (MainThread): On master: Close
2021-01-31 00:54:25.810615 (MainThread): 18:54:25 | 
2021-01-31 00:54:25.810843 (MainThread): 18:54:25 | Finished running 6 table models in 19.35s.
2021-01-31 00:54:25.810997 (MainThread): Connection 'master' was properly closed.
2021-01-31 00:54:25.811108 (MainThread): Connection 'model.jrtests_learn_dbt.time' was properly closed.
2021-01-31 00:54:25.829770 (MainThread): 
2021-01-31 00:54:25.829904 (MainThread): Completed with 1 error and 0 warnings:
2021-01-31 00:54:25.830012 (MainThread): 
2021-01-31 00:54:25.830115 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:54:25.830208 (MainThread):   Required var 'my_first_variable' not found in config:
2021-01-31 00:54:25.830294 (MainThread):   Vars supplied to my_first_dbt_model = {}
2021-01-31 00:54:25.830377 (MainThread):   
2021-01-31 00:54:25.830459 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:54:25.830540 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:54:25.830632 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
2021-01-31 00:54:25.830787 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e01c670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e050460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0c73d0>]}
2021-01-31 00:54:25.830975 (MainThread): Flushing usage events
2021-01-31 00:56:34.034939 (MainThread): Running with dbt=0.18.1
2021-01-31 00:56:34.099182 (MainThread): Loading KWallet
2021-01-31 00:56:34.099650 (MainThread): Loading SecretService
2021-01-31 00:56:34.100037 (MainThread): Loading Windows
2021-01-31 00:56:34.100545 (MainThread): Loading chainer
2021-01-31 00:56:34.100806 (MainThread): Loading macOS
2021-01-31 00:56:34.352804 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-31 00:56:34.353713 (MainThread): Tracking: tracking
2021-01-31 00:56:34.353989 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8e8100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bad5c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bad58e0>]}
2021-01-31 00:56:34.374026 (MainThread): Partial parsing not enabled
2021-01-31 00:56:34.374987 (MainThread): Parsing macros/catalog.sql
2021-01-31 00:56:34.377643 (MainThread): Parsing macros/adapters.sql
2021-01-31 00:56:34.405558 (MainThread): Parsing macros/materializations/merge.sql
2021-01-31 00:56:34.407407 (MainThread): Parsing macros/materializations/view.sql
2021-01-31 00:56:34.408815 (MainThread): Parsing macros/materializations/table.sql
2021-01-31 00:56:34.412473 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-31 00:56:34.422968 (MainThread): Parsing macros/core.sql
2021-01-31 00:56:34.426454 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-31 00:56:34.434841 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-31 00:56:34.436485 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-31 00:56:34.452593 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-31 00:56:34.480200 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-31 00:56:34.503169 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-31 00:56:34.504978 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-31 00:56:34.510932 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-31 00:56:34.524506 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-31 00:56:34.531040 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-31 00:56:34.537174 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-31 00:56:34.541914 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-31 00:56:34.542817 (MainThread): Parsing macros/etc/query.sql
2021-01-31 00:56:34.543968 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-31 00:56:34.545502 (MainThread): Parsing macros/etc/datetime.sql
2021-01-31 00:56:34.553835 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-31 00:56:34.555674 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-31 00:56:34.557248 (MainThread): Parsing macros/adapters/common.sql
2021-01-31 00:56:34.598185 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-31 00:56:34.599970 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-31 00:56:34.601407 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-31 00:56:34.603031 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-31 00:56:34.610373 (MainThread): Partial parsing not enabled
2021-01-31 00:56:34.645507 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:56:34.665916 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:56:34.676376 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:56:34.686890 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:56:34.701187 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:56:34.711968 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:56:35.017616 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-31 00:56:35.018516 (MainThread): 
2021-01-31 00:56:35.018773 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:56:35.025641 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-31 00:56:35.037454 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-31 00:56:35.037544 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-31 00:56:35.037622 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-31 00:56:36.144823 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.11 seconds
2021-01-31 00:56:36.149719 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-31 00:56:36.369155 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-31 00:56:36.375777 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-31 00:56:36.375883 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-31 00:56:36.375973 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-31 00:56:37.205417 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.83 seconds
2021-01-31 00:56:37.213616 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-31 00:56:37.392277 (MainThread): Using snowflake connection "master".
2021-01-31 00:56:37.392464 (MainThread): On master: BEGIN
2021-01-31 00:56:37.392595 (MainThread): Opening a new connection, currently in state init
2021-01-31 00:56:38.422766 (MainThread): SQL status: SUCCESS 1 in 1.03 seconds
2021-01-31 00:56:38.423042 (MainThread): On master: COMMIT
2021-01-31 00:56:38.423302 (MainThread): Using snowflake connection "master".
2021-01-31 00:56:38.423453 (MainThread): On master: COMMIT
2021-01-31 00:56:38.697157 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-31 00:56:38.697435 (MainThread): On master: Close
2021-01-31 00:56:38.887528 (MainThread): 18:56:38 | Concurrency: 1 threads (target='dev')
2021-01-31 00:56:38.887757 (MainThread): 18:56:38 | 
2021-01-31 00:56:38.889629 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:56:38.890954 (Thread-1): 18:56:38 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-01-31 00:56:38.891243 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:56:38.891368 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:56:38.909019 (Thread-1): finished collecting timing info
2021-01-31 00:56:38.909334 (Thread-1): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_third_variable' not found in config:
  Vars supplied to my_first_dbt_model = {
      "my_first_variable": true
  }
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 270, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/task/compile.py", line 23, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/compilation.py", line 479, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/compilation.py", line 385, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 21, in top-level template code
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/context/base.py", line 148, in __call__
    return self.get_missing_var(var_name)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/context/base.py", line 129, in get_missing_var
    raise_compiler_error(msg, self._node)
  File "/usr/local/Cellar/dbt/0.18.1_1/libexec/lib/python3.8/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Required var 'my_third_variable' not found in config:
  Vars supplied to my_first_dbt_model = {
      "my_first_variable": true
  }
  
  > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:56:38.910688 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f2b671-12c6-46e1-bf41-077da28bc403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7d0640>]}
2021-01-31 00:56:38.911502 (Thread-1): 18:56:38 | 1 of 6 ERROR creating table model dbt.first_model.................... [ERROR in 0.02s]
2021-01-31 00:56:38.911602 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:56:38.911700 (Thread-1): Began running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:56:38.912434 (Thread-1): 18:56:38 | 2 of 6 START table model dbt.covid_us................................ [RUN]
2021-01-31 00:56:38.912631 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:56:38.912716 (Thread-1): Compiling model.jrtests_learn_dbt.covid_us
2021-01-31 00:56:38.919467 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:56:38.919776 (Thread-1): finished collecting timing info
2021-01-31 00:56:38.949683 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:56:38.950471 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:56:38.950554 (Thread-1): On model.jrtests_learn_dbt.covid_us: BEGIN
2021-01-31 00:56:38.950628 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:56:39.841729 (Thread-1): SQL status: SUCCESS 1 in 0.89 seconds
2021-01-31 00:56:39.841995 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:56:39.842151 (Thread-1): On model.jrtests_learn_dbt.covid_us: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.covid_us"} */


      create or replace transient table analytics.dbt.covid_us  as
      (


 select
   *
 from
  "COVID19_BY_STARSCHEMA"."PUBLIC"."JHU_COVID_19"
 where
    date <=current_date
  and
    country_region = 'United States'


      );
2021-01-31 00:56:44.793780 (Thread-1): SQL status: SUCCESS 1 in 4.95 seconds
2021-01-31 00:56:44.795505 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:56:44.795715 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:56:44.795840 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:56:44.922970 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-01-31 00:56:44.937048 (Thread-1): finished collecting timing info
2021-01-31 00:56:44.937282 (Thread-1): On model.jrtests_learn_dbt.covid_us: Close
2021-01-31 00:56:45.002688 (Thread-1): unclosed <socket.socket fd=15, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.1.24', 49518), raddr=('52.184.166.117', 443)>
2021-01-31 00:56:45.384623 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f2b671-12c6-46e1-bf41-077da28bc403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8e4ca0>]}
2021-01-31 00:56:45.386198 (Thread-1): 18:56:45 | 2 of 6 OK created table model dbt.covid_us........................... [SUCCESS 1 in 6.47s]
2021-01-31 00:56:45.386386 (Thread-1): Finished running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:56:45.386571 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:56:45.387744 (Thread-1): 18:56:45 | 3 of 6 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-31 00:56:45.388134 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:56:45.388270 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:56:45.396281 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:56:45.396652 (Thread-1): finished collecting timing info
2021-01-31 00:56:45.401496 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:56:45.402388 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:56:45.402482 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-31 00:56:45.402571 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:56:46.388297 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-01-31 00:56:46.388556 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:56:46.388711 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate
      );
2021-01-31 00:56:48.684518 (Thread-1): SQL status: SUCCESS 1 in 2.30 seconds
2021-01-31 00:56:48.685811 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:56:48.686021 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:56:48.686144 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:56:48.789857 (Thread-1): SQL status: SUCCESS 1 in 0.10 seconds
2021-01-31 00:56:48.793012 (Thread-1): finished collecting timing info
2021-01-31 00:56:48.793344 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-31 00:56:48.982363 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f2b671-12c6-46e1-bf41-077da28bc403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8d2940>]}
2021-01-31 00:56:48.983894 (Thread-1): 18:56:48 | 3 of 6 OK created table model dbt.cumulative_orders_by_date.......... [SUCCESS 1 in 3.59s]
2021-01-31 00:56:48.984082 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:56:48.984266 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:56:48.985486 (Thread-1): 18:56:48 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-31 00:56:48.985776 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:56:48.985984 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:56:48.993660 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:56:48.994022 (Thread-1): finished collecting timing info
2021-01-31 00:56:48.998178 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:56:48.999115 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:56:48.999222 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-31 00:56:48.999308 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:56:49.847087 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-01-31 00:56:49.847344 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:56:49.847498 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-31 00:56:51.531677 (Thread-1): SQL status: SUCCESS 1 in 1.68 seconds
2021-01-31 00:56:51.533247 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:56:51.533512 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:56:51.533652 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:56:51.653575 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-31 00:56:51.656534 (Thread-1): finished collecting timing info
2021-01-31 00:56:51.656872 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-31 00:56:51.865700 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f2b671-12c6-46e1-bf41-077da28bc403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8d0550>]}
2021-01-31 00:56:51.867281 (Thread-1): 18:56:51 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 2.88s]
2021-01-31 00:56:51.867473 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:56:51.867660 (Thread-1): Began running node model.jrtests_learn_dbt.time
2021-01-31 00:56:51.869041 (Thread-1): 18:56:51 | 5 of 6 START table model dbt.time.................................... [RUN]
2021-01-31 00:56:51.869398 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:56:51.869546 (Thread-1): Compiling model.jrtests_learn_dbt.time
2021-01-31 00:56:51.878289 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:56:51.878655 (Thread-1): finished collecting timing info
2021-01-31 00:56:51.882989 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:56:51.883938 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:56:51.884038 (Thread-1): On model.jrtests_learn_dbt.time: BEGIN
2021-01-31 00:56:51.884128 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:56:52.754217 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-01-31 00:56:52.754475 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:56:52.754640 (Thread-1): On model.jrtests_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.time"} */


      create or replace transient table analytics.dbt.time  as
      (


SELECT
  To_time(Concat(t_hour :: VARCHAR, ':', t_minute, ':', t_second)) TIME,
  current_date last_update_date,
  current_time last_update_time
FROM
  "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE
  TIME <= current_time
ORDER  BY TIME DESC


      );
2021-01-31 00:56:54.214205 (Thread-1): SQL status: SUCCESS 1 in 1.46 seconds
2021-01-31 00:56:54.215768 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:56:54.216024 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:56:54.216179 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:56:54.368764 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-01-31 00:56:54.371880 (Thread-1): finished collecting timing info
2021-01-31 00:56:54.372211 (Thread-1): On model.jrtests_learn_dbt.time: Close
2021-01-31 00:56:54.626069 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f2b671-12c6-46e1-bf41-077da28bc403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c71dee0>]}
2021-01-31 00:56:54.627617 (Thread-1): 18:56:54 | 5 of 6 OK created table model dbt.time............................... [SUCCESS 1 in 2.76s]
2021-01-31 00:56:54.627808 (Thread-1): Finished running node model.jrtests_learn_dbt.time
2021-01-31 00:56:54.627995 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:56:54.628179 (Thread-1): 18:56:54 | 6 of 6 SKIP relation dbt.my_second_dbt_model......................... [SKIP]
2021-01-31 00:56:54.628467 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:56:54.629456 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:56:54.629671 (MainThread): Using snowflake connection "master".
2021-01-31 00:56:54.629771 (MainThread): On master: BEGIN
2021-01-31 00:56:54.629871 (MainThread): Opening a new connection, currently in state closed
2021-01-31 00:56:55.513470 (MainThread): SQL status: SUCCESS 1 in 0.88 seconds
2021-01-31 00:56:55.513745 (MainThread): On master: COMMIT
2021-01-31 00:56:55.513993 (MainThread): Using snowflake connection "master".
2021-01-31 00:56:55.514142 (MainThread): On master: COMMIT
2021-01-31 00:56:55.762634 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-31 00:56:55.762915 (MainThread): On master: Close
2021-01-31 00:56:55.969535 (MainThread): 18:56:55 | 
2021-01-31 00:56:55.969761 (MainThread): 18:56:55 | Finished running 6 table models in 20.95s.
2021-01-31 00:56:55.969913 (MainThread): Connection 'master' was properly closed.
2021-01-31 00:56:55.970024 (MainThread): Connection 'model.jrtests_learn_dbt.time' was properly closed.
2021-01-31 00:56:55.989594 (MainThread): 
2021-01-31 00:56:55.989724 (MainThread): Completed with 1 error and 0 warnings:
2021-01-31 00:56:55.989829 (MainThread): 
2021-01-31 00:56:55.989928 (MainThread): Compilation Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:56:55.990020 (MainThread):   Required var 'my_third_variable' not found in config:
2021-01-31 00:56:55.990105 (MainThread):   Vars supplied to my_first_dbt_model = {
2021-01-31 00:56:55.990189 (MainThread):       "my_first_variable": true
2021-01-31 00:56:55.990272 (MainThread):   }
2021-01-31 00:56:55.990353 (MainThread):   
2021-01-31 00:56:55.990433 (MainThread):   > in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:56:55.990513 (MainThread):   > called by model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-01-31 00:56:55.990604 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
2021-01-31 00:56:55.990754 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c760f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c720ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7a3df0>]}
2021-01-31 00:56:55.990923 (MainThread): Flushing usage events
2021-01-31 00:57:25.934621 (MainThread): Running with dbt=0.18.1
2021-01-31 00:57:25.995762 (MainThread): Loading KWallet
2021-01-31 00:57:25.996242 (MainThread): Loading SecretService
2021-01-31 00:57:25.996623 (MainThread): Loading Windows
2021-01-31 00:57:25.997157 (MainThread): Loading chainer
2021-01-31 00:57:25.997421 (MainThread): Loading macOS
2021-01-31 00:57:26.247054 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-31 00:57:26.247989 (MainThread): Tracking: tracking
2021-01-31 00:57:26.248262 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a82e040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa1aca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa1a940>]}
2021-01-31 00:57:26.267704 (MainThread): Partial parsing not enabled
2021-01-31 00:57:26.268584 (MainThread): Parsing macros/catalog.sql
2021-01-31 00:57:26.270656 (MainThread): Parsing macros/adapters.sql
2021-01-31 00:57:26.298476 (MainThread): Parsing macros/materializations/merge.sql
2021-01-31 00:57:26.300364 (MainThread): Parsing macros/materializations/view.sql
2021-01-31 00:57:26.301767 (MainThread): Parsing macros/materializations/table.sql
2021-01-31 00:57:26.305392 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-31 00:57:26.315499 (MainThread): Parsing macros/core.sql
2021-01-31 00:57:26.318930 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-31 00:57:26.326858 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-31 00:57:26.328414 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-31 00:57:26.343769 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-31 00:57:26.371829 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-31 00:57:26.392472 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-31 00:57:26.395158 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-31 00:57:26.401621 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-31 00:57:26.414807 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-31 00:57:26.421248 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-31 00:57:26.427260 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-31 00:57:26.431998 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-31 00:57:26.432911 (MainThread): Parsing macros/etc/query.sql
2021-01-31 00:57:26.434013 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-31 00:57:26.435537 (MainThread): Parsing macros/etc/datetime.sql
2021-01-31 00:57:26.443923 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-31 00:57:26.445813 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-31 00:57:26.447458 (MainThread): Parsing macros/adapters/common.sql
2021-01-31 00:57:26.487260 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-31 00:57:26.489018 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-31 00:57:26.490438 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-31 00:57:26.492065 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-31 00:57:26.499232 (MainThread): Partial parsing not enabled
2021-01-31 00:57:26.534014 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:57:26.554014 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:57:26.564443 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:57:26.574895 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:57:26.588766 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:57:26.599801 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:57:26.898535 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-31 00:57:26.899737 (MainThread): 
2021-01-31 00:57:26.900122 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:57:26.907108 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-01-31 00:57:26.918582 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-01-31 00:57:26.918667 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-01-31 00:57:26.918742 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-31 00:57:27.918882 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 4 in 1.00 seconds
2021-01-31 00:57:27.922706 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-01-31 00:57:28.124485 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-01-31 00:57:28.131148 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-01-31 00:57:28.131253 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-01-31 00:57:28.131340 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-31 00:57:29.190990 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.06 seconds
2021-01-31 00:57:29.199562 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-01-31 00:57:29.385993 (MainThread): Using snowflake connection "master".
2021-01-31 00:57:29.386183 (MainThread): On master: BEGIN
2021-01-31 00:57:29.386318 (MainThread): Opening a new connection, currently in state init
2021-01-31 00:57:29.957953 (MainThread): SQL status: SUCCESS 1 in 0.57 seconds
2021-01-31 00:57:29.958229 (MainThread): On master: COMMIT
2021-01-31 00:57:29.958492 (MainThread): Using snowflake connection "master".
2021-01-31 00:57:29.958655 (MainThread): On master: COMMIT
2021-01-31 00:57:30.465181 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2021-01-31 00:57:30.465466 (MainThread): On master: Close
2021-01-31 00:57:30.643346 (MainThread): 18:57:30 | Concurrency: 1 threads (target='dev')
2021-01-31 00:57:30.643580 (MainThread): 18:57:30 | 
2021-01-31 00:57:30.645305 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:57:30.646511 (Thread-1): 18:57:30 | 1 of 6 START table model dbt.first_model............................. [RUN]
2021-01-31 00:57:30.646810 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:57:30.646938 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:57:30.666571 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-31 00:57:30.666919 (Thread-1): finished collecting timing info
2021-01-31 00:57:30.696779 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-01-31 00:57:30.697683 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:57:30.697765 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-01-31 00:57:30.697843 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:57:31.570587 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-01-31 00:57:31.570847 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:57:31.571000 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, True as first_variable
from source_data
where id >= 2

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-01-31 00:57:32.592785 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2021-01-31 00:57:32.594087 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-31 00:57:32.594256 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-01-31 00:57:32.594356 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-01-31 00:57:32.706366 (Thread-1): SQL status: SUCCESS 1 in 0.11 seconds
2021-01-31 00:57:32.720155 (Thread-1): finished collecting timing info
2021-01-31 00:57:32.720405 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-01-31 00:57:32.914558 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4928ccc2-74d3-43ec-af7a-b8426a51fa32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6b9fd0>]}
2021-01-31 00:57:32.916103 (Thread-1): 18:57:32 | 1 of 6 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.27s]
2021-01-31 00:57:32.916287 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-01-31 00:57:32.916470 (Thread-1): Began running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:57:32.917938 (Thread-1): 18:57:32 | 2 of 6 START table model dbt.covid_us................................ [RUN]
2021-01-31 00:57:32.918262 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:57:32.918387 (Thread-1): Compiling model.jrtests_learn_dbt.covid_us
2021-01-31 00:57:32.927044 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:57:32.927384 (Thread-1): finished collecting timing info
2021-01-31 00:57:32.931446 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.covid_us"
2021-01-31 00:57:32.932178 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:57:32.932272 (Thread-1): On model.jrtests_learn_dbt.covid_us: BEGIN
2021-01-31 00:57:32.932360 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:57:33.581963 (Thread-1): SQL status: SUCCESS 1 in 0.65 seconds
2021-01-31 00:57:33.582227 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:57:33.582383 (Thread-1): On model.jrtests_learn_dbt.covid_us: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.covid_us"} */


      create or replace transient table analytics.dbt.covid_us  as
      (


 select
   *
 from
  "COVID19_BY_STARSCHEMA"."PUBLIC"."JHU_COVID_19"
 where
    date <=current_date
  and
    country_region = 'United States'


      );
2021-01-31 00:57:37.828168 (Thread-1): SQL status: SUCCESS 1 in 4.25 seconds
2021-01-31 00:57:37.829758 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:57:37.830008 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-01-31 00:57:37.830131 (Thread-1): On model.jrtests_learn_dbt.covid_us: COMMIT
2021-01-31 00:57:37.970320 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-01-31 00:57:37.973261 (Thread-1): finished collecting timing info
2021-01-31 00:57:37.973601 (Thread-1): On model.jrtests_learn_dbt.covid_us: Close
2021-01-31 00:57:38.142766 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4928ccc2-74d3-43ec-af7a-b8426a51fa32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8bdac0>]}
2021-01-31 00:57:38.144305 (Thread-1): 18:57:38 | 2 of 6 OK created table model dbt.covid_us........................... [SUCCESS 1 in 5.22s]
2021-01-31 00:57:38.144459 (Thread-1): Finished running node model.jrtests_learn_dbt.covid_us
2021-01-31 00:57:38.144610 (Thread-1): Began running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:57:38.145767 (Thread-1): 18:57:38 | 3 of 6 START table model dbt.cumulative_orders_by_date............... [RUN]
2021-01-31 00:57:38.146059 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:57:38.146181 (Thread-1): Compiling model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:57:38.154094 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:57:38.154441 (Thread-1): finished collecting timing info
2021-01-31 00:57:38.158346 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.cumulative_orders_by_date"
2021-01-31 00:57:38.159214 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:57:38.159304 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: BEGIN
2021-01-31 00:57:38.159388 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:57:39.081549 (Thread-1): SQL status: SUCCESS 1 in 0.92 seconds
2021-01-31 00:57:39.081807 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:57:39.081959 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.cumulative_orders_by_date"} */


      create or replace transient table analytics.dbt.cumulative_orders_by_date  as
      (

select o_orderdate,
       o_totalprice,
       sum(o_totalprice)
           over (order by o_orderdate
               rows between unbounded preceding and current row)
               as "ORDERS SO FAR THIS WEEK"
    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS"
    order by o_orderdate
      );
2021-01-31 00:57:41.522723 (Thread-1): SQL status: SUCCESS 1 in 2.44 seconds
2021-01-31 00:57:41.524132 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:57:41.524338 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-01-31 00:57:41.524460 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: COMMIT
2021-01-31 00:57:41.641850 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-31 00:57:41.644957 (Thread-1): finished collecting timing info
2021-01-31 00:57:41.645292 (Thread-1): On model.jrtests_learn_dbt.cumulative_orders_by_date: Close
2021-01-31 00:57:41.839452 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4928ccc2-74d3-43ec-af7a-b8426a51fa32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b678fd0>]}
2021-01-31 00:57:41.840984 (Thread-1): 18:57:41 | 3 of 6 OK created table model dbt.cumulative_orders_by_date.......... [SUCCESS 1 in 3.69s]
2021-01-31 00:57:41.841175 (Thread-1): Finished running node model.jrtests_learn_dbt.cumulative_orders_by_date
2021-01-31 00:57:41.841361 (Thread-1): Began running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:57:41.842561 (Thread-1): 18:57:41 | 4 of 6 START table model dbt.snowflake_customer_purchases............ [RUN]
2021-01-31 00:57:41.842951 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:57:41.843082 (Thread-1): Compiling model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:57:41.850541 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:57:41.850889 (Thread-1): finished collecting timing info
2021-01-31 00:57:41.854933 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.snowflake_customer_purchases"
2021-01-31 00:57:41.855857 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:57:41.855949 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: BEGIN
2021-01-31 00:57:41.856049 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:57:42.703676 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-01-31 00:57:42.703941 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:57:42.704097 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.snowflake_customer_purchases"} */


      create or replace transient table analytics.dbt.snowflake_customer_purchases  as
      (

SELECT

  c.c_custkey,
  c.c_name,
  c.c_nationkey as nation,
  sum(o.o_totalprice) as total_order_price

from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER" c
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS" o

on c_custkey = o.o_custkey

group by

  c.c_custkey,
  c.c_name,
  c.c_nationkey
      );
2021-01-31 00:57:44.595145 (Thread-1): SQL status: SUCCESS 1 in 1.89 seconds
2021-01-31 00:57:44.596730 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:57:44.597003 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-01-31 00:57:44.597156 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: COMMIT
2021-01-31 00:57:44.718674 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2021-01-31 00:57:44.721627 (Thread-1): finished collecting timing info
2021-01-31 00:57:44.721957 (Thread-1): On model.jrtests_learn_dbt.snowflake_customer_purchases: Close
2021-01-31 00:57:44.956482 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4928ccc2-74d3-43ec-af7a-b8426a51fa32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8a10d0>]}
2021-01-31 00:57:44.958060 (Thread-1): 18:57:44 | 4 of 6 OK created table model dbt.snowflake_customer_purchases....... [SUCCESS 1 in 3.11s]
2021-01-31 00:57:44.958246 (Thread-1): Finished running node model.jrtests_learn_dbt.snowflake_customer_purchases
2021-01-31 00:57:44.958419 (Thread-1): Began running node model.jrtests_learn_dbt.time
2021-01-31 00:57:44.959518 (Thread-1): 18:57:44 | 5 of 6 START table model dbt.time.................................... [RUN]
2021-01-31 00:57:44.959834 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:57:44.959969 (Thread-1): Compiling model.jrtests_learn_dbt.time
2021-01-31 00:57:44.968993 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:57:44.969362 (Thread-1): finished collecting timing info
2021-01-31 00:57:44.973819 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.time"
2021-01-31 00:57:44.974750 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:57:44.974847 (Thread-1): On model.jrtests_learn_dbt.time: BEGIN
2021-01-31 00:57:44.974951 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:57:46.028798 (Thread-1): SQL status: SUCCESS 1 in 1.05 seconds
2021-01-31 00:57:46.029048 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:57:46.029195 (Thread-1): On model.jrtests_learn_dbt.time: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.time"} */


      create or replace transient table analytics.dbt.time  as
      (


SELECT
  To_time(Concat(t_hour :: VARCHAR, ':', t_minute, ':', t_second)) TIME,
  current_date last_update_date,
  current_time last_update_time
FROM
  "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."TIME_DIM"
WHERE
  TIME <= current_time
ORDER  BY TIME DESC


      );
2021-01-31 00:57:47.462421 (Thread-1): SQL status: SUCCESS 1 in 1.43 seconds
2021-01-31 00:57:47.463992 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:57:47.464249 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.time".
2021-01-31 00:57:47.464396 (Thread-1): On model.jrtests_learn_dbt.time: COMMIT
2021-01-31 00:57:47.596011 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2021-01-31 00:57:47.598874 (Thread-1): finished collecting timing info
2021-01-31 00:57:47.599209 (Thread-1): On model.jrtests_learn_dbt.time: Close
2021-01-31 00:57:47.852930 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4928ccc2-74d3-43ec-af7a-b8426a51fa32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b840a60>]}
2021-01-31 00:57:47.854430 (Thread-1): 18:57:47 | 5 of 6 OK created table model dbt.time............................... [SUCCESS 1 in 2.89s]
2021-01-31 00:57:47.854613 (Thread-1): Finished running node model.jrtests_learn_dbt.time
2021-01-31 00:57:47.854797 (Thread-1): Began running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:57:47.855888 (Thread-1): 18:57:47 | 6 of 6 START table model dbt.my_second_dbt_model..................... [RUN]
2021-01-31 00:57:47.856286 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:57:47.856424 (Thread-1): Compiling model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:57:47.865236 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-31 00:57:47.865626 (Thread-1): finished collecting timing info
2021-01-31 00:57:47.869752 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_second_dbt_model"
2021-01-31 00:57:47.870417 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:57:47.870512 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: BEGIN
2021-01-31 00:57:47.870601 (Thread-1): Opening a new connection, currently in state closed
2021-01-31 00:57:48.651163 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2021-01-31 00:57:48.651422 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:57:48.651599 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "sf", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_second_dbt_model"} */


      create or replace transient table analytics.dbt.my_second_dbt_model  as
      (-- Use the `ref` function to select from other models

select *
from analytics.dbt.first_model
where id = 1
      );
2021-01-31 00:57:49.920361 (Thread-1): SQL status: SUCCESS 1 in 1.27 seconds
2021-01-31 00:57:49.921812 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-31 00:57:49.922021 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-01-31 00:57:49.922144 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: COMMIT
2021-01-31 00:57:50.070718 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-01-31 00:57:50.073483 (Thread-1): finished collecting timing info
2021-01-31 00:57:50.073764 (Thread-1): On model.jrtests_learn_dbt.my_second_dbt_model: Close
2021-01-31 00:57:50.241235 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4928ccc2-74d3-43ec-af7a-b8426a51fa32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b940c40>]}
2021-01-31 00:57:50.242797 (Thread-1): 18:57:50 | 6 of 6 OK created table model dbt.my_second_dbt_model................ [SUCCESS 1 in 2.38s]
2021-01-31 00:57:50.242982 (Thread-1): Finished running node model.jrtests_learn_dbt.my_second_dbt_model
2021-01-31 00:57:50.244183 (MainThread): Acquiring new snowflake connection "master".
2021-01-31 00:57:50.244397 (MainThread): Using snowflake connection "master".
2021-01-31 00:57:50.244500 (MainThread): On master: BEGIN
2021-01-31 00:57:50.244600 (MainThread): Opening a new connection, currently in state closed
2021-01-31 00:57:51.322179 (MainThread): SQL status: SUCCESS 1 in 1.08 seconds
2021-01-31 00:57:51.322457 (MainThread): On master: COMMIT
2021-01-31 00:57:51.322707 (MainThread): Using snowflake connection "master".
2021-01-31 00:57:51.322859 (MainThread): On master: COMMIT
2021-01-31 00:57:51.763233 (MainThread): SQL status: SUCCESS 1 in 0.44 seconds
2021-01-31 00:57:51.763520 (MainThread): On master: Close
2021-01-31 00:57:51.949768 (MainThread): 18:57:51 | 
2021-01-31 00:57:51.950001 (MainThread): 18:57:51 | Finished running 6 table models in 25.05s.
2021-01-31 00:57:51.950158 (MainThread): Connection 'master' was properly closed.
2021-01-31 00:57:51.950328 (MainThread): Connection 'model.jrtests_learn_dbt.my_second_dbt_model' was properly closed.
2021-01-31 00:57:51.969854 (MainThread): 
2021-01-31 00:57:51.969978 (MainThread): Completed successfully
2021-01-31 00:57:51.970089 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-01-31 00:57:51.970239 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5dfa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5df4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5dfdf0>]}
2021-01-31 00:57:51.970411 (MainThread): Flushing usage events
2021-02-23 15:18:40.970352 (MainThread): Running with dbt=0.19.0
2021-02-23 15:18:41.768645 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['snowflake_customer_purchases.sql'], partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-23 15:18:41.769955 (MainThread): Tracking: tracking
2021-02-23 15:18:41.770236 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d208e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d20a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d2c0a0>]}
2021-02-23 15:18:41.791627 (MainThread): Partial parsing not enabled
2021-02-23 15:18:41.793070 (MainThread): Parsing macros/catalog.sql
2021-02-23 15:18:41.795341 (MainThread): Parsing macros/adapters.sql
2021-02-23 15:18:41.824542 (MainThread): Parsing macros/materializations/merge.sql
2021-02-23 15:18:41.826586 (MainThread): Parsing macros/materializations/view.sql
2021-02-23 15:18:41.828440 (MainThread): Parsing macros/materializations/table.sql
2021-02-23 15:18:41.833003 (MainThread): Parsing macros/materializations/incremental.sql
2021-02-23 15:18:41.844039 (MainThread): Parsing macros/core.sql
2021-02-23 15:18:41.848184 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-23 15:18:41.857591 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-23 15:18:41.859836 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-23 15:18:41.877499 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-23 15:18:41.909466 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-23 15:18:41.930896 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-23 15:18:41.932864 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-23 15:18:41.938633 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-23 15:18:41.951806 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-23 15:18:41.958664 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-23 15:18:41.965051 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-23 15:18:41.969872 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-23 15:18:41.970936 (MainThread): Parsing macros/etc/query.sql
2021-02-23 15:18:41.972113 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-23 15:18:41.974029 (MainThread): Parsing macros/etc/datetime.sql
2021-02-23 15:18:41.982640 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-23 15:18:41.984848 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-23 15:18:41.986741 (MainThread): Parsing macros/adapters/common.sql
2021-02-23 15:18:42.027315 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-23 15:18:42.029369 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-23 15:18:42.031027 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-23 15:18:42.032846 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-23 15:18:42.040198 (MainThread): Partial parsing not enabled
2021-02-23 15:18:42.078433 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-23 15:18:42.100401 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-02-23 15:18:42.145877 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-02-23 15:18:42.160276 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-02-23 15:18:42.178167 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-02-23 15:18:42.190805 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-02-23 15:18:42.446553 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b79ae20-df17-46f6-8022-9f84e4de62bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111045970>]}
2021-02-23 15:18:42.500832 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-02-23 15:18:42.501130 (MainThread): The selector 'snowflake_customer_purchases.sql' does not match any nodes and will be ignored
2021-02-23 15:18:42.501658 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-02-23 15:18:42.501876 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11100ceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d85730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fdcf70>]}
2021-02-23 15:18:42.502015 (MainThread): Flushing usage events
2021-02-23 15:18:42.904423 (MainThread): Connection 'model.jrtests_learn_dbt.snowflake_customer_purchases' was properly closed.
2021-02-24 20:46:09.494253 (MainThread): Running with dbt=0.19.0
2021-02-24 20:46:10.301994 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['my_first_dbt_model.sql'], partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-24 20:46:10.303161 (MainThread): Tracking: tracking
2021-02-24 20:46:10.303426 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d4f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ca6970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ca6a00>]}
2021-02-24 20:46:10.324977 (MainThread): Partial parsing not enabled
2021-02-24 20:46:10.326045 (MainThread): Parsing macros/catalog.sql
2021-02-24 20:46:10.328367 (MainThread): Parsing macros/adapters.sql
2021-02-24 20:46:10.356899 (MainThread): Parsing macros/materializations/merge.sql
2021-02-24 20:46:10.359040 (MainThread): Parsing macros/materializations/view.sql
2021-02-24 20:46:10.360659 (MainThread): Parsing macros/materializations/table.sql
2021-02-24 20:46:10.364863 (MainThread): Parsing macros/materializations/incremental.sql
2021-02-24 20:46:10.375515 (MainThread): Parsing macros/core.sql
2021-02-24 20:46:10.379679 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-24 20:46:10.388413 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-24 20:46:10.391129 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-24 20:46:10.411360 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-24 20:46:10.443327 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-24 20:46:10.464355 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-24 20:46:10.466307 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-24 20:46:10.472436 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-24 20:46:10.485783 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-24 20:46:10.492394 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-24 20:46:10.498880 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-24 20:46:10.503891 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-24 20:46:10.504940 (MainThread): Parsing macros/etc/query.sql
2021-02-24 20:46:10.506119 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-24 20:46:10.507884 (MainThread): Parsing macros/etc/datetime.sql
2021-02-24 20:46:10.516529 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-24 20:46:10.518825 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-24 20:46:10.520652 (MainThread): Parsing macros/adapters/common.sql
2021-02-24 20:46:10.562966 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-24 20:46:10.565059 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-24 20:46:10.567308 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-24 20:46:10.569479 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-24 20:46:10.578692 (MainThread): Partial parsing not enabled
2021-02-24 20:46:10.615993 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-24 20:46:10.638667 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-02-24 20:46:10.683829 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-02-24 20:46:10.697001 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-02-24 20:46:10.714070 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-02-24 20:46:10.725950 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-02-24 20:46:10.984213 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dcbc3902-9377-42be-bbd2-82427ea9e25d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111edd7f0>]}
2021-02-24 20:46:11.038751 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-02-24 20:46:11.039069 (MainThread): The selector 'my_first_dbt_model.sql' does not match any nodes and will be ignored
2021-02-24 20:46:11.040053 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-02-24 20:46:11.040420 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f5be80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e148b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fb06a0>]}
2021-02-24 20:46:11.040567 (MainThread): Flushing usage events
2021-02-24 20:46:11.452993 (MainThread): Connection 'model.jrtests_learn_dbt.snowflake_customer_purchases' was properly closed.
2021-02-24 20:48:38.278287 (MainThread): Running with dbt=0.19.0
2021-02-24 20:48:38.758556 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['my_first_dbt_model'], partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-24 20:48:38.759230 (MainThread): Tracking: tracking
2021-02-24 20:48:38.759484 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef71f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e509d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e50a60>]}
2021-02-24 20:48:38.779056 (MainThread): Partial parsing not enabled
2021-02-24 20:48:38.780109 (MainThread): Parsing macros/catalog.sql
2021-02-24 20:48:38.782302 (MainThread): Parsing macros/adapters.sql
2021-02-24 20:48:38.809544 (MainThread): Parsing macros/materializations/merge.sql
2021-02-24 20:48:38.811448 (MainThread): Parsing macros/materializations/view.sql
2021-02-24 20:48:38.812858 (MainThread): Parsing macros/materializations/table.sql
2021-02-24 20:48:38.816757 (MainThread): Parsing macros/materializations/incremental.sql
2021-02-24 20:48:38.826054 (MainThread): Parsing macros/core.sql
2021-02-24 20:48:38.829540 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-24 20:48:38.837647 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-24 20:48:38.839229 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-24 20:48:38.856348 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-24 20:48:38.886817 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-24 20:48:38.908006 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-24 20:48:38.910007 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-24 20:48:38.916195 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-24 20:48:38.929476 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-24 20:48:38.935880 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-24 20:48:38.942144 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-24 20:48:38.946895 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-24 20:48:38.947778 (MainThread): Parsing macros/etc/query.sql
2021-02-24 20:48:38.948764 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-24 20:48:38.950292 (MainThread): Parsing macros/etc/datetime.sql
2021-02-24 20:48:38.958541 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-24 20:48:38.960325 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-24 20:48:38.961853 (MainThread): Parsing macros/adapters/common.sql
2021-02-24 20:48:39.005314 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-24 20:48:39.007486 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-24 20:48:39.009236 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-24 20:48:39.011222 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-24 20:48:39.018962 (MainThread): Partial parsing not enabled
2021-02-24 20:48:39.053876 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-24 20:48:39.074492 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-02-24 20:48:39.114704 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-02-24 20:48:39.127598 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-02-24 20:48:39.144299 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-02-24 20:48:39.156859 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-02-24 20:48:39.403446 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47779fe8-e1cf-4d96-8c04-8a3e12a2f228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fee310>]}
2021-02-24 20:48:39.458277 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-02-24 20:48:39.459125 (MainThread): 
2021-02-24 20:48:39.459410 (MainThread): Acquiring new snowflake connection "master".
2021-02-24 20:48:39.460557 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-02-24 20:48:39.472121 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-02-24 20:48:39.472201 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-02-24 20:48:39.472273 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-24 20:48:40.727443 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 1.26 seconds
2021-02-24 20:48:40.731166 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-02-24 20:48:40.865768 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt".
2021-02-24 20:48:40.866128 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_dbt".
2021-02-24 20:48:40.866339 (ThreadPoolExecutor-0_0): Creating schema "analytics.dbt"
2021-02-24 20:48:40.872428 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt".
2021-02-24 20:48:40.872541 (ThreadPoolExecutor-0_0): On create_analytics_dbt: BEGIN
2021-02-24 20:48:40.872643 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-02-24 20:48:41.455452 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.58 seconds
2021-02-24 20:48:41.455723 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_dbt".
2021-02-24 20:48:41.455880 (ThreadPoolExecutor-0_0): On create_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "connection_name": "create_analytics_dbt"} */
create schema if not exists analytics.dbt
2021-02-24 20:48:41.653851 (ThreadPoolExecutor-0_0): Snowflake query id: 019a8320-00ed-4acf-0000-000086c98009
2021-02-24 20:48:41.654068 (ThreadPoolExecutor-0_0): Snowflake error: 003041 (42710): SQL compilation error:
Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
2021-02-24 20:48:41.654282 (ThreadPoolExecutor-0_0): Error running SQL: macro create_schema
2021-02-24 20:48:41.654425 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-02-24 20:48:41.654583 (ThreadPoolExecutor-0_0): On create_analytics_dbt: ROLLBACK
2021-02-24 20:48:41.808242 (ThreadPoolExecutor-0_0): On create_analytics_dbt: Close
2021-02-24 20:48:41.920211 (MainThread): Connection 'master' was properly closed.
2021-02-24 20:48:41.920396 (MainThread): Connection 'create_analytics_dbt' was properly closed.
2021-02-24 20:48:41.920605 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc9ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10610cdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10618c0a0>]}
2021-02-24 20:48:41.920853 (MainThread): Flushing usage events
2021-02-24 20:48:42.296599 (MainThread): Encountered an error:
2021-02-24 20:48:42.296838 (MainThread): Database Error
  003041 (42710): SQL compilation error:
  Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
2021-02-24 20:48:42.311872 (MainThread): Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003041 (42710): SQL compilation error:
Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 426, in run
    result = self.execute_with_hooks(selected_uids)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 383, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/run.py", line 408, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 538, in create_schemas
    create_future.result()
  File "/usr/local/Cellar/python@3.8/3.8.7/Frameworks/Python.framework/Versions/3.8/lib/python3.8/concurrent/futures/_base.py", line 432, in result
    return self.__get_result()
  File "/usr/local/Cellar/python@3.8/3.8.7/Frameworks/Python.framework/Versions/3.8/lib/python3.8/concurrent/futures/_base.py", line 388, in __get_result
    raise self._exception
  File "/usr/local/Cellar/python@3.8/3.8.7/Frameworks/Python.framework/Versions/3.8/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/runnable.py", line 500, in create_schema
    adapter.create_schema(relation)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/impl.py", line 182, in create_schema
    self.execute_macro(CREATE_SCHEMA_MACRO_NAME, kwargs=kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 19, in macro
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 28, in macro
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/Cellar/python@3.8/3.8.7/Frameworks/Python.framework/Versions/3.8/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  003041 (42710): SQL compilation error:
  Schema 'DBT' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.

2021-02-24 20:56:33.223325 (MainThread): Running with dbt=0.19.0
2021-02-24 20:56:33.707399 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['my_first_dbt_model'], partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-24 20:56:33.708080 (MainThread): Tracking: tracking
2021-02-24 20:56:33.708330 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048385b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057928b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105792940>]}
2021-02-24 20:56:33.728965 (MainThread): Partial parsing not enabled
2021-02-24 20:56:33.729888 (MainThread): Parsing macros/catalog.sql
2021-02-24 20:56:33.732038 (MainThread): Parsing macros/adapters.sql
2021-02-24 20:56:33.759000 (MainThread): Parsing macros/materializations/merge.sql
2021-02-24 20:56:33.761149 (MainThread): Parsing macros/materializations/view.sql
2021-02-24 20:56:33.762524 (MainThread): Parsing macros/materializations/table.sql
2021-02-24 20:56:33.766565 (MainThread): Parsing macros/materializations/incremental.sql
2021-02-24 20:56:33.776153 (MainThread): Parsing macros/core.sql
2021-02-24 20:56:33.779866 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-24 20:56:33.787908 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-24 20:56:33.789501 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-24 20:56:33.806670 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-24 20:56:33.839830 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-24 20:56:33.859169 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-24 20:56:33.860886 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-24 20:56:33.866623 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-24 20:56:33.880031 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-24 20:56:33.886363 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-24 20:56:33.893970 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-24 20:56:33.898503 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-24 20:56:33.899360 (MainThread): Parsing macros/etc/query.sql
2021-02-24 20:56:33.900315 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-24 20:56:33.901797 (MainThread): Parsing macros/etc/datetime.sql
2021-02-24 20:56:33.910401 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-24 20:56:33.912294 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-24 20:56:33.913862 (MainThread): Parsing macros/adapters/common.sql
2021-02-24 20:56:33.954260 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-24 20:56:33.956048 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-24 20:56:33.957470 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-24 20:56:33.959050 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-24 20:56:33.966287 (MainThread): Partial parsing not enabled
2021-02-24 20:56:34.000862 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-24 20:56:34.021013 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-02-24 20:56:34.060588 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-02-24 20:56:34.073298 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-02-24 20:56:34.090520 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-02-24 20:56:34.104126 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-02-24 20:56:34.352961 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11846be5-1522-4980-9e40-101ad3375d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105927fd0>]}
2021-02-24 20:56:34.406818 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-02-24 20:56:34.407653 (MainThread): 
2021-02-24 20:56:34.407935 (MainThread): Acquiring new snowflake connection "master".
2021-02-24 20:56:34.409144 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-02-24 20:56:34.420710 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-02-24 20:56:34.420791 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-02-24 20:56:34.420868 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-24 20:56:35.146023 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 0.73 seconds
2021-02-24 20:56:35.150809 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-02-24 20:56:35.286459 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-02-24 20:56:35.293086 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-02-24 20:56:35.293190 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-02-24 20:56:35.293278 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-02-24 20:56:35.673339 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.38 seconds
2021-02-24 20:56:35.673978 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-02-24 20:56:35.780551 (MainThread): Using snowflake connection "master".
2021-02-24 20:56:35.780744 (MainThread): On master: BEGIN
2021-02-24 20:56:35.780880 (MainThread): Opening a new connection, currently in state init
2021-02-24 20:56:36.635498 (MainThread): SQL status: SUCCESS 1 in 0.85 seconds
2021-02-24 20:56:36.635779 (MainThread): On master: COMMIT
2021-02-24 20:56:36.636038 (MainThread): Using snowflake connection "master".
2021-02-24 20:56:36.636188 (MainThread): On master: COMMIT
2021-02-24 20:56:36.740531 (MainThread): SQL status: SUCCESS 1 in 0.10 seconds
2021-02-24 20:56:36.740816 (MainThread): On master: Close
2021-02-24 20:56:36.838159 (MainThread): 14:56:36 | Concurrency: 1 threads (target='dev')
2021-02-24 20:56:36.838411 (MainThread): 14:56:36 | 
2021-02-24 20:56:36.839561 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-02-24 20:56:36.840839 (Thread-1): 14:56:36 | 1 of 1 START table model dbt.first_model............................. [RUN]
2021-02-24 20:56:36.841143 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-24 20:56:36.841273 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-02-24 20:56:36.861075 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-02-24 20:56:36.861671 (Thread-1): finished collecting timing info
2021-02-24 20:56:36.893849 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-02-24 20:56:36.894989 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-24 20:56:36.895083 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-02-24 20:56:36.895173 (Thread-1): Opening a new connection, currently in state closed
2021-02-24 20:56:37.518971 (Thread-1): SQL status: SUCCESS 1 in 0.62 seconds
2021-02-24 20:56:37.519232 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-24 20:56:37.519383 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, True as first_variable
from source_data
where id >= 2

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-02-24 20:56:37.643446 (Thread-1): Snowflake query id: 019a8328-0007-806d-0000-000086c970c5
2021-02-24 20:56:37.643676 (Thread-1): Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

2021-02-24 20:56:37.643914 (Thread-1): finished collecting timing info
2021-02-24 20:56:37.644368 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: ROLLBACK
2021-02-24 20:56:37.745148 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-02-24 20:56:37.851127 (Thread-1): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target/run/jrtests_learn_dbt/models/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/Cellar/python@3.8/3.8.7/Frameworks/Python.framework/Versions/3.8/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target/run/jrtests_learn_dbt/models/example/my_first_dbt_model.sql
2021-02-24 20:56:37.855030 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11846be5-1522-4980-9e40-101ad3375d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e23250>]}
2021-02-24 20:56:37.856332 (Thread-1): 14:56:37 | 1 of 1 ERROR creating table model dbt.first_model.................... [ERROR in 1.01s]
2021-02-24 20:56:37.856485 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-02-24 20:56:37.857389 (MainThread): Acquiring new snowflake connection "master".
2021-02-24 20:56:37.857575 (MainThread): Using snowflake connection "master".
2021-02-24 20:56:37.857662 (MainThread): On master: BEGIN
2021-02-24 20:56:37.857749 (MainThread): Opening a new connection, currently in state closed
2021-02-24 20:56:38.216639 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-02-24 20:56:38.216876 (MainThread): On master: COMMIT
2021-02-24 20:56:38.217098 (MainThread): Using snowflake connection "master".
2021-02-24 20:56:38.217224 (MainThread): On master: COMMIT
2021-02-24 20:56:38.318176 (MainThread): SQL status: SUCCESS 1 in 0.10 seconds
2021-02-24 20:56:38.318461 (MainThread): On master: Close
2021-02-24 20:56:38.415229 (MainThread): 14:56:38 | 
2021-02-24 20:56:38.415462 (MainThread): 14:56:38 | Finished running 1 table model in 4.01s.
2021-02-24 20:56:38.415618 (MainThread): Connection 'master' was properly closed.
2021-02-24 20:56:38.415732 (MainThread): Connection 'model.jrtests_learn_dbt.my_first_dbt_model' was properly closed.
2021-02-24 20:56:38.475194 (MainThread): 
2021-02-24 20:56:38.475353 (MainThread): Completed with 1 error and 0 warnings:
2021-02-24 20:56:38.475455 (MainThread): 
2021-02-24 20:56:38.475554 (MainThread): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-02-24 20:56:38.475641 (MainThread):   000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
2021-02-24 20:56:38.475721 (MainThread):   
2021-02-24 20:56:38.475798 (MainThread):   compiled SQL at target/run/jrtests_learn_dbt/models/example/my_first_dbt_model.sql
2021-02-24 20:56:38.475884 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-02-24 20:56:38.476037 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059093a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d04d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d04850>]}
2021-02-24 20:56:38.476206 (MainThread): Flushing usage events
2021-02-24 21:07:23.555253 (MainThread): Running with dbt=0.19.0
2021-02-24 21:07:24.041825 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['my_first_dbt_model'], partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-24 21:07:24.042811 (MainThread): Tracking: tracking
2021-02-24 21:07:24.043026 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f236880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11018d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11018d9a0>]}
2021-02-24 21:07:24.064351 (MainThread): Partial parsing not enabled
2021-02-24 21:07:24.065296 (MainThread): Parsing macros/catalog.sql
2021-02-24 21:07:24.067603 (MainThread): Parsing macros/adapters.sql
2021-02-24 21:07:24.095305 (MainThread): Parsing macros/materializations/merge.sql
2021-02-24 21:07:24.097220 (MainThread): Parsing macros/materializations/view.sql
2021-02-24 21:07:24.098625 (MainThread): Parsing macros/materializations/table.sql
2021-02-24 21:07:24.102552 (MainThread): Parsing macros/materializations/incremental.sql
2021-02-24 21:07:24.112021 (MainThread): Parsing macros/core.sql
2021-02-24 21:07:24.115621 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-24 21:07:24.123778 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-24 21:07:24.125581 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-24 21:07:24.142395 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-24 21:07:24.172483 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-24 21:07:24.194106 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-24 21:07:24.195860 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-24 21:07:24.201993 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-24 21:07:24.214942 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-24 21:07:24.221274 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-24 21:07:24.227138 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-24 21:07:24.231767 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-24 21:07:24.232632 (MainThread): Parsing macros/etc/query.sql
2021-02-24 21:07:24.233601 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-24 21:07:24.235119 (MainThread): Parsing macros/etc/datetime.sql
2021-02-24 21:07:24.243269 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-24 21:07:24.245150 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-24 21:07:24.246691 (MainThread): Parsing macros/adapters/common.sql
2021-02-24 21:07:24.285914 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-24 21:07:24.287639 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-24 21:07:24.289046 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-24 21:07:24.290665 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-24 21:07:24.297660 (MainThread): Partial parsing not enabled
2021-02-24 21:07:24.333691 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-24 21:07:24.353607 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-02-24 21:07:24.403127 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-02-24 21:07:24.418883 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-02-24 21:07:24.436980 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-02-24 21:07:24.450505 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-02-24 21:07:24.696114 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58eff5cf-e443-4810-b379-6aec0bf0db47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110330100>]}
2021-02-24 21:07:24.750229 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-02-24 21:07:24.751041 (MainThread): 
2021-02-24 21:07:24.751316 (MainThread): Acquiring new snowflake connection "master".
2021-02-24 21:07:24.752435 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-02-24 21:07:24.764102 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-02-24 21:07:24.764185 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-02-24 21:07:24.764258 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-24 21:07:25.684123 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 0.92 seconds
2021-02-24 21:07:25.688883 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-02-24 21:07:25.827346 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-02-24 21:07:25.833894 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-02-24 21:07:25.833993 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-02-24 21:07:25.834081 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-02-24 21:07:26.521687 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.69 seconds
2021-02-24 21:07:26.522319 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-02-24 21:07:26.653309 (MainThread): Using snowflake connection "master".
2021-02-24 21:07:26.653494 (MainThread): On master: BEGIN
2021-02-24 21:07:26.653626 (MainThread): Opening a new connection, currently in state init
2021-02-24 21:07:27.410263 (MainThread): SQL status: SUCCESS 1 in 0.76 seconds
2021-02-24 21:07:27.410537 (MainThread): On master: COMMIT
2021-02-24 21:07:27.410781 (MainThread): Using snowflake connection "master".
2021-02-24 21:07:27.410925 (MainThread): On master: COMMIT
2021-02-24 21:07:27.582890 (MainThread): SQL status: SUCCESS 1 in 0.17 seconds
2021-02-24 21:07:27.583174 (MainThread): On master: Close
2021-02-24 21:07:27.688848 (MainThread): 15:07:27 | Concurrency: 1 threads (target='dev')
2021-02-24 21:07:27.689081 (MainThread): 15:07:27 | 
2021-02-24 21:07:27.690224 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-02-24 21:07:27.691759 (Thread-1): 15:07:27 | 1 of 1 START table model dbt.first_model............................. [RUN]
2021-02-24 21:07:27.692108 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-24 21:07:27.692240 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-02-24 21:07:27.712270 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-02-24 21:07:27.712661 (Thread-1): finished collecting timing info
2021-02-24 21:07:27.744706 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-02-24 21:07:27.745769 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-24 21:07:27.745871 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-02-24 21:07:27.745960 (Thread-1): Opening a new connection, currently in state closed
2021-02-24 21:07:28.210422 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2021-02-24 21:07:28.210689 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-24 21:07:28.210840 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, True as first_variable
from source_data
where id >= 2

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-02-24 21:07:28.328105 (Thread-1): Snowflake query id: 019a8333-003d-4e5f-0000-000086c970d1
2021-02-24 21:07:28.328327 (Thread-1): Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

2021-02-24 21:07:28.328559 (Thread-1): finished collecting timing info
2021-02-24 21:07:28.329005 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: ROLLBACK
2021-02-24 21:07:28.491407 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-02-24 21:07:28.617451 (Thread-1): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target/run/jrtests_learn_dbt/models/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/Cellar/python@3.8/3.8.7/Frameworks/Python.framework/Versions/3.8/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target/run/jrtests_learn_dbt/models/example/my_first_dbt_model.sql
2021-02-24 21:07:28.620793 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58eff5cf-e443-4810-b379-6aec0bf0db47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112821550>]}
2021-02-24 21:07:28.622135 (Thread-1): 15:07:28 | 1 of 1 ERROR creating table model dbt.first_model.................... [ERROR in 0.93s]
2021-02-24 21:07:28.622287 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-02-24 21:07:28.623307 (MainThread): Acquiring new snowflake connection "master".
2021-02-24 21:07:28.623521 (MainThread): Using snowflake connection "master".
2021-02-24 21:07:28.623619 (MainThread): On master: BEGIN
2021-02-24 21:07:28.623716 (MainThread): Opening a new connection, currently in state closed
2021-02-24 21:07:29.045145 (MainThread): SQL status: SUCCESS 1 in 0.42 seconds
2021-02-24 21:07:29.045422 (MainThread): On master: COMMIT
2021-02-24 21:07:29.045704 (MainThread): Using snowflake connection "master".
2021-02-24 21:07:29.045822 (MainThread): On master: COMMIT
2021-02-24 21:07:29.204542 (MainThread): SQL status: SUCCESS 1 in 0.16 seconds
2021-02-24 21:07:29.204819 (MainThread): On master: Close
2021-02-24 21:07:29.431612 (MainThread): 15:07:29 | 
2021-02-24 21:07:29.431835 (MainThread): 15:07:29 | Finished running 1 table model in 4.68s.
2021-02-24 21:07:29.431986 (MainThread): Connection 'master' was properly closed.
2021-02-24 21:07:29.432113 (MainThread): Connection 'model.jrtests_learn_dbt.my_first_dbt_model' was properly closed.
2021-02-24 21:07:29.490761 (MainThread): 
2021-02-24 21:07:29.490920 (MainThread): Completed with 1 error and 0 warnings:
2021-02-24 21:07:29.491027 (MainThread): 
2021-02-24 21:07:29.491129 (MainThread): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-02-24 21:07:29.491217 (MainThread):   000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
2021-02-24 21:07:29.491298 (MainThread):   
2021-02-24 21:07:29.491377 (MainThread):   compiled SQL at target/run/jrtests_learn_dbt/models/example/my_first_dbt_model.sql
2021-02-24 21:07:29.491463 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-02-24 21:07:29.491622 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f236220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128428b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112842cd0>]}
2021-02-24 21:07:29.491806 (MainThread): Flushing usage events
2021-02-24 21:08:47.166705 (MainThread): Running with dbt=0.19.0
2021-02-24 21:08:47.640489 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['my_first_dbt_model'], partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-24 21:08:47.641173 (MainThread): Tracking: tracking
2021-02-24 21:08:47.641444 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a381520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2dab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2dabb0>]}
2021-02-24 21:08:47.661393 (MainThread): Partial parsing not enabled
2021-02-24 21:08:47.662276 (MainThread): Parsing macros/catalog.sql
2021-02-24 21:08:47.664341 (MainThread): Parsing macros/adapters.sql
2021-02-24 21:08:47.690862 (MainThread): Parsing macros/materializations/merge.sql
2021-02-24 21:08:47.692723 (MainThread): Parsing macros/materializations/view.sql
2021-02-24 21:08:47.694114 (MainThread): Parsing macros/materializations/table.sql
2021-02-24 21:08:47.698286 (MainThread): Parsing macros/materializations/incremental.sql
2021-02-24 21:08:47.707697 (MainThread): Parsing macros/core.sql
2021-02-24 21:08:47.711117 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-24 21:08:47.719193 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-24 21:08:47.721343 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-24 21:08:47.738220 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-24 21:08:47.775980 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-24 21:08:47.797559 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-24 21:08:47.799466 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-24 21:08:47.805527 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-24 21:08:47.819568 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-24 21:08:47.826943 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-24 21:08:47.833360 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-24 21:08:47.838182 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-24 21:08:47.839082 (MainThread): Parsing macros/etc/query.sql
2021-02-24 21:08:47.840083 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-24 21:08:47.841625 (MainThread): Parsing macros/etc/datetime.sql
2021-02-24 21:08:47.850407 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-24 21:08:47.852267 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-24 21:08:47.853872 (MainThread): Parsing macros/adapters/common.sql
2021-02-24 21:08:47.894090 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-24 21:08:47.896147 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-24 21:08:47.898007 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-24 21:08:47.899641 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-24 21:08:47.907829 (MainThread): Partial parsing not enabled
2021-02-24 21:08:47.946867 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-24 21:08:47.967091 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-02-24 21:08:48.009082 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-02-24 21:08:48.023134 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-02-24 21:08:48.039623 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-02-24 21:08:48.052601 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-02-24 21:08:48.305067 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa3a7e8e-99e1-4cd2-bc54-45e924e676b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7cac70>]}
2021-02-24 21:08:48.361162 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-02-24 21:08:48.362161 (MainThread): 
2021-02-24 21:08:48.362497 (MainThread): Acquiring new snowflake connection "master".
2021-02-24 21:08:48.363737 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-02-24 21:08:48.375572 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-02-24 21:08:48.375659 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-02-24 21:08:48.375737 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-24 21:08:49.152260 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 0.78 seconds
2021-02-24 21:08:49.156996 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-02-24 21:08:49.284261 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-02-24 21:08:49.290879 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-02-24 21:08:49.290983 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-02-24 21:08:49.291073 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-02-24 21:08:50.422777 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 1.13 seconds
2021-02-24 21:08:50.423378 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-02-24 21:08:50.546995 (MainThread): Using snowflake connection "master".
2021-02-24 21:08:50.547183 (MainThread): On master: BEGIN
2021-02-24 21:08:50.547316 (MainThread): Opening a new connection, currently in state init
2021-02-24 21:08:51.170490 (MainThread): SQL status: SUCCESS 1 in 0.62 seconds
2021-02-24 21:08:51.170763 (MainThread): On master: COMMIT
2021-02-24 21:08:51.171014 (MainThread): Using snowflake connection "master".
2021-02-24 21:08:51.171163 (MainThread): On master: COMMIT
2021-02-24 21:08:51.278959 (MainThread): SQL status: SUCCESS 1 in 0.11 seconds
2021-02-24 21:08:51.279267 (MainThread): On master: Close
2021-02-24 21:08:51.368889 (MainThread): 15:08:51 | Concurrency: 1 threads (target='dev')
2021-02-24 21:08:51.369123 (MainThread): 15:08:51 | 
2021-02-24 21:08:51.370579 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-02-24 21:08:51.372130 (Thread-1): 15:08:51 | 1 of 1 START table model dbt.first_model............................. [RUN]
2021-02-24 21:08:51.372444 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-24 21:08:51.372577 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-02-24 21:08:51.393763 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-02-24 21:08:51.394186 (Thread-1): finished collecting timing info
2021-02-24 21:08:51.426088 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-02-24 21:08:51.427185 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-24 21:08:51.427305 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-02-24 21:08:51.427412 (Thread-1): Opening a new connection, currently in state closed
2021-02-24 21:08:52.037692 (Thread-1): SQL status: SUCCESS 1 in 0.61 seconds
2021-02-24 21:08:52.037945 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-24 21:08:52.038100 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



use warehouse compute_wh

with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, True as first_variable
from source_data
where id >= 2

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-02-24 21:08:52.144351 (Thread-1): Snowflake query id: 019a8334-00a3-5e45-0000-000086c9a0a9
2021-02-24 21:08:52.144579 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 0 unexpected 'use'.
syntax error line 20 at position 0 unexpected ')'.
2021-02-24 21:08:52.144817 (Thread-1): finished collecting timing info
2021-02-24 21:08:52.145285 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: ROLLBACK
2021-02-24 21:08:52.266042 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-02-24 21:08:52.391454 (Thread-1): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 0 unexpected 'use'.
  syntax error line 20 at position 0 unexpected ')'.
  compiled SQL at target/run/jrtests_learn_dbt/models/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 12 at position 0 unexpected 'use'.
syntax error line 20 at position 0 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/Cellar/python@3.8/3.8.7/Frameworks/Python.framework/Versions/3.8/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 0 unexpected 'use'.
  syntax error line 20 at position 0 unexpected ')'.
  compiled SQL at target/run/jrtests_learn_dbt/models/example/my_first_dbt_model.sql
2021-02-24 21:08:52.394739 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa3a7e8e-99e1-4cd2-bc54-45e924e676b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b614fa0>]}
2021-02-24 21:08:52.396075 (Thread-1): 15:08:52 | 1 of 1 ERROR creating table model dbt.first_model.................... [ERROR in 1.02s]
2021-02-24 21:08:52.396229 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-02-24 21:08:52.397298 (MainThread): Acquiring new snowflake connection "master".
2021-02-24 21:08:52.397509 (MainThread): Using snowflake connection "master".
2021-02-24 21:08:52.397608 (MainThread): On master: BEGIN
2021-02-24 21:08:52.397704 (MainThread): Opening a new connection, currently in state closed
2021-02-24 21:08:52.844717 (MainThread): SQL status: SUCCESS 1 in 0.45 seconds
2021-02-24 21:08:52.844994 (MainThread): On master: COMMIT
2021-02-24 21:08:52.845244 (MainThread): Using snowflake connection "master".
2021-02-24 21:08:52.845395 (MainThread): On master: COMMIT
2021-02-24 21:08:53.375605 (MainThread): SQL status: SUCCESS 1 in 0.53 seconds
2021-02-24 21:08:53.375912 (MainThread): On master: Close
2021-02-24 21:08:53.484773 (MainThread): 15:08:53 | 
2021-02-24 21:08:53.484997 (MainThread): 15:08:53 | Finished running 1 table model in 5.12s.
2021-02-24 21:08:53.485145 (MainThread): Connection 'master' was properly closed.
2021-02-24 21:08:53.485255 (MainThread): Connection 'model.jrtests_learn_dbt.my_first_dbt_model' was properly closed.
2021-02-24 21:08:53.542295 (MainThread): 
2021-02-24 21:08:53.542459 (MainThread): Completed with 1 error and 0 warnings:
2021-02-24 21:08:53.542561 (MainThread): 
2021-02-24 21:08:53.542658 (MainThread): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-02-24 21:08:53.542744 (MainThread):   001003 (42000): SQL compilation error:
2021-02-24 21:08:53.542823 (MainThread):   syntax error line 12 at position 0 unexpected 'use'.
2021-02-24 21:08:53.542900 (MainThread):   syntax error line 20 at position 0 unexpected ')'.
2021-02-24 21:08:53.542976 (MainThread):   compiled SQL at target/run/jrtests_learn_dbt/models/example/my_first_dbt_model.sql
2021-02-24 21:08:53.543059 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-02-24 21:08:53.543208 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b450c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7c6c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b889610>]}
2021-02-24 21:08:53.543374 (MainThread): Flushing usage events
2021-02-24 21:09:54.910915 (MainThread): Running with dbt=0.19.0
2021-02-24 21:09:55.394571 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['my_first_dbt_model'], partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-24 21:09:55.395130 (MainThread): Tracking: tracking
2021-02-24 21:09:55.395411 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dff8880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef50a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef50ac0>]}
2021-02-24 21:09:55.416816 (MainThread): Partial parsing not enabled
2021-02-24 21:09:55.417981 (MainThread): Parsing macros/catalog.sql
2021-02-24 21:09:55.420156 (MainThread): Parsing macros/adapters.sql
2021-02-24 21:09:55.449888 (MainThread): Parsing macros/materializations/merge.sql
2021-02-24 21:09:55.451986 (MainThread): Parsing macros/materializations/view.sql
2021-02-24 21:09:55.453425 (MainThread): Parsing macros/materializations/table.sql
2021-02-24 21:09:55.457252 (MainThread): Parsing macros/materializations/incremental.sql
2021-02-24 21:09:55.466908 (MainThread): Parsing macros/core.sql
2021-02-24 21:09:55.470778 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-24 21:09:55.479809 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-24 21:09:55.481527 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-24 21:09:55.499886 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-24 21:09:55.530648 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-24 21:09:55.550388 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-24 21:09:55.552133 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-24 21:09:55.558044 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-24 21:09:55.571103 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-24 21:09:55.577558 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-24 21:09:55.583730 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-24 21:09:55.588405 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-24 21:09:55.589286 (MainThread): Parsing macros/etc/query.sql
2021-02-24 21:09:55.590271 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-24 21:09:55.591855 (MainThread): Parsing macros/etc/datetime.sql
2021-02-24 21:09:55.600157 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-24 21:09:55.601982 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-24 21:09:55.603597 (MainThread): Parsing macros/adapters/common.sql
2021-02-24 21:09:55.643567 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-24 21:09:55.645229 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-24 21:09:55.646777 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-24 21:09:55.648302 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-24 21:09:55.656146 (MainThread): Partial parsing not enabled
2021-02-24 21:09:55.689746 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-24 21:09:55.712400 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-02-24 21:09:55.753273 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-02-24 21:09:55.766290 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-02-24 21:09:55.782852 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-02-24 21:09:55.795328 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-02-24 21:09:56.038938 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7acef0c-8b66-4a63-9503-b151582364b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f26da00>]}
2021-02-24 21:09:56.097426 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-02-24 21:09:56.098357 (MainThread): 
2021-02-24 21:09:56.098597 (MainThread): Acquiring new snowflake connection "master".
2021-02-24 21:09:56.099769 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-02-24 21:09:56.111554 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-02-24 21:09:56.111637 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-02-24 21:09:56.111714 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-24 21:09:57.172548 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.06 seconds
2021-02-24 21:09:57.177314 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-02-24 21:09:57.600393 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-02-24 21:09:57.607014 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-02-24 21:09:57.607126 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-02-24 21:09:57.607217 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-02-24 21:09:57.992535 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.39 seconds
2021-02-24 21:09:57.993172 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-02-24 21:09:58.111883 (MainThread): Using snowflake connection "master".
2021-02-24 21:09:58.112076 (MainThread): On master: BEGIN
2021-02-24 21:09:58.112210 (MainThread): Opening a new connection, currently in state init
2021-02-24 21:09:58.805656 (MainThread): SQL status: SUCCESS 1 in 0.69 seconds
2021-02-24 21:09:58.805921 (MainThread): On master: COMMIT
2021-02-24 21:09:58.806165 (MainThread): Using snowflake connection "master".
2021-02-24 21:09:58.806313 (MainThread): On master: COMMIT
2021-02-24 21:09:58.940715 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2021-02-24 21:09:58.941002 (MainThread): On master: Close
2021-02-24 21:09:59.044333 (MainThread): 15:09:59 | Concurrency: 1 threads (target='dev')
2021-02-24 21:09:59.044570 (MainThread): 15:09:59 | 
2021-02-24 21:09:59.045827 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-02-24 21:09:59.047507 (Thread-1): 15:09:59 | 1 of 1 START table model dbt.first_model............................. [RUN]
2021-02-24 21:09:59.047953 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-24 21:09:59.048097 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-02-24 21:09:59.068692 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-02-24 21:09:59.069092 (Thread-1): finished collecting timing info
2021-02-24 21:09:59.100543 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-02-24 21:09:59.101626 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-24 21:09:59.101721 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-02-24 21:09:59.101812 (Thread-1): Opening a new connection, currently in state closed
2021-02-24 21:09:59.834735 (Thread-1): SQL status: SUCCESS 1 in 0.73 seconds
2021-02-24 21:09:59.834993 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-24 21:09:59.835149 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



use warehouse compute_wh;
2021-02-24 21:09:59.970075 (Thread-1): Snowflake query id: 019a8335-0043-e43f-0000-000086c990a9
2021-02-24 21:09:59.970304 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 0 unexpected 'use'.
2021-02-24 21:09:59.970542 (Thread-1): finished collecting timing info
2021-02-24 21:09:59.970997 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: ROLLBACK
2021-02-24 21:10:00.138497 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-02-24 21:10:00.232987 (Thread-1): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 0 unexpected 'use'.
  compiled SQL at target/run/jrtests_learn_dbt/models/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 12 at position 0 unexpected 'use'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/Cellar/python@3.8/3.8.7/Frameworks/Python.framework/Versions/3.8/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 0 unexpected 'use'.
  compiled SQL at target/run/jrtests_learn_dbt/models/example/my_first_dbt_model.sql
2021-02-24 21:10:00.235964 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7acef0c-8b66-4a63-9503-b151582364b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11151a700>]}
2021-02-24 21:10:00.237319 (Thread-1): 15:10:00 | 1 of 1 ERROR creating table model dbt.first_model.................... [ERROR in 1.19s]
2021-02-24 21:10:00.237471 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-02-24 21:10:00.238520 (MainThread): Acquiring new snowflake connection "master".
2021-02-24 21:10:00.238737 (MainThread): Using snowflake connection "master".
2021-02-24 21:10:00.238839 (MainThread): On master: BEGIN
2021-02-24 21:10:00.238940 (MainThread): Opening a new connection, currently in state closed
2021-02-24 21:10:00.743497 (MainThread): SQL status: SUCCESS 1 in 0.50 seconds
2021-02-24 21:10:00.743719 (MainThread): On master: COMMIT
2021-02-24 21:10:00.743917 (MainThread): Using snowflake connection "master".
2021-02-24 21:10:00.744035 (MainThread): On master: COMMIT
2021-02-24 21:10:01.471915 (MainThread): SQL status: SUCCESS 1 in 0.73 seconds
2021-02-24 21:10:01.472201 (MainThread): On master: Close
2021-02-24 21:10:01.615457 (MainThread): 15:10:01 | 
2021-02-24 21:10:01.615692 (MainThread): 15:10:01 | Finished running 1 table model in 5.52s.
2021-02-24 21:10:01.615850 (MainThread): Connection 'master' was properly closed.
2021-02-24 21:10:01.615963 (MainThread): Connection 'model.jrtests_learn_dbt.my_first_dbt_model' was properly closed.
2021-02-24 21:10:01.674629 (MainThread): 
2021-02-24 21:10:01.674813 (MainThread): Completed with 1 error and 0 warnings:
2021-02-24 21:10:01.674922 (MainThread): 
2021-02-24 21:10:01.675027 (MainThread): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-02-24 21:10:01.675120 (MainThread):   001003 (42000): SQL compilation error:
2021-02-24 21:10:01.675203 (MainThread):   syntax error line 12 at position 0 unexpected 'use'.
2021-02-24 21:10:01.675286 (MainThread):   compiled SQL at target/run/jrtests_learn_dbt/models/example/my_first_dbt_model.sql
2021-02-24 21:10:01.675376 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-02-24 21:10:01.675537 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0c9b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f264670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111504490>]}
2021-02-24 21:10:01.675713 (MainThread): Flushing usage events
2021-02-24 21:10:31.022836 (MainThread): Running with dbt=0.19.0
2021-02-24 21:10:31.512585 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['my_first_dbt_model'], partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-24 21:10:31.513233 (MainThread): Tracking: tracking
2021-02-24 21:10:31.513486 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea88640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9d99d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9d9fd0>]}
2021-02-24 21:10:31.533596 (MainThread): Partial parsing not enabled
2021-02-24 21:10:31.534522 (MainThread): Parsing macros/catalog.sql
2021-02-24 21:10:31.536734 (MainThread): Parsing macros/adapters.sql
2021-02-24 21:10:31.564278 (MainThread): Parsing macros/materializations/merge.sql
2021-02-24 21:10:31.566160 (MainThread): Parsing macros/materializations/view.sql
2021-02-24 21:10:31.567555 (MainThread): Parsing macros/materializations/table.sql
2021-02-24 21:10:31.571429 (MainThread): Parsing macros/materializations/incremental.sql
2021-02-24 21:10:31.581121 (MainThread): Parsing macros/core.sql
2021-02-24 21:10:31.584841 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-24 21:10:31.593144 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-24 21:10:31.594798 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-24 21:10:31.611912 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-24 21:10:31.643839 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-24 21:10:31.667902 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-24 21:10:31.669694 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-24 21:10:31.675752 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-24 21:10:31.689199 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-24 21:10:31.696101 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-24 21:10:31.702313 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-24 21:10:31.707463 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-24 21:10:31.708401 (MainThread): Parsing macros/etc/query.sql
2021-02-24 21:10:31.709444 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-24 21:10:31.711073 (MainThread): Parsing macros/etc/datetime.sql
2021-02-24 21:10:31.720614 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-24 21:10:31.722977 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-24 21:10:31.724940 (MainThread): Parsing macros/adapters/common.sql
2021-02-24 21:10:31.765660 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-24 21:10:31.767449 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-24 21:10:31.768868 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-24 21:10:31.770444 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-24 21:10:31.777702 (MainThread): Partial parsing not enabled
2021-02-24 21:10:31.812813 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-24 21:10:31.832816 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-02-24 21:10:31.874642 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-02-24 21:10:31.888367 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-02-24 21:10:31.905043 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-02-24 21:10:31.917586 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-02-24 21:10:32.168523 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12d67413-0088-4e24-a961-9f9a74ee4bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb84be0>]}
2021-02-24 21:10:32.224455 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-02-24 21:10:32.225278 (MainThread): 
2021-02-24 21:10:32.225589 (MainThread): Acquiring new snowflake connection "master".
2021-02-24 21:10:32.226741 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-02-24 21:10:32.238422 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-02-24 21:10:32.238501 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-02-24 21:10:32.238574 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-24 21:10:33.196467 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 0.96 seconds
2021-02-24 21:10:33.201257 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-02-24 21:10:33.448061 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-02-24 21:10:33.454736 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-02-24 21:10:33.454845 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-02-24 21:10:33.454938 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-02-24 21:10:33.831949 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.38 seconds
2021-02-24 21:10:33.832600 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-02-24 21:10:34.864586 (MainThread): Using snowflake connection "master".
2021-02-24 21:10:34.864778 (MainThread): On master: BEGIN
2021-02-24 21:10:34.864912 (MainThread): Opening a new connection, currently in state init
2021-02-24 21:10:35.313983 (MainThread): SQL status: SUCCESS 1 in 0.45 seconds
2021-02-24 21:10:35.314255 (MainThread): On master: COMMIT
2021-02-24 21:10:35.314505 (MainThread): Using snowflake connection "master".
2021-02-24 21:10:35.314653 (MainThread): On master: COMMIT
2021-02-24 21:10:35.469095 (MainThread): SQL status: SUCCESS 1 in 0.15 seconds
2021-02-24 21:10:35.469320 (MainThread): On master: Close
2021-02-24 21:10:35.632430 (MainThread): 15:10:35 | Concurrency: 1 threads (target='dev')
2021-02-24 21:10:35.632666 (MainThread): 15:10:35 | 
2021-02-24 21:10:35.633901 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-02-24 21:10:35.635478 (Thread-1): 15:10:35 | 1 of 1 START table model dbt.first_model............................. [RUN]
2021-02-24 21:10:35.635798 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-24 21:10:35.635931 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-02-24 21:10:35.656169 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-02-24 21:10:35.656559 (Thread-1): finished collecting timing info
2021-02-24 21:10:35.688228 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-02-24 21:10:35.689272 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-24 21:10:35.689373 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-02-24 21:10:35.689464 (Thread-1): Opening a new connection, currently in state closed
2021-02-24 21:10:36.376931 (Thread-1): SQL status: SUCCESS 1 in 0.69 seconds
2021-02-24 21:10:36.377191 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-24 21:10:36.377346 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/




with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, True as first_variable
from source_data
where id >= 2

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-02-24 21:10:36.488308 (Thread-1): Snowflake query id: 019a8336-00d8-d931-0000-000086c970f5
2021-02-24 21:10:36.488539 (Thread-1): Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

2021-02-24 21:10:36.488776 (Thread-1): finished collecting timing info
2021-02-24 21:10:36.489235 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: ROLLBACK
2021-02-24 21:10:36.660454 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-02-24 21:10:36.757833 (Thread-1): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target/run/jrtests_learn_dbt/models/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/Cellar/python@3.8/3.8.7/Frameworks/Python.framework/Versions/3.8/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target/run/jrtests_learn_dbt/models/example/my_first_dbt_model.sql
2021-02-24 21:10:36.761143 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12d67413-0088-4e24-a961-9f9a74ee4bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f939a0>]}
2021-02-24 21:10:36.762489 (Thread-1): 15:10:36 | 1 of 1 ERROR creating table model dbt.first_model.................... [ERROR in 1.13s]
2021-02-24 21:10:36.762648 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-02-24 21:10:36.763706 (MainThread): Acquiring new snowflake connection "master".
2021-02-24 21:10:36.763940 (MainThread): Using snowflake connection "master".
2021-02-24 21:10:36.764042 (MainThread): On master: BEGIN
2021-02-24 21:10:36.764143 (MainThread): Opening a new connection, currently in state closed
2021-02-24 21:10:37.489758 (MainThread): SQL status: SUCCESS 1 in 0.73 seconds
2021-02-24 21:10:37.489984 (MainThread): On master: COMMIT
2021-02-24 21:10:37.490177 (MainThread): Using snowflake connection "master".
2021-02-24 21:10:37.490272 (MainThread): On master: COMMIT
2021-02-24 21:10:37.824636 (MainThread): SQL status: SUCCESS 1 in 0.33 seconds
2021-02-24 21:10:37.824813 (MainThread): On master: Close
2021-02-24 21:10:37.914050 (MainThread): 15:10:37 | 
2021-02-24 21:10:37.914229 (MainThread): 15:10:37 | Finished running 1 table model in 5.69s.
2021-02-24 21:10:37.914352 (MainThread): Connection 'master' was properly closed.
2021-02-24 21:10:37.914442 (MainThread): Connection 'model.jrtests_learn_dbt.my_first_dbt_model' was properly closed.
2021-02-24 21:10:37.967763 (MainThread): 
2021-02-24 21:10:37.967909 (MainThread): Completed with 1 error and 0 warnings:
2021-02-24 21:10:37.968005 (MainThread): 
2021-02-24 21:10:37.968147 (MainThread): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-02-24 21:10:37.968334 (MainThread):   000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
2021-02-24 21:10:37.968428 (MainThread):   
2021-02-24 21:10:37.968498 (MainThread):   compiled SQL at target/run/jrtests_learn_dbt/models/example/my_first_dbt_model.sql
2021-02-24 21:10:37.968576 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-02-24 21:10:37.968724 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa375b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eccc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ecca30>]}
2021-02-24 21:10:37.968893 (MainThread): Flushing usage events
2021-02-24 21:18:20.516800 (MainThread): Running with dbt=0.19.0
2021-02-24 21:18:21.000866 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['my_first_dbt_model'], partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-24 21:18:21.001491 (MainThread): Tracking: tracking
2021-02-24 21:18:21.001792 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c95b4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8b5b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8b5bb0>]}
2021-02-24 21:18:21.021454 (MainThread): Partial parsing not enabled
2021-02-24 21:18:21.022663 (MainThread): Parsing macros/catalog.sql
2021-02-24 21:18:21.024775 (MainThread): Parsing macros/adapters.sql
2021-02-24 21:18:21.058339 (MainThread): Parsing macros/materializations/merge.sql
2021-02-24 21:18:21.060362 (MainThread): Parsing macros/materializations/view.sql
2021-02-24 21:18:21.062888 (MainThread): Parsing macros/materializations/table.sql
2021-02-24 21:18:21.067247 (MainThread): Parsing macros/materializations/incremental.sql
2021-02-24 21:18:21.076872 (MainThread): Parsing macros/core.sql
2021-02-24 21:18:21.080490 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-24 21:18:21.088856 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-24 21:18:21.090496 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-24 21:18:21.107830 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-24 21:18:21.138505 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-24 21:18:21.158694 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-24 21:18:21.160457 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-24 21:18:21.166434 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-24 21:18:21.179649 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-24 21:18:21.186258 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-24 21:18:21.192305 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-24 21:18:21.197101 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-24 21:18:21.197999 (MainThread): Parsing macros/etc/query.sql
2021-02-24 21:18:21.199007 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-24 21:18:21.200576 (MainThread): Parsing macros/etc/datetime.sql
2021-02-24 21:18:21.208789 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-24 21:18:21.210870 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-24 21:18:21.212416 (MainThread): Parsing macros/adapters/common.sql
2021-02-24 21:18:21.253286 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-24 21:18:21.254969 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-24 21:18:21.256519 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-24 21:18:21.258046 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-24 21:18:21.265499 (MainThread): Partial parsing not enabled
2021-02-24 21:18:21.306475 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-24 21:18:21.330283 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-02-24 21:18:21.375050 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-02-24 21:18:21.389348 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-02-24 21:18:21.406072 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-02-24 21:18:21.419045 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-02-24 21:18:21.672485 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bb668af-9693-4912-9499-318bb223d956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbd0970>]}
2021-02-24 21:18:21.725218 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-02-24 21:18:21.726142 (MainThread): 
2021-02-24 21:18:21.726448 (MainThread): Acquiring new snowflake connection "master".
2021-02-24 21:18:21.727563 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-02-24 21:18:21.738875 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-02-24 21:18:21.738957 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-02-24 21:18:21.739031 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-24 21:18:22.474782 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 0.74 seconds
2021-02-24 21:18:22.479534 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-02-24 21:18:22.639912 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-02-24 21:18:22.646577 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-02-24 21:18:22.646681 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-02-24 21:18:22.646768 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-02-24 21:18:23.322441 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.68 seconds
2021-02-24 21:18:23.323077 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-02-24 21:18:23.448592 (MainThread): Using snowflake connection "master".
2021-02-24 21:18:23.448781 (MainThread): On master: BEGIN
2021-02-24 21:18:23.448916 (MainThread): Opening a new connection, currently in state init
2021-02-24 21:18:23.814531 (MainThread): SQL status: SUCCESS 1 in 0.37 seconds
2021-02-24 21:18:23.814802 (MainThread): On master: COMMIT
2021-02-24 21:18:23.815054 (MainThread): Using snowflake connection "master".
2021-02-24 21:18:23.815207 (MainThread): On master: COMMIT
2021-02-24 21:18:23.921641 (MainThread): SQL status: SUCCESS 1 in 0.11 seconds
2021-02-24 21:18:23.921924 (MainThread): On master: Close
2021-02-24 21:18:24.024759 (MainThread): 15:18:24 | Concurrency: 1 threads (target='dev')
2021-02-24 21:18:24.024992 (MainThread): 15:18:24 | 
2021-02-24 21:18:24.026324 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-02-24 21:18:24.027954 (Thread-1): 15:18:24 | 1 of 1 START table model dbt.first_model............................. [RUN]
2021-02-24 21:18:24.028390 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-24 21:18:24.028549 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-02-24 21:18:24.049604 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-02-24 21:18:24.050081 (Thread-1): finished collecting timing info
2021-02-24 21:18:24.086050 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-02-24 21:18:24.087145 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-24 21:18:24.087255 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-02-24 21:18:24.087346 (Thread-1): Opening a new connection, currently in state closed
2021-02-24 21:18:24.496005 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-02-24 21:18:24.496268 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-24 21:18:24.496423 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/




with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, True as first_variable
from source_data
where id >= 2

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-02-24 21:18:24.656226 (Thread-1): Snowflake query id: 019a833e-00cb-8fd7-0000-000086c990f5
2021-02-24 21:18:24.656453 (Thread-1): Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

2021-02-24 21:18:24.656698 (Thread-1): finished collecting timing info
2021-02-24 21:18:24.657154 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: ROLLBACK
2021-02-24 21:18:24.815109 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-02-24 21:18:24.941800 (Thread-1): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target/run/jrtests_learn_dbt/models/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/Cellar/python@3.8/3.8.7/Frameworks/Python.framework/Versions/3.8/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target/run/jrtests_learn_dbt/models/example/my_first_dbt_model.sql
2021-02-24 21:18:24.945158 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bb668af-9693-4912-9499-318bb223d956', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff4f850>]}
2021-02-24 21:18:24.946456 (Thread-1): 15:18:24 | 1 of 1 ERROR creating table model dbt.first_model.................... [ERROR in 0.92s]
2021-02-24 21:18:24.946609 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-02-24 21:18:24.947677 (MainThread): Acquiring new snowflake connection "master".
2021-02-24 21:18:24.947887 (MainThread): Using snowflake connection "master".
2021-02-24 21:18:24.947988 (MainThread): On master: BEGIN
2021-02-24 21:18:24.948088 (MainThread): Opening a new connection, currently in state closed
2021-02-24 21:18:25.582973 (MainThread): SQL status: SUCCESS 1 in 0.63 seconds
2021-02-24 21:18:25.583200 (MainThread): On master: COMMIT
2021-02-24 21:18:25.583401 (MainThread): Using snowflake connection "master".
2021-02-24 21:18:25.583520 (MainThread): On master: COMMIT
2021-02-24 21:18:25.708143 (MainThread): SQL status: SUCCESS 1 in 0.12 seconds
2021-02-24 21:18:25.708428 (MainThread): On master: Close
2021-02-24 21:18:25.822254 (MainThread): 15:18:25 | 
2021-02-24 21:18:25.822479 (MainThread): 15:18:25 | Finished running 1 table model in 4.10s.
2021-02-24 21:18:25.822633 (MainThread): Connection 'master' was properly closed.
2021-02-24 21:18:25.822746 (MainThread): Connection 'model.jrtests_learn_dbt.my_first_dbt_model' was properly closed.
2021-02-24 21:18:25.881409 (MainThread): 
2021-02-24 21:18:25.881569 (MainThread): Completed with 1 error and 0 warnings:
2021-02-24 21:18:25.881673 (MainThread): 
2021-02-24 21:18:25.881772 (MainThread): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-02-24 21:18:25.881864 (MainThread):   000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
2021-02-24 21:18:25.881946 (MainThread):   
2021-02-24 21:18:25.882026 (MainThread):   compiled SQL at target/run/jrtests_learn_dbt/models/example/my_first_dbt_model.sql
2021-02-24 21:18:25.882112 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-02-24 21:18:25.882265 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da564c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff38df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da29c10>]}
2021-02-24 21:18:25.882445 (MainThread): Flushing usage events
2021-02-25 13:31:43.647612 (MainThread): Running with dbt=0.19.0
2021-02-25 13:31:44.205716 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['my_first_dbt_model'], partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-25 13:31:44.207569 (MainThread): Tracking: tracking
2021-02-25 13:31:44.207866 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce861c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dde0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dde09a0>]}
2021-02-25 13:31:44.231842 (MainThread): Partial parsing not enabled
2021-02-25 13:31:44.233730 (MainThread): Parsing macros/catalog.sql
2021-02-25 13:31:44.235939 (MainThread): Parsing macros/adapters.sql
2021-02-25 13:31:44.264395 (MainThread): Parsing macros/materializations/merge.sql
2021-02-25 13:31:44.266295 (MainThread): Parsing macros/materializations/view.sql
2021-02-25 13:31:44.267918 (MainThread): Parsing macros/materializations/table.sql
2021-02-25 13:31:44.271790 (MainThread): Parsing macros/materializations/incremental.sql
2021-02-25 13:31:44.282390 (MainThread): Parsing macros/core.sql
2021-02-25 13:31:44.286115 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-25 13:31:44.294515 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-25 13:31:44.296153 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-25 13:31:44.314320 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-25 13:31:44.345517 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-25 13:31:44.365637 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-25 13:31:44.367395 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-25 13:31:44.373206 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-25 13:31:44.386189 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-25 13:31:44.392711 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-25 13:31:44.398742 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-25 13:31:44.403403 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-25 13:31:44.404280 (MainThread): Parsing macros/etc/query.sql
2021-02-25 13:31:44.405263 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-25 13:31:44.406793 (MainThread): Parsing macros/etc/datetime.sql
2021-02-25 13:31:44.414995 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-25 13:31:44.417034 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-25 13:31:44.418721 (MainThread): Parsing macros/adapters/common.sql
2021-02-25 13:31:44.461388 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-25 13:31:44.463198 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-25 13:31:44.464640 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-25 13:31:44.466245 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-25 13:31:44.473412 (MainThread): Partial parsing not enabled
2021-02-25 13:31:44.509420 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-25 13:31:44.531060 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-02-25 13:31:44.574028 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-02-25 13:31:44.586404 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-02-25 13:31:44.603700 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-02-25 13:31:44.618472 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-02-25 13:31:44.874789 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '838e416f-79a2-4e01-9f72-ea1abfb7a46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df49460>]}
2021-02-25 13:31:44.929874 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-02-25 13:31:44.930809 (MainThread): 
2021-02-25 13:31:44.931214 (MainThread): Acquiring new snowflake connection "master".
2021-02-25 13:31:44.932571 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-02-25 13:31:44.944402 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-02-25 13:31:44.944490 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-02-25 13:31:44.944564 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-25 13:31:45.982971 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.04 seconds
2021-02-25 13:31:45.987745 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-02-25 13:31:46.116175 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-02-25 13:31:46.122307 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-02-25 13:31:46.122494 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-02-25 13:31:46.122695 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-02-25 13:31:46.777783 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.66 seconds
2021-02-25 13:31:46.778411 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-02-25 13:31:46.949053 (MainThread): Using snowflake connection "master".
2021-02-25 13:31:46.949244 (MainThread): On master: BEGIN
2021-02-25 13:31:46.949380 (MainThread): Opening a new connection, currently in state init
2021-02-25 13:31:47.430990 (MainThread): SQL status: SUCCESS 1 in 0.48 seconds
2021-02-25 13:31:47.431266 (MainThread): On master: COMMIT
2021-02-25 13:31:47.431516 (MainThread): Using snowflake connection "master".
2021-02-25 13:31:47.431663 (MainThread): On master: COMMIT
2021-02-25 13:31:47.565795 (MainThread): SQL status: SUCCESS 1 in 0.13 seconds
2021-02-25 13:31:47.566136 (MainThread): On master: Close
2021-02-25 13:31:47.680142 (MainThread): 07:31:47 | Concurrency: 1 threads (target='dev')
2021-02-25 13:31:47.680379 (MainThread): 07:31:47 | 
2021-02-25 13:31:47.681752 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-02-25 13:31:47.683328 (Thread-1): 07:31:47 | 1 of 1 START table model dbt.first_model............................. [RUN]
2021-02-25 13:31:47.683647 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-25 13:31:47.683779 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-02-25 13:31:47.703082 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-02-25 13:31:47.703478 (Thread-1): finished collecting timing info
2021-02-25 13:31:47.734473 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-02-25 13:31:47.735432 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-25 13:31:47.735516 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-02-25 13:31:47.735594 (Thread-1): Opening a new connection, currently in state closed
2021-02-25 13:31:48.127737 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2021-02-25 13:31:48.127997 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-25 13:31:48.128153 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/




with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, True as first_variable
from source_data
where id >= 2

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-02-25 13:31:48.269315 (Thread-1): Snowflake query id: 019a870b-00d6-be50-0000-000086c98105
2021-02-25 13:31:48.269535 (Thread-1): Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

2021-02-25 13:31:48.269772 (Thread-1): finished collecting timing info
2021-02-25 13:31:48.270215 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: ROLLBACK
2021-02-25 13:31:48.397688 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-02-25 13:31:48.480746 (Thread-1): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target/run/jrtests_learn_dbt/models/example/my_first_dbt_model.sql
Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/Cellar/python@3.8/3.8.7/Frameworks/Python.framework/Versions/3.8/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled SQL at target/run/jrtests_learn_dbt/models/example/my_first_dbt_model.sql
2021-02-25 13:31:48.484098 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '838e416f-79a2-4e01-9f72-ea1abfb7a46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1193a0>]}
2021-02-25 13:31:48.485413 (Thread-1): 07:31:48 | 1 of 1 ERROR creating table model dbt.first_model.................... [ERROR in 0.80s]
2021-02-25 13:31:48.485568 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-02-25 13:31:48.486557 (MainThread): Acquiring new snowflake connection "master".
2021-02-25 13:31:48.486777 (MainThread): Using snowflake connection "master".
2021-02-25 13:31:48.486884 (MainThread): On master: BEGIN
2021-02-25 13:31:48.486990 (MainThread): Opening a new connection, currently in state closed
2021-02-25 13:31:49.096545 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2021-02-25 13:31:49.096813 (MainThread): On master: COMMIT
2021-02-25 13:31:49.097064 (MainThread): Using snowflake connection "master".
2021-02-25 13:31:49.097215 (MainThread): On master: COMMIT
2021-02-25 13:31:49.196817 (MainThread): SQL status: SUCCESS 1 in 0.10 seconds
2021-02-25 13:31:49.197099 (MainThread): On master: Close
2021-02-25 13:31:49.280068 (MainThread): 07:31:49 | 
2021-02-25 13:31:49.280305 (MainThread): 07:31:49 | Finished running 1 table model in 4.35s.
2021-02-25 13:31:49.280464 (MainThread): Connection 'master' was properly closed.
2021-02-25 13:31:49.280577 (MainThread): Connection 'model.jrtests_learn_dbt.my_first_dbt_model' was properly closed.
2021-02-25 13:31:49.337418 (MainThread): 
2021-02-25 13:31:49.337583 (MainThread): Completed with 1 error and 0 warnings:
2021-02-25 13:31:49.337692 (MainThread): 
2021-02-25 13:31:49.337790 (MainThread): Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
2021-02-25 13:31:49.337879 (MainThread):   000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
2021-02-25 13:31:49.337962 (MainThread):   
2021-02-25 13:31:49.338042 (MainThread):   compiled SQL at target/run/jrtests_learn_dbt/models/example/my_first_dbt_model.sql
2021-02-25 13:31:49.338128 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-02-25 13:31:49.338287 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de34d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfdbb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfdbd00>]}
2021-02-25 13:31:49.338465 (MainThread): Flushing usage events
2021-02-25 13:52:38.199411 (MainThread): Running with dbt=0.19.0
2021-02-25 13:52:38.697130 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['my_first_dbt_model'], partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-25 13:52:38.697785 (MainThread): Tracking: tracking
2021-02-25 13:52:38.698092 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089432b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098967f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109896f10>]}
2021-02-25 13:52:38.719433 (MainThread): Partial parsing not enabled
2021-02-25 13:52:38.720313 (MainThread): Parsing macros/catalog.sql
2021-02-25 13:52:38.722676 (MainThread): Parsing macros/adapters.sql
2021-02-25 13:52:38.750320 (MainThread): Parsing macros/materializations/merge.sql
2021-02-25 13:52:38.752209 (MainThread): Parsing macros/materializations/view.sql
2021-02-25 13:52:38.753601 (MainThread): Parsing macros/materializations/table.sql
2021-02-25 13:52:38.757545 (MainThread): Parsing macros/materializations/incremental.sql
2021-02-25 13:52:38.767362 (MainThread): Parsing macros/core.sql
2021-02-25 13:52:38.771010 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-25 13:52:38.779382 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-25 13:52:38.781083 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-25 13:52:38.798461 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-25 13:52:38.829363 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-25 13:52:38.849095 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-25 13:52:38.850839 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-25 13:52:38.856610 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-25 13:52:38.869671 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-25 13:52:38.875967 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-25 13:52:38.881837 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-25 13:52:38.886471 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-25 13:52:38.887330 (MainThread): Parsing macros/etc/query.sql
2021-02-25 13:52:38.888294 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-25 13:52:38.889793 (MainThread): Parsing macros/etc/datetime.sql
2021-02-25 13:52:38.898214 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-25 13:52:38.900106 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-25 13:52:38.901704 (MainThread): Parsing macros/adapters/common.sql
2021-02-25 13:52:38.940409 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-25 13:52:38.942488 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-25 13:52:38.943856 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-25 13:52:38.945389 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-25 13:52:38.952784 (MainThread): Partial parsing not enabled
2021-02-25 13:52:38.987766 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-25 13:52:39.007981 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-02-25 13:52:39.052372 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-02-25 13:52:39.066305 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-02-25 13:52:39.082782 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-02-25 13:52:39.095893 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-02-25 13:52:39.348512 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ad6ada2-f6f1-4a07-87be-1a648c7bdf3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a37400>]}
2021-02-25 13:52:39.401867 (MainThread): Found 6 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-02-25 13:52:39.402778 (MainThread): 
2021-02-25 13:52:39.403003 (MainThread): Acquiring new snowflake connection "master".
2021-02-25 13:52:39.404133 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-02-25 13:52:39.418207 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-02-25 13:52:39.418365 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-02-25 13:52:39.418448 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-25 13:52:40.033749 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 0.62 seconds
2021-02-25 13:52:40.038546 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-02-25 13:52:40.183068 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-02-25 13:52:40.189748 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-02-25 13:52:40.189850 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-02-25 13:52:40.189939 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-02-25 13:52:40.585861 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 0.40 seconds
2021-02-25 13:52:40.586491 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-02-25 13:52:40.688117 (MainThread): Using snowflake connection "master".
2021-02-25 13:52:40.688305 (MainThread): On master: BEGIN
2021-02-25 13:52:40.688439 (MainThread): Opening a new connection, currently in state init
2021-02-25 13:52:41.342071 (MainThread): SQL status: SUCCESS 1 in 0.65 seconds
2021-02-25 13:52:41.342349 (MainThread): On master: COMMIT
2021-02-25 13:52:41.342596 (MainThread): Using snowflake connection "master".
2021-02-25 13:52:41.342740 (MainThread): On master: COMMIT
2021-02-25 13:52:41.558162 (MainThread): SQL status: SUCCESS 1 in 0.22 seconds
2021-02-25 13:52:41.558457 (MainThread): On master: Close
2021-02-25 13:52:41.664797 (MainThread): 07:52:41 | Concurrency: 1 threads (target='dev')
2021-02-25 13:52:41.665025 (MainThread): 07:52:41 | 
2021-02-25 13:52:41.666201 (Thread-1): Began running node model.jrtests_learn_dbt.my_first_dbt_model
2021-02-25 13:52:41.667746 (Thread-1): 07:52:41 | 1 of 1 START table model dbt.first_model............................. [RUN]
2021-02-25 13:52:41.668105 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-25 13:52:41.668233 (Thread-1): Compiling model.jrtests_learn_dbt.my_first_dbt_model
2021-02-25 13:52:41.688397 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-02-25 13:52:41.688833 (Thread-1): finished collecting timing info
2021-02-25 13:52:41.720851 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.my_first_dbt_model"
2021-02-25 13:52:41.722392 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-25 13:52:41.722493 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: BEGIN
2021-02-25 13:52:41.722583 (Thread-1): Opening a new connection, currently in state closed
2021-02-25 13:52:42.664113 (Thread-1): SQL status: SUCCESS 1 in 0.94 seconds
2021-02-25 13:52:42.664368 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-25 13:52:42.664523 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.my_first_dbt_model"} */


      create or replace transient table analytics.dbt.first_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/




with source_data as (

    select 1 as id
    union all
    select null as id

)

select *, True as first_variable
from source_data
where id >= 2

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2021-02-25 13:52:43.616364 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2021-02-25 13:52:43.618129 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-02-25 13:52:43.618341 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-25 13:52:43.618466 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: COMMIT
2021-02-25 13:52:43.676155 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2021-02-25 13:52:43.690808 (Thread-1): finished collecting timing info
2021-02-25 13:52:43.691032 (Thread-1): On model.jrtests_learn_dbt.my_first_dbt_model: Close
2021-02-25 13:52:43.794311 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ad6ada2-f6f1-4a07-87be-1a648c7bdf3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be572b0>]}
2021-02-25 13:52:43.795918 (Thread-1): 07:52:43 | 1 of 1 OK created table model dbt.first_model........................ [SUCCESS 1 in 2.13s]
2021-02-25 13:52:43.796110 (Thread-1): Finished running node model.jrtests_learn_dbt.my_first_dbt_model
2021-02-25 13:52:43.797394 (MainThread): Acquiring new snowflake connection "master".
2021-02-25 13:52:43.797619 (MainThread): Using snowflake connection "master".
2021-02-25 13:52:43.797726 (MainThread): On master: BEGIN
2021-02-25 13:52:43.797831 (MainThread): Opening a new connection, currently in state closed
2021-02-25 13:52:44.385398 (MainThread): SQL status: SUCCESS 1 in 0.59 seconds
2021-02-25 13:52:44.385673 (MainThread): On master: COMMIT
2021-02-25 13:52:44.385927 (MainThread): Using snowflake connection "master".
2021-02-25 13:52:44.386078 (MainThread): On master: COMMIT
2021-02-25 13:52:44.490374 (MainThread): SQL status: SUCCESS 1 in 0.10 seconds
2021-02-25 13:52:44.490666 (MainThread): On master: Close
2021-02-25 13:52:44.594140 (MainThread): 07:52:44 | 
2021-02-25 13:52:44.594368 (MainThread): 07:52:44 | Finished running 1 table model in 5.19s.
2021-02-25 13:52:44.594522 (MainThread): Connection 'master' was properly closed.
2021-02-25 13:52:44.594633 (MainThread): Connection 'model.jrtests_learn_dbt.my_first_dbt_model' was properly closed.
2021-02-25 13:52:44.652183 (MainThread): 
2021-02-25 13:52:44.652358 (MainThread): Completed successfully
2021-02-25 13:52:44.652480 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-02-25 13:52:44.652666 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098f6e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a13f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be4e820>]}
2021-02-25 13:52:44.652856 (MainThread): Flushing usage events
2021-02-25 14:02:12.048764 (MainThread): Running with dbt=0.19.0
2021-02-25 14:02:12.543018 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['new'], partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-25 14:02:12.543748 (MainThread): Tracking: tracking
2021-02-25 14:02:12.543983 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b82c220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c782ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c782b50>]}
2021-02-25 14:02:12.563833 (MainThread): Partial parsing not enabled
2021-02-25 14:02:12.564846 (MainThread): Parsing macros/catalog.sql
2021-02-25 14:02:12.566965 (MainThread): Parsing macros/adapters.sql
2021-02-25 14:02:12.594783 (MainThread): Parsing macros/materializations/merge.sql
2021-02-25 14:02:12.596700 (MainThread): Parsing macros/materializations/view.sql
2021-02-25 14:02:12.598101 (MainThread): Parsing macros/materializations/table.sql
2021-02-25 14:02:12.601934 (MainThread): Parsing macros/materializations/incremental.sql
2021-02-25 14:02:12.611659 (MainThread): Parsing macros/core.sql
2021-02-25 14:02:12.615259 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-25 14:02:12.623384 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-25 14:02:12.625000 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-25 14:02:12.643112 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-25 14:02:12.674144 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-25 14:02:12.694220 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-25 14:02:12.695950 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-25 14:02:12.701866 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-25 14:02:12.715054 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-25 14:02:12.721328 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-25 14:02:12.727242 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-25 14:02:12.731964 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-25 14:02:12.732820 (MainThread): Parsing macros/etc/query.sql
2021-02-25 14:02:12.733779 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-25 14:02:12.735268 (MainThread): Parsing macros/etc/datetime.sql
2021-02-25 14:02:12.743415 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-25 14:02:12.745209 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-25 14:02:12.746819 (MainThread): Parsing macros/adapters/common.sql
2021-02-25 14:02:12.786677 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-25 14:02:12.788417 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-25 14:02:12.789834 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-25 14:02:12.791416 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-25 14:02:12.798650 (MainThread): Partial parsing not enabled
2021-02-25 14:02:12.832996 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-25 14:02:12.854646 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-02-25 14:02:12.895990 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-02-25 14:02:12.908720 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-02-25 14:02:12.925282 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-02-25 14:02:12.938228 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-02-25 14:02:12.949245 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.dates".
2021-02-25 14:02:13.203549 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fb9f641-76a9-459e-a7e1-46d474a52238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca6d2b0>]}
2021-02-25 14:02:13.259700 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-02-25 14:02:13.260635 (MainThread): 
2021-02-25 14:02:13.260867 (MainThread): Acquiring new snowflake connection "master".
2021-02-25 14:02:13.261984 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-02-25 14:02:13.273525 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-02-25 14:02:13.273610 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-02-25 14:02:13.273685 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-25 14:02:14.124482 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 0.85 seconds
2021-02-25 14:02:14.129271 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-02-25 14:02:14.727809 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-02-25 14:02:14.734410 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-02-25 14:02:14.734513 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-02-25 14:02:14.734601 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-02-25 14:02:15.522018 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 0.79 seconds
2021-02-25 14:02:15.524502 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-02-25 14:02:15.681450 (MainThread): Using snowflake connection "master".
2021-02-25 14:02:15.681638 (MainThread): On master: BEGIN
2021-02-25 14:02:15.681772 (MainThread): Opening a new connection, currently in state init
2021-02-25 14:02:17.013671 (MainThread): SQL status: SUCCESS 1 in 1.33 seconds
2021-02-25 14:02:17.013961 (MainThread): On master: COMMIT
2021-02-25 14:02:17.014223 (MainThread): Using snowflake connection "master".
2021-02-25 14:02:17.014377 (MainThread): On master: COMMIT
2021-02-25 14:02:17.156542 (MainThread): SQL status: SUCCESS 1 in 0.14 seconds
2021-02-25 14:02:17.156846 (MainThread): On master: Close
2021-02-25 14:02:17.363363 (MainThread): 08:02:17 | Concurrency: 1 threads (target='dev')
2021-02-25 14:02:17.363596 (MainThread): 08:02:17 | 
2021-02-25 14:02:17.364867 (Thread-1): Began running node model.jrtests_learn_dbt.dates
2021-02-25 14:02:17.366374 (Thread-1): 08:02:17 | 1 of 1 START view model dbt.dates.................................... [RUN]
2021-02-25 14:02:17.366731 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.dates".
2021-02-25 14:02:17.366870 (Thread-1): Compiling model.jrtests_learn_dbt.dates
2021-02-25 14:02:17.384384 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.dates"
2021-02-25 14:02:17.384832 (Thread-1): finished collecting timing info
2021-02-25 14:02:17.413578 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.dates"
2021-02-25 14:02:17.414428 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.dates".
2021-02-25 14:02:17.414530 (Thread-1): On model.jrtests_learn_dbt.dates: BEGIN
2021-02-25 14:02:17.414621 (Thread-1): Opening a new connection, currently in state closed
2021-02-25 14:02:18.164637 (Thread-1): SQL status: SUCCESS 1 in 0.75 seconds
2021-02-25 14:02:18.164855 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.dates".
2021-02-25 14:02:18.164980 (Thread-1): On model.jrtests_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.dates"} */

  create or replace  view analytics.dbt.dates  as (
    


SELECT * from
FROM
  "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE
  d_date <= current_date



  );
2021-02-25 14:02:18.294098 (Thread-1): Snowflake query id: 019a872a-007b-54d3-0000-000086c9a171
2021-02-25 14:02:18.294317 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 0 unexpected 'FROM'.
2021-02-25 14:02:18.294559 (Thread-1): finished collecting timing info
2021-02-25 14:02:18.295009 (Thread-1): On model.jrtests_learn_dbt.dates: ROLLBACK
2021-02-25 14:02:18.439207 (Thread-1): On model.jrtests_learn_dbt.dates: Close
2021-02-25 14:02:18.714296 (Thread-1): Database Error in model dates (models/new/dates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 0 unexpected 'FROM'.
  compiled SQL at target/run/jrtests_learn_dbt/models/new/dates.sql
Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 6 at position 0 unexpected 'FROM'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/Cellar/python@3.8/3.8.7/Frameworks/Python.framework/Versions/3.8/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/Cellar/dbt/0.19.0_1/libexec/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model dates (models/new/dates.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 0 unexpected 'FROM'.
  compiled SQL at target/run/jrtests_learn_dbt/models/new/dates.sql
2021-02-25 14:02:18.717946 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fb9f641-76a9-459e-a7e1-46d474a52238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecdee20>]}
2021-02-25 14:02:18.719293 (Thread-1): 08:02:18 | 1 of 1 ERROR creating view model dbt.dates........................... [ERROR in 1.35s]
2021-02-25 14:02:18.719449 (Thread-1): Finished running node model.jrtests_learn_dbt.dates
2021-02-25 14:02:18.720547 (MainThread): Acquiring new snowflake connection "master".
2021-02-25 14:02:18.720761 (MainThread): Using snowflake connection "master".
2021-02-25 14:02:18.720861 (MainThread): On master: BEGIN
2021-02-25 14:02:18.720961 (MainThread): Opening a new connection, currently in state closed
2021-02-25 14:02:19.241140 (MainThread): SQL status: SUCCESS 1 in 0.52 seconds
2021-02-25 14:02:19.241426 (MainThread): On master: COMMIT
2021-02-25 14:02:19.241680 (MainThread): Using snowflake connection "master".
2021-02-25 14:02:19.241846 (MainThread): On master: COMMIT
2021-02-25 14:02:19.822932 (MainThread): SQL status: SUCCESS 1 in 0.58 seconds
2021-02-25 14:02:19.823218 (MainThread): On master: Close
2021-02-25 14:02:20.114629 (MainThread): 08:02:20 | 
2021-02-25 14:02:20.114860 (MainThread): 08:02:20 | Finished running 1 view model in 6.85s.
2021-02-25 14:02:20.115017 (MainThread): Connection 'master' was properly closed.
2021-02-25 14:02:20.115133 (MainThread): Connection 'model.jrtests_learn_dbt.dates' was properly closed.
2021-02-25 14:02:20.175998 (MainThread): 
2021-02-25 14:02:20.176160 (MainThread): Completed with 1 error and 0 warnings:
2021-02-25 14:02:20.176266 (MainThread): 
2021-02-25 14:02:20.176367 (MainThread): Database Error in model dates (models/new/dates.sql)
2021-02-25 14:02:20.176458 (MainThread):   001003 (42000): SQL compilation error:
2021-02-25 14:02:20.176541 (MainThread):   syntax error line 6 at position 0 unexpected 'FROM'.
2021-02-25 14:02:20.176625 (MainThread):   compiled SQL at target/run/jrtests_learn_dbt/models/new/dates.sql
2021-02-25 14:02:20.176718 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-02-25 14:02:20.176907 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8fac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c796f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed492e0>]}
2021-02-25 14:02:20.177096 (MainThread): Flushing usage events
2021-02-25 14:02:49.322057 (MainThread): Running with dbt=0.19.0
2021-02-25 14:02:49.807566 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['new'], partial_parse=None, profile=None, profiles_dir='/Users/venunair/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-25 14:02:49.808278 (MainThread): Tracking: tracking
2021-02-25 14:02:49.808528 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8dd640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f82f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f82ffa0>]}
2021-02-25 14:02:49.829649 (MainThread): Partial parsing not enabled
2021-02-25 14:02:49.830824 (MainThread): Parsing macros/catalog.sql
2021-02-25 14:02:49.833407 (MainThread): Parsing macros/adapters.sql
2021-02-25 14:02:49.861092 (MainThread): Parsing macros/materializations/merge.sql
2021-02-25 14:02:49.862950 (MainThread): Parsing macros/materializations/view.sql
2021-02-25 14:02:49.864316 (MainThread): Parsing macros/materializations/table.sql
2021-02-25 14:02:49.868112 (MainThread): Parsing macros/materializations/incremental.sql
2021-02-25 14:02:49.877781 (MainThread): Parsing macros/core.sql
2021-02-25 14:02:49.881413 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-25 14:02:49.889688 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-25 14:02:49.891407 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-25 14:02:49.908468 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-25 14:02:49.939670 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-25 14:02:49.959940 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-25 14:02:49.961635 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-25 14:02:49.967458 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-25 14:02:49.980330 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-25 14:02:49.986654 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-25 14:02:49.993078 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-25 14:02:49.998004 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-25 14:02:49.999065 (MainThread): Parsing macros/etc/query.sql
2021-02-25 14:02:50.000043 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-25 14:02:50.001553 (MainThread): Parsing macros/etc/datetime.sql
2021-02-25 14:02:50.010396 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-25 14:02:50.012473 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-25 14:02:50.014148 (MainThread): Parsing macros/adapters/common.sql
2021-02-25 14:02:50.054282 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-25 14:02:50.056098 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-25 14:02:50.057500 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-25 14:02:50.059071 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-25 14:02:50.066260 (MainThread): Partial parsing not enabled
2021-02-25 14:02:50.102450 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_first_dbt_model".
2021-02-25 14:02:50.122834 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.cumulative_orders_by_date".
2021-02-25 14:02:50.164147 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.my_second_dbt_model".
2021-02-25 14:02:50.177868 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.covid_us".
2021-02-25 14:02:50.194617 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.time".
2021-02-25 14:02:50.207241 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.snowflake_customer_purchases".
2021-02-25 14:02:50.217677 (MainThread): Acquiring new snowflake connection "model.jrtests_learn_dbt.dates".
2021-02-25 14:02:50.475773 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '931fb37a-638f-46be-9da1-78bd0499a770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fac6e20>]}
2021-02-25 14:02:50.531723 (MainThread): Found 7 models, 10 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-02-25 14:02:50.532666 (MainThread): 
2021-02-25 14:02:50.533067 (MainThread): Acquiring new snowflake connection "master".
2021-02-25 14:02:50.534299 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2021-02-25 14:02:50.545739 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2021-02-25 14:02:50.545822 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2021-02-25 14:02:50.545896 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-25 14:02:51.791278 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 1.25 seconds
2021-02-25 14:02:51.796082 (ThreadPoolExecutor-0_0): On list_analytics: Close
2021-02-25 14:02:52.100016 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_dbt".
2021-02-25 14:02:52.106709 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_dbt".
2021-02-25 14:02:52.106811 (ThreadPoolExecutor-1_0): On list_analytics_dbt: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "connection_name": "list_analytics_dbt"} */

    show terse objects in analytics.dbt
2021-02-25 14:02:52.106900 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-02-25 14:02:53.310644 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 1 in 1.20 seconds
2021-02-25 14:02:53.313146 (ThreadPoolExecutor-1_0): On list_analytics_dbt: Close
2021-02-25 14:02:53.623199 (MainThread): Using snowflake connection "master".
2021-02-25 14:02:53.623389 (MainThread): On master: BEGIN
2021-02-25 14:02:53.623525 (MainThread): Opening a new connection, currently in state init
2021-02-25 14:02:54.089230 (MainThread): SQL status: SUCCESS 1 in 0.47 seconds
2021-02-25 14:02:54.089505 (MainThread): On master: COMMIT
2021-02-25 14:02:54.089751 (MainThread): Using snowflake connection "master".
2021-02-25 14:02:54.089897 (MainThread): On master: COMMIT
2021-02-25 14:02:54.214420 (MainThread): SQL status: SUCCESS 1 in 0.12 seconds
2021-02-25 14:02:54.214699 (MainThread): On master: Close
2021-02-25 14:02:54.314630 (MainThread): 08:02:54 | Concurrency: 1 threads (target='dev')
2021-02-25 14:02:54.314867 (MainThread): 08:02:54 | 
2021-02-25 14:02:54.316136 (Thread-1): Began running node model.jrtests_learn_dbt.dates
2021-02-25 14:02:54.317654 (Thread-1): 08:02:54 | 1 of 1 START view model dbt.dates.................................... [RUN]
2021-02-25 14:02:54.318002 (Thread-1): Acquiring new snowflake connection "model.jrtests_learn_dbt.dates".
2021-02-25 14:02:54.318137 (Thread-1): Compiling model.jrtests_learn_dbt.dates
2021-02-25 14:02:54.335493 (Thread-1): Writing injected SQL for node "model.jrtests_learn_dbt.dates"
2021-02-25 14:02:54.335867 (Thread-1): finished collecting timing info
2021-02-25 14:02:54.364372 (Thread-1): Writing runtime SQL for node "model.jrtests_learn_dbt.dates"
2021-02-25 14:02:54.365147 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.dates".
2021-02-25 14:02:54.365245 (Thread-1): On model.jrtests_learn_dbt.dates: BEGIN
2021-02-25 14:02:54.365335 (Thread-1): Opening a new connection, currently in state closed
2021-02-25 14:02:54.767251 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2021-02-25 14:02:54.767517 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.dates".
2021-02-25 14:02:54.767672 (Thread-1): On model.jrtests_learn_dbt.dates: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "sf2", "target_name": "dev", "node_id": "model.jrtests_learn_dbt.dates"} */

  create or replace  view analytics.dbt.dates  as (
    


SELECT * 
FROM
  "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."DATE_DIM"
WHERE
  d_date <= current_date



  );
2021-02-25 14:02:55.150477 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2021-02-25 14:02:55.152163 (Thread-1): On model.jrtests_learn_dbt.dates: COMMIT
2021-02-25 14:02:55.152429 (Thread-1): Using snowflake connection "model.jrtests_learn_dbt.dates".
2021-02-25 14:02:55.152550 (Thread-1): On model.jrtests_learn_dbt.dates: COMMIT
2021-02-25 14:02:55.216284 (Thread-1): SQL status: SUCCESS 1 in 0.06 seconds
2021-02-25 14:02:55.226538 (Thread-1): finished collecting timing info
2021-02-25 14:02:55.226759 (Thread-1): On model.jrtests_learn_dbt.dates: Close
2021-02-25 14:02:55.329480 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '931fb37a-638f-46be-9da1-78bd0499a770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d99d90>]}
2021-02-25 14:02:55.331042 (Thread-1): 08:02:55 | 1 of 1 OK created view model dbt.dates............................... [SUCCESS 1 in 1.01s]
2021-02-25 14:02:55.331236 (Thread-1): Finished running node model.jrtests_learn_dbt.dates
2021-02-25 14:02:55.332444 (MainThread): Acquiring new snowflake connection "master".
2021-02-25 14:02:55.332666 (MainThread): Using snowflake connection "master".
2021-02-25 14:02:55.332771 (MainThread): On master: BEGIN
2021-02-25 14:02:55.332874 (MainThread): Opening a new connection, currently in state closed
2021-02-25 14:02:56.174415 (MainThread): SQL status: SUCCESS 1 in 0.84 seconds
2021-02-25 14:02:56.174689 (MainThread): On master: COMMIT
2021-02-25 14:02:56.174937 (MainThread): Using snowflake connection "master".
2021-02-25 14:02:56.175086 (MainThread): On master: COMMIT
2021-02-25 14:02:56.369910 (MainThread): SQL status: SUCCESS 1 in 0.19 seconds
2021-02-25 14:02:56.370204 (MainThread): On master: Close
2021-02-25 14:02:56.627209 (MainThread): 08:02:56 | 
2021-02-25 14:02:56.627444 (MainThread): 08:02:56 | Finished running 1 view model in 6.09s.
2021-02-25 14:02:56.627599 (MainThread): Connection 'master' was properly closed.
2021-02-25 14:02:56.627713 (MainThread): Connection 'model.jrtests_learn_dbt.dates' was properly closed.
2021-02-25 14:02:56.688622 (MainThread): 
2021-02-25 14:02:56.688791 (MainThread): Completed successfully
2021-02-25 14:02:56.688902 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-02-25 14:02:56.689071 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb52c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9abeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dda550>]}
2021-02-25 14:02:56.689250 (MainThread): Flushing usage events
